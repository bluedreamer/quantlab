#include <iostream>
#include <fstream>

#include <catch2/catch.hpp>
#include "../CSVParser.h"
#include "../Market.h"

TEST_CASE("Test parsing of input file", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.MessageCount() == 20391);
   auto symbols = market.GetSymbols();
   REQUIRE(symbols.size() == 343);
   size_t index = 0;

   REQUIRE("aaa" == symbols[index++]);
   REQUIRE("aab" == symbols[index++]);
   REQUIRE("aac" == symbols[index++]);
   REQUIRE("aad" == symbols[index++]);
   REQUIRE("aae" == symbols[index++]);
   REQUIRE("aaf" == symbols[index++]);
   REQUIRE("aag" == symbols[index++]);
   REQUIRE("aba" == symbols[index++]);
   REQUIRE("abb" == symbols[index++]);
   REQUIRE("abc" == symbols[index++]);
   REQUIRE("abd" == symbols[index++]);
   REQUIRE("abe" == symbols[index++]);
   REQUIRE("abf" == symbols[index++]);
   REQUIRE("abg" == symbols[index++]);
   REQUIRE("aca" == symbols[index++]);
   REQUIRE("acb" == symbols[index++]);
   REQUIRE("acc" == symbols[index++]);
   REQUIRE("acd" == symbols[index++]);
   REQUIRE("ace" == symbols[index++]);
   REQUIRE("acf" == symbols[index++]);
   REQUIRE("acg" == symbols[index++]);
   REQUIRE("ada" == symbols[index++]);
   REQUIRE("adb" == symbols[index++]);
   REQUIRE("adc" == symbols[index++]);
   REQUIRE("add" == symbols[index++]);
   REQUIRE("ade" == symbols[index++]);
   REQUIRE("adf" == symbols[index++]);
   REQUIRE("adg" == symbols[index++]);
   REQUIRE("aea" == symbols[index++]);
   REQUIRE("aeb" == symbols[index++]);
   REQUIRE("aec" == symbols[index++]);
   REQUIRE("aed" == symbols[index++]);
   REQUIRE("aee" == symbols[index++]);
   REQUIRE("aef" == symbols[index++]);
   REQUIRE("aeg" == symbols[index++]);
   REQUIRE("afa" == symbols[index++]);
   REQUIRE("afb" == symbols[index++]);
   REQUIRE("afc" == symbols[index++]);
   REQUIRE("afd" == symbols[index++]);
   REQUIRE("afe" == symbols[index++]);
   REQUIRE("aff" == symbols[index++]);
   REQUIRE("afg" == symbols[index++]);
   REQUIRE("aga" == symbols[index++]);
   REQUIRE("agb" == symbols[index++]);
   REQUIRE("agc" == symbols[index++]);
   REQUIRE("agd" == symbols[index++]);
   REQUIRE("age" == symbols[index++]);
   REQUIRE("agf" == symbols[index++]);
   REQUIRE("agg" == symbols[index++]);
   REQUIRE("baa" == symbols[index++]);
   REQUIRE("bab" == symbols[index++]);
   REQUIRE("bac" == symbols[index++]);
   REQUIRE("bad" == symbols[index++]);
   REQUIRE("bae" == symbols[index++]);
   REQUIRE("baf" == symbols[index++]);
   REQUIRE("bag" == symbols[index++]);
   REQUIRE("bba" == symbols[index++]);
   REQUIRE("bbb" == symbols[index++]);
   REQUIRE("bbc" == symbols[index++]);
   REQUIRE("bbd" == symbols[index++]);
   REQUIRE("bbe" == symbols[index++]);
   REQUIRE("bbf" == symbols[index++]);
   REQUIRE("bbg" == symbols[index++]);
   REQUIRE("bca" == symbols[index++]);
   REQUIRE("bcb" == symbols[index++]);
   REQUIRE("bcc" == symbols[index++]);
   REQUIRE("bcd" == symbols[index++]);
   REQUIRE("bce" == symbols[index++]);
   REQUIRE("bcf" == symbols[index++]);
   REQUIRE("bcg" == symbols[index++]);
   REQUIRE("bda" == symbols[index++]);
   REQUIRE("bdb" == symbols[index++]);
   REQUIRE("bdc" == symbols[index++]);
   REQUIRE("bdd" == symbols[index++]);
   REQUIRE("bde" == symbols[index++]);
   REQUIRE("bdf" == symbols[index++]);
   REQUIRE("bdg" == symbols[index++]);
   REQUIRE("bea" == symbols[index++]);
   REQUIRE("beb" == symbols[index++]);
   REQUIRE("bec" == symbols[index++]);
   REQUIRE("bed" == symbols[index++]);
   REQUIRE("bee" == symbols[index++]);
   REQUIRE("bef" == symbols[index++]);
   REQUIRE("beg" == symbols[index++]);
   REQUIRE("bfa" == symbols[index++]);
   REQUIRE("bfb" == symbols[index++]);
   REQUIRE("bfc" == symbols[index++]);
   REQUIRE("bfd" == symbols[index++]);
   REQUIRE("bfe" == symbols[index++]);
   REQUIRE("bff" == symbols[index++]);
   REQUIRE("bfg" == symbols[index++]);
   REQUIRE("bga" == symbols[index++]);
   REQUIRE("bgb" == symbols[index++]);
   REQUIRE("bgc" == symbols[index++]);
   REQUIRE("bgd" == symbols[index++]);
   REQUIRE("bge" == symbols[index++]);
   REQUIRE("bgf" == symbols[index++]);
   REQUIRE("bgg" == symbols[index++]);
   REQUIRE("caa" == symbols[index++]);
   REQUIRE("cab" == symbols[index++]);
   REQUIRE("cac" == symbols[index++]);
   REQUIRE("cad" == symbols[index++]);
   REQUIRE("cae" == symbols[index++]);
   REQUIRE("caf" == symbols[index++]);
   REQUIRE("cag" == symbols[index++]);
   REQUIRE("cba" == symbols[index++]);
   REQUIRE("cbb" == symbols[index++]);
   REQUIRE("cbc" == symbols[index++]);
   REQUIRE("cbd" == symbols[index++]);
   REQUIRE("cbe" == symbols[index++]);
   REQUIRE("cbf" == symbols[index++]);
   REQUIRE("cbg" == symbols[index++]);
   REQUIRE("cca" == symbols[index++]);
   REQUIRE("ccb" == symbols[index++]);
   REQUIRE("ccc" == symbols[index++]);
   REQUIRE("ccd" == symbols[index++]);
   REQUIRE("cce" == symbols[index++]);
   REQUIRE("ccf" == symbols[index++]);
   REQUIRE("ccg" == symbols[index++]);
   REQUIRE("cda" == symbols[index++]);
   REQUIRE("cdb" == symbols[index++]);
   REQUIRE("cdc" == symbols[index++]);
   REQUIRE("cdd" == symbols[index++]);
   REQUIRE("cde" == symbols[index++]);
   REQUIRE("cdf" == symbols[index++]);
   REQUIRE("cdg" == symbols[index++]);
   REQUIRE("cea" == symbols[index++]);
   REQUIRE("ceb" == symbols[index++]);
   REQUIRE("cec" == symbols[index++]);
   REQUIRE("ced" == symbols[index++]);
   REQUIRE("cee" == symbols[index++]);
   REQUIRE("cef" == symbols[index++]);
   REQUIRE("ceg" == symbols[index++]);
   REQUIRE("cfa" == symbols[index++]);
   REQUIRE("cfb" == symbols[index++]);
   REQUIRE("cfc" == symbols[index++]);
   REQUIRE("cfd" == symbols[index++]);
   REQUIRE("cfe" == symbols[index++]);
   REQUIRE("cff" == symbols[index++]);
   REQUIRE("cfg" == symbols[index++]);
   REQUIRE("cga" == symbols[index++]);
   REQUIRE("cgb" == symbols[index++]);
   REQUIRE("cgc" == symbols[index++]);
   REQUIRE("cgd" == symbols[index++]);
   REQUIRE("cge" == symbols[index++]);
   REQUIRE("cgf" == symbols[index++]);
   REQUIRE("cgg" == symbols[index++]);
   REQUIRE("daa" == symbols[index++]);
   REQUIRE("dab" == symbols[index++]);
   REQUIRE("dac" == symbols[index++]);
   REQUIRE("dad" == symbols[index++]);
   REQUIRE("dae" == symbols[index++]);
   REQUIRE("daf" == symbols[index++]);
   REQUIRE("dag" == symbols[index++]);
   REQUIRE("dba" == symbols[index++]);
   REQUIRE("dbb" == symbols[index++]);
   REQUIRE("dbc" == symbols[index++]);
   REQUIRE("dbd" == symbols[index++]);
   REQUIRE("dbe" == symbols[index++]);
   REQUIRE("dbf" == symbols[index++]);
   REQUIRE("dbg" == symbols[index++]);
   REQUIRE("dca" == symbols[index++]);
   REQUIRE("dcb" == symbols[index++]);
   REQUIRE("dcc" == symbols[index++]);
   REQUIRE("dcd" == symbols[index++]);
   REQUIRE("dce" == symbols[index++]);
   REQUIRE("dcf" == symbols[index++]);
   REQUIRE("dcg" == symbols[index++]);
   REQUIRE("dda" == symbols[index++]);
   REQUIRE("ddb" == symbols[index++]);
   REQUIRE("ddc" == symbols[index++]);
   REQUIRE("ddd" == symbols[index++]);
   REQUIRE("dde" == symbols[index++]);
   REQUIRE("ddf" == symbols[index++]);
   REQUIRE("ddg" == symbols[index++]);
   REQUIRE("dea" == symbols[index++]);
   REQUIRE("deb" == symbols[index++]);
   REQUIRE("dec" == symbols[index++]);
   REQUIRE("ded" == symbols[index++]);
   REQUIRE("dee" == symbols[index++]);
   REQUIRE("def" == symbols[index++]);
   REQUIRE("deg" == symbols[index++]);
   REQUIRE("dfa" == symbols[index++]);
   REQUIRE("dfb" == symbols[index++]);
   REQUIRE("dfc" == symbols[index++]);
   REQUIRE("dfd" == symbols[index++]);
   REQUIRE("dfe" == symbols[index++]);
   REQUIRE("dff" == symbols[index++]);
   REQUIRE("dfg" == symbols[index++]);
   REQUIRE("dga" == symbols[index++]);
   REQUIRE("dgb" == symbols[index++]);
   REQUIRE("dgc" == symbols[index++]);
   REQUIRE("dgd" == symbols[index++]);
   REQUIRE("dge" == symbols[index++]);
   REQUIRE("dgf" == symbols[index++]);
   REQUIRE("dgg" == symbols[index++]);
   REQUIRE("eaa" == symbols[index++]);
   REQUIRE("eab" == symbols[index++]);
   REQUIRE("eac" == symbols[index++]);
   REQUIRE("ead" == symbols[index++]);
   REQUIRE("eae" == symbols[index++]);
   REQUIRE("eaf" == symbols[index++]);
   REQUIRE("eag" == symbols[index++]);
   REQUIRE("eba" == symbols[index++]);
   REQUIRE("ebb" == symbols[index++]);
   REQUIRE("ebc" == symbols[index++]);
   REQUIRE("ebd" == symbols[index++]);
   REQUIRE("ebe" == symbols[index++]);
   REQUIRE("ebf" == symbols[index++]);
   REQUIRE("ebg" == symbols[index++]);
   REQUIRE("eca" == symbols[index++]);
   REQUIRE("ecb" == symbols[index++]);
   REQUIRE("ecc" == symbols[index++]);
   REQUIRE("ecd" == symbols[index++]);
   REQUIRE("ece" == symbols[index++]);
   REQUIRE("ecf" == symbols[index++]);
   REQUIRE("ecg" == symbols[index++]);
   REQUIRE("eda" == symbols[index++]);
   REQUIRE("edb" == symbols[index++]);
   REQUIRE("edc" == symbols[index++]);
   REQUIRE("edd" == symbols[index++]);
   REQUIRE("ede" == symbols[index++]);
   REQUIRE("edf" == symbols[index++]);
   REQUIRE("edg" == symbols[index++]);
   REQUIRE("eea" == symbols[index++]);
   REQUIRE("eeb" == symbols[index++]);
   REQUIRE("eec" == symbols[index++]);
   REQUIRE("eed" == symbols[index++]);
   REQUIRE("eee" == symbols[index++]);
   REQUIRE("eef" == symbols[index++]);
   REQUIRE("eeg" == symbols[index++]);
   REQUIRE("efa" == symbols[index++]);
   REQUIRE("efb" == symbols[index++]);
   REQUIRE("efc" == symbols[index++]);
   REQUIRE("efd" == symbols[index++]);
   REQUIRE("efe" == symbols[index++]);
   REQUIRE("eff" == symbols[index++]);
   REQUIRE("efg" == symbols[index++]);
   REQUIRE("ega" == symbols[index++]);
   REQUIRE("egb" == symbols[index++]);
   REQUIRE("egc" == symbols[index++]);
   REQUIRE("egd" == symbols[index++]);
   REQUIRE("ege" == symbols[index++]);
   REQUIRE("egf" == symbols[index++]);
   REQUIRE("egg" == symbols[index++]);
   REQUIRE("faa" == symbols[index++]);
   REQUIRE("fab" == symbols[index++]);
   REQUIRE("fac" == symbols[index++]);
   REQUIRE("fad" == symbols[index++]);
   REQUIRE("fae" == symbols[index++]);
   REQUIRE("faf" == symbols[index++]);
   REQUIRE("fag" == symbols[index++]);
   REQUIRE("fba" == symbols[index++]);
   REQUIRE("fbb" == symbols[index++]);
   REQUIRE("fbc" == symbols[index++]);
   REQUIRE("fbd" == symbols[index++]);
   REQUIRE("fbe" == symbols[index++]);
   REQUIRE("fbf" == symbols[index++]);
   REQUIRE("fbg" == symbols[index++]);
   REQUIRE("fca" == symbols[index++]);
   REQUIRE("fcb" == symbols[index++]);
   REQUIRE("fcc" == symbols[index++]);
   REQUIRE("fcd" == symbols[index++]);
   REQUIRE("fce" == symbols[index++]);
   REQUIRE("fcf" == symbols[index++]);
   REQUIRE("fcg" == symbols[index++]);
   REQUIRE("fda" == symbols[index++]);
   REQUIRE("fdb" == symbols[index++]);
   REQUIRE("fdc" == symbols[index++]);
   REQUIRE("fdd" == symbols[index++]);
   REQUIRE("fde" == symbols[index++]);
   REQUIRE("fdf" == symbols[index++]);
   REQUIRE("fdg" == symbols[index++]);
   REQUIRE("fea" == symbols[index++]);
   REQUIRE("feb" == symbols[index++]);
   REQUIRE("fec" == symbols[index++]);
   REQUIRE("fed" == symbols[index++]);
   REQUIRE("fee" == symbols[index++]);
   REQUIRE("fef" == symbols[index++]);
   REQUIRE("feg" == symbols[index++]);
   REQUIRE("ffa" == symbols[index++]);
   REQUIRE("ffb" == symbols[index++]);
   REQUIRE("ffc" == symbols[index++]);
   REQUIRE("ffd" == symbols[index++]);
   REQUIRE("ffe" == symbols[index++]);
   REQUIRE("fff" == symbols[index++]);
   REQUIRE("ffg" == symbols[index++]);
   REQUIRE("fga" == symbols[index++]);
   REQUIRE("fgb" == symbols[index++]);
   REQUIRE("fgc" == symbols[index++]);
   REQUIRE("fgd" == symbols[index++]);
   REQUIRE("fge" == symbols[index++]);
   REQUIRE("fgf" == symbols[index++]);
   REQUIRE("fgg" == symbols[index++]);
   REQUIRE("gaa" == symbols[index++]);
   REQUIRE("gab" == symbols[index++]);
   REQUIRE("gac" == symbols[index++]);
   REQUIRE("gad" == symbols[index++]);
   REQUIRE("gae" == symbols[index++]);
   REQUIRE("gaf" == symbols[index++]);
   REQUIRE("gag" == symbols[index++]);
   REQUIRE("gba" == symbols[index++]);
   REQUIRE("gbb" == symbols[index++]);
   REQUIRE("gbc" == symbols[index++]);
   REQUIRE("gbd" == symbols[index++]);
   REQUIRE("gbe" == symbols[index++]);
   REQUIRE("gbf" == symbols[index++]);
   REQUIRE("gbg" == symbols[index++]);
   REQUIRE("gca" == symbols[index++]);
   REQUIRE("gcb" == symbols[index++]);
   REQUIRE("gcc" == symbols[index++]);
   REQUIRE("gcd" == symbols[index++]);
   REQUIRE("gce" == symbols[index++]);
   REQUIRE("gcf" == symbols[index++]);
   REQUIRE("gcg" == symbols[index++]);
   REQUIRE("gda" == symbols[index++]);
   REQUIRE("gdb" == symbols[index++]);
   REQUIRE("gdc" == symbols[index++]);
   REQUIRE("gdd" == symbols[index++]);
   REQUIRE("gde" == symbols[index++]);
   REQUIRE("gdf" == symbols[index++]);
   REQUIRE("gdg" == symbols[index++]);
   REQUIRE("gea" == symbols[index++]);
   REQUIRE("geb" == symbols[index++]);
   REQUIRE("gec" == symbols[index++]);
   REQUIRE("ged" == symbols[index++]);
   REQUIRE("gee" == symbols[index++]);
   REQUIRE("gef" == symbols[index++]);
   REQUIRE("geg" == symbols[index++]);
   REQUIRE("gfa" == symbols[index++]);
   REQUIRE("gfb" == symbols[index++]);
   REQUIRE("gfc" == symbols[index++]);
   REQUIRE("gfd" == symbols[index++]);
   REQUIRE("gfe" == symbols[index++]);
   REQUIRE("gff" == symbols[index++]);
   REQUIRE("gfg" == symbols[index++]);
   REQUIRE("gga" == symbols[index++]);
   REQUIRE("ggb" == symbols[index++]);
   REQUIRE("ggc" == symbols[index++]);
   REQUIRE("ggd" == symbols[index++]);
   REQUIRE("gge" == symbols[index++]);
   REQUIRE("ggf" == symbols[index++]);
   REQUIRE("ggg" == symbols[index++]);
}

TEST_CASE("Test total volume for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.FindInstrument("aaa").GetTotalVolume() == 8783);
   REQUIRE(market.FindInstrument("aab").GetTotalVolume() == 10570);
   REQUIRE(market.FindInstrument("aac").GetTotalVolume() == 9620);
   REQUIRE(market.FindInstrument("aad").GetTotalVolume() == 9035);
   REQUIRE(market.FindInstrument("aae").GetTotalVolume() == 8438);
   REQUIRE(market.FindInstrument("aaf").GetTotalVolume() == 7271);
   REQUIRE(market.FindInstrument("aag").GetTotalVolume() == 9451);
   REQUIRE(market.FindInstrument("aba").GetTotalVolume() == 9670);
   REQUIRE(market.FindInstrument("abb").GetTotalVolume() == 8963);
   REQUIRE(market.FindInstrument("abc").GetTotalVolume() == 6553);
   REQUIRE(market.FindInstrument("abd").GetTotalVolume() == 8078);
   REQUIRE(market.FindInstrument("abe").GetTotalVolume() == 9540);
   REQUIRE(market.FindInstrument("abf").GetTotalVolume() == 7570);
   REQUIRE(market.FindInstrument("abg").GetTotalVolume() == 8885);
   REQUIRE(market.FindInstrument("aca").GetTotalVolume() == 9557);
   REQUIRE(market.FindInstrument("acb").GetTotalVolume() == 9264);
   REQUIRE(market.FindInstrument("acc").GetTotalVolume() == 7929);
   REQUIRE(market.FindInstrument("acd").GetTotalVolume() == 8656);
   REQUIRE(market.FindInstrument("ace").GetTotalVolume() == 9661);
   REQUIRE(market.FindInstrument("acf").GetTotalVolume() == 7682);
   REQUIRE(market.FindInstrument("acg").GetTotalVolume() == 9589);
   REQUIRE(market.FindInstrument("ada").GetTotalVolume() == 7554);
   REQUIRE(market.FindInstrument("adb").GetTotalVolume() == 7157);
   REQUIRE(market.FindInstrument("adc").GetTotalVolume() == 10216);
   REQUIRE(market.FindInstrument("add").GetTotalVolume() == 10022);
   REQUIRE(market.FindInstrument("ade").GetTotalVolume() == 7605);
   REQUIRE(market.FindInstrument("adf").GetTotalVolume() == 10119);
   REQUIRE(market.FindInstrument("adg").GetTotalVolume() == 8862);
   REQUIRE(market.FindInstrument("aea").GetTotalVolume() == 9233);
   REQUIRE(market.FindInstrument("aeb").GetTotalVolume() == 8963);
   REQUIRE(market.FindInstrument("aec").GetTotalVolume() == 9840);
   REQUIRE(market.FindInstrument("aed").GetTotalVolume() == 8480);
   REQUIRE(market.FindInstrument("aee").GetTotalVolume() == 7669);
   REQUIRE(market.FindInstrument("aef").GetTotalVolume() == 8054);
   REQUIRE(market.FindInstrument("aeg").GetTotalVolume() == 8055);
   REQUIRE(market.FindInstrument("afa").GetTotalVolume() == 9507);
   REQUIRE(market.FindInstrument("afb").GetTotalVolume() == 9742);
   REQUIRE(market.FindInstrument("afc").GetTotalVolume() == 9008);
   REQUIRE(market.FindInstrument("afd").GetTotalVolume() == 10252);
   REQUIRE(market.FindInstrument("afe").GetTotalVolume() == 6842);
   REQUIRE(market.FindInstrument("aff").GetTotalVolume() == 9354);
   REQUIRE(market.FindInstrument("afg").GetTotalVolume() == 9903);
   REQUIRE(market.FindInstrument("aga").GetTotalVolume() == 8616);
   REQUIRE(market.FindInstrument("agb").GetTotalVolume() == 8734);
   REQUIRE(market.FindInstrument("agc").GetTotalVolume() == 9467);
   REQUIRE(market.FindInstrument("agd").GetTotalVolume() == 9465);
   REQUIRE(market.FindInstrument("age").GetTotalVolume() == 9225);
   REQUIRE(market.FindInstrument("agf").GetTotalVolume() == 9450);
   REQUIRE(market.FindInstrument("agg").GetTotalVolume() == 8226);
   REQUIRE(market.FindInstrument("baa").GetTotalVolume() == 8095);
   REQUIRE(market.FindInstrument("bab").GetTotalVolume() == 7232);
   REQUIRE(market.FindInstrument("bac").GetTotalVolume() == 8831);
   REQUIRE(market.FindInstrument("bad").GetTotalVolume() == 9810);
   REQUIRE(market.FindInstrument("bae").GetTotalVolume() == 7754);
   REQUIRE(market.FindInstrument("baf").GetTotalVolume() == 8199);
   REQUIRE(market.FindInstrument("bag").GetTotalVolume() == 7611);
   REQUIRE(market.FindInstrument("bba").GetTotalVolume() == 9915);
   REQUIRE(market.FindInstrument("bbb").GetTotalVolume() == 8094);
   REQUIRE(market.FindInstrument("bbc").GetTotalVolume() == 9290);
   REQUIRE(market.FindInstrument("bbd").GetTotalVolume() == 9708);
   REQUIRE(market.FindInstrument("bbe").GetTotalVolume() == 8278);
   REQUIRE(market.FindInstrument("bbf").GetTotalVolume() == 8746);
   REQUIRE(market.FindInstrument("bbg").GetTotalVolume() == 9131);
   REQUIRE(market.FindInstrument("bca").GetTotalVolume() == 9921);
   REQUIRE(market.FindInstrument("bcb").GetTotalVolume() == 10244);
   REQUIRE(market.FindInstrument("bcc").GetTotalVolume() == 9796);
   REQUIRE(market.FindInstrument("bcd").GetTotalVolume() == 9733);
   REQUIRE(market.FindInstrument("bce").GetTotalVolume() == 10165);
   REQUIRE(market.FindInstrument("bcf").GetTotalVolume() == 9749);
   REQUIRE(market.FindInstrument("bcg").GetTotalVolume() == 10035);
   REQUIRE(market.FindInstrument("bda").GetTotalVolume() == 8344);
   REQUIRE(market.FindInstrument("bdb").GetTotalVolume() == 7873);
   REQUIRE(market.FindInstrument("bdc").GetTotalVolume() == 10006);
   REQUIRE(market.FindInstrument("bdd").GetTotalVolume() == 8054);
   REQUIRE(market.FindInstrument("bde").GetTotalVolume() == 9149);
   REQUIRE(market.FindInstrument("bdf").GetTotalVolume() == 8039);
   REQUIRE(market.FindInstrument("bdg").GetTotalVolume() == 9379);
   REQUIRE(market.FindInstrument("bea").GetTotalVolume() == 9561);
   REQUIRE(market.FindInstrument("beb").GetTotalVolume() == 9599);
   REQUIRE(market.FindInstrument("bec").GetTotalVolume() == 9468);
   REQUIRE(market.FindInstrument("bed").GetTotalVolume() == 9586);
   REQUIRE(market.FindInstrument("bee").GetTotalVolume() == 7973);
   REQUIRE(market.FindInstrument("bef").GetTotalVolume() == 8362);
   REQUIRE(market.FindInstrument("beg").GetTotalVolume() == 10223);
   REQUIRE(market.FindInstrument("bfa").GetTotalVolume() == 9372);
   REQUIRE(market.FindInstrument("bfb").GetTotalVolume() == 7930);
   REQUIRE(market.FindInstrument("bfc").GetTotalVolume() == 9101);
   REQUIRE(market.FindInstrument("bfd").GetTotalVolume() == 9485);
   REQUIRE(market.FindInstrument("bfe").GetTotalVolume() == 9704);
   REQUIRE(market.FindInstrument("bff").GetTotalVolume() == 7766);
   REQUIRE(market.FindInstrument("bfg").GetTotalVolume() == 9547);
   REQUIRE(market.FindInstrument("bga").GetTotalVolume() == 8828);
   REQUIRE(market.FindInstrument("bgb").GetTotalVolume() == 8023);
   REQUIRE(market.FindInstrument("bgc").GetTotalVolume() == 9651);
   REQUIRE(market.FindInstrument("bgd").GetTotalVolume() == 9011);
   REQUIRE(market.FindInstrument("bge").GetTotalVolume() == 9534);
   REQUIRE(market.FindInstrument("bgf").GetTotalVolume() == 7803);
   REQUIRE(market.FindInstrument("bgg").GetTotalVolume() == 9895);
   REQUIRE(market.FindInstrument("caa").GetTotalVolume() == 10286);
   REQUIRE(market.FindInstrument("cab").GetTotalVolume() == 8849);
   REQUIRE(market.FindInstrument("cac").GetTotalVolume() == 9323);
   REQUIRE(market.FindInstrument("cad").GetTotalVolume() == 8153);
   REQUIRE(market.FindInstrument("cae").GetTotalVolume() == 8467);
   REQUIRE(market.FindInstrument("caf").GetTotalVolume() == 9022);
   REQUIRE(market.FindInstrument("cag").GetTotalVolume() == 7389);
   REQUIRE(market.FindInstrument("cba").GetTotalVolume() == 8422);
   REQUIRE(market.FindInstrument("cbb").GetTotalVolume() == 8140);
   REQUIRE(market.FindInstrument("cbc").GetTotalVolume() == 9888);
   REQUIRE(market.FindInstrument("cbd").GetTotalVolume() == 9561);
   REQUIRE(market.FindInstrument("cbe").GetTotalVolume() == 9380);
   REQUIRE(market.FindInstrument("cbf").GetTotalVolume() == 8424);
   REQUIRE(market.FindInstrument("cbg").GetTotalVolume() == 9654);
   REQUIRE(market.FindInstrument("cca").GetTotalVolume() == 8415);
   REQUIRE(market.FindInstrument("ccb").GetTotalVolume() == 8298);
   REQUIRE(market.FindInstrument("ccc").GetTotalVolume() == 9077);
   REQUIRE(market.FindInstrument("ccd").GetTotalVolume() == 6853);
   REQUIRE(market.FindInstrument("cce").GetTotalVolume() == 11145);
   REQUIRE(market.FindInstrument("ccf").GetTotalVolume() == 9986);
   REQUIRE(market.FindInstrument("ccg").GetTotalVolume() == 7647);
   REQUIRE(market.FindInstrument("cda").GetTotalVolume() == 8657);
   REQUIRE(market.FindInstrument("cdb").GetTotalVolume() == 9431);
   REQUIRE(market.FindInstrument("cdc").GetTotalVolume() == 9770);
   REQUIRE(market.FindInstrument("cdd").GetTotalVolume() == 8225);
   REQUIRE(market.FindInstrument("cde").GetTotalVolume() == 8196);
   REQUIRE(market.FindInstrument("cdf").GetTotalVolume() == 9639);
   REQUIRE(market.FindInstrument("cdg").GetTotalVolume() == 10219);
   REQUIRE(market.FindInstrument("cea").GetTotalVolume() == 8914);
   REQUIRE(market.FindInstrument("ceb").GetTotalVolume() == 9471);
   REQUIRE(market.FindInstrument("cec").GetTotalVolume() == 9321);
   REQUIRE(market.FindInstrument("ced").GetTotalVolume() == 8209);
   REQUIRE(market.FindInstrument("cee").GetTotalVolume() == 8823);
   REQUIRE(market.FindInstrument("cef").GetTotalVolume() == 7489);
   REQUIRE(market.FindInstrument("ceg").GetTotalVolume() == 9344);
   REQUIRE(market.FindInstrument("cfa").GetTotalVolume() == 9849);
   REQUIRE(market.FindInstrument("cfb").GetTotalVolume() == 10241);
   REQUIRE(market.FindInstrument("cfc").GetTotalVolume() == 8733);
   REQUIRE(market.FindInstrument("cfd").GetTotalVolume() == 8161);
   REQUIRE(market.FindInstrument("cfe").GetTotalVolume() == 8748);
   REQUIRE(market.FindInstrument("cff").GetTotalVolume() == 9555);
   REQUIRE(market.FindInstrument("cfg").GetTotalVolume() == 7740);
   REQUIRE(market.FindInstrument("cga").GetTotalVolume() == 7873);
   REQUIRE(market.FindInstrument("cgb").GetTotalVolume() == 8550);
   REQUIRE(market.FindInstrument("cgc").GetTotalVolume() == 10015);
   REQUIRE(market.FindInstrument("cgd").GetTotalVolume() == 9128);
   REQUIRE(market.FindInstrument("cge").GetTotalVolume() == 9588);
   REQUIRE(market.FindInstrument("cgf").GetTotalVolume() == 9473);
   REQUIRE(market.FindInstrument("cgg").GetTotalVolume() == 8692);
   REQUIRE(market.FindInstrument("daa").GetTotalVolume() == 8767);
   REQUIRE(market.FindInstrument("dab").GetTotalVolume() == 8577);
   REQUIRE(market.FindInstrument("dac").GetTotalVolume() == 8239);
   REQUIRE(market.FindInstrument("dad").GetTotalVolume() == 8165);
   REQUIRE(market.FindInstrument("dae").GetTotalVolume() == 8821);
   REQUIRE(market.FindInstrument("daf").GetTotalVolume() == 9474);
   REQUIRE(market.FindInstrument("dag").GetTotalVolume() == 8435);
   REQUIRE(market.FindInstrument("dba").GetTotalVolume() == 9552);
   REQUIRE(market.FindInstrument("dbb").GetTotalVolume() == 9248);
   REQUIRE(market.FindInstrument("dbc").GetTotalVolume() == 10017);
   REQUIRE(market.FindInstrument("dbd").GetTotalVolume() == 8704);
   REQUIRE(market.FindInstrument("dbe").GetTotalVolume() == 7765);
   REQUIRE(market.FindInstrument("dbf").GetTotalVolume() == 9924);
   REQUIRE(market.FindInstrument("dbg").GetTotalVolume() == 9947);
   REQUIRE(market.FindInstrument("dca").GetTotalVolume() == 7416);
   REQUIRE(market.FindInstrument("dcb").GetTotalVolume() == 8898);
   REQUIRE(market.FindInstrument("dcc").GetTotalVolume() == 8779);
   REQUIRE(market.FindInstrument("dcd").GetTotalVolume() == 9339);
   REQUIRE(market.FindInstrument("dce").GetTotalVolume() == 8920);
   REQUIRE(market.FindInstrument("dcf").GetTotalVolume() == 9618);
   REQUIRE(market.FindInstrument("dcg").GetTotalVolume() == 8805);
   REQUIRE(market.FindInstrument("dda").GetTotalVolume() == 8212);
   REQUIRE(market.FindInstrument("ddb").GetTotalVolume() == 8111);
   REQUIRE(market.FindInstrument("ddc").GetTotalVolume() == 7290);
   REQUIRE(market.FindInstrument("ddd").GetTotalVolume() == 9605);
   REQUIRE(market.FindInstrument("dde").GetTotalVolume() == 9942);
   REQUIRE(market.FindInstrument("ddf").GetTotalVolume() == 9187);
   REQUIRE(market.FindInstrument("ddg").GetTotalVolume() == 9757);
   REQUIRE(market.FindInstrument("dea").GetTotalVolume() == 9543);
   REQUIRE(market.FindInstrument("deb").GetTotalVolume() == 7978);
   REQUIRE(market.FindInstrument("dec").GetTotalVolume() == 9134);
   REQUIRE(market.FindInstrument("ded").GetTotalVolume() == 8208);
   REQUIRE(market.FindInstrument("dee").GetTotalVolume() == 8648);
   REQUIRE(market.FindInstrument("def").GetTotalVolume() == 9723);
   REQUIRE(market.FindInstrument("deg").GetTotalVolume() == 8580);
   REQUIRE(market.FindInstrument("dfa").GetTotalVolume() == 7838);
   REQUIRE(market.FindInstrument("dfb").GetTotalVolume() == 8268);
   REQUIRE(market.FindInstrument("dfc").GetTotalVolume() == 8297);
   REQUIRE(market.FindInstrument("dfd").GetTotalVolume() == 8910);
   REQUIRE(market.FindInstrument("dfe").GetTotalVolume() == 10581);
   REQUIRE(market.FindInstrument("dff").GetTotalVolume() == 9464);
   REQUIRE(market.FindInstrument("dfg").GetTotalVolume() == 8913);
   REQUIRE(market.FindInstrument("dga").GetTotalVolume() == 8470);
   REQUIRE(market.FindInstrument("dgb").GetTotalVolume() == 8254);
   REQUIRE(market.FindInstrument("dgc").GetTotalVolume() == 10537);
   REQUIRE(market.FindInstrument("dgd").GetTotalVolume() == 9697);
   REQUIRE(market.FindInstrument("dge").GetTotalVolume() == 10003);
   REQUIRE(market.FindInstrument("dgf").GetTotalVolume() == 8440);
   REQUIRE(market.FindInstrument("dgg").GetTotalVolume() == 8141);
   REQUIRE(market.FindInstrument("eaa").GetTotalVolume() == 7962);
   REQUIRE(market.FindInstrument("eab").GetTotalVolume() == 8899);
   REQUIRE(market.FindInstrument("eac").GetTotalVolume() == 10432);
   REQUIRE(market.FindInstrument("ead").GetTotalVolume() == 8524);
   REQUIRE(market.FindInstrument("eae").GetTotalVolume() == 8106);
   REQUIRE(market.FindInstrument("eaf").GetTotalVolume() == 8780);
   REQUIRE(market.FindInstrument("eag").GetTotalVolume() == 8946);
   REQUIRE(market.FindInstrument("eba").GetTotalVolume() == 8583);
   REQUIRE(market.FindInstrument("ebb").GetTotalVolume() == 11185);
   REQUIRE(market.FindInstrument("ebc").GetTotalVolume() == 8039);
   REQUIRE(market.FindInstrument("ebd").GetTotalVolume() == 9690);
   REQUIRE(market.FindInstrument("ebe").GetTotalVolume() == 11187);
   REQUIRE(market.FindInstrument("ebf").GetTotalVolume() == 9034);
   REQUIRE(market.FindInstrument("ebg").GetTotalVolume() == 8676);
   REQUIRE(market.FindInstrument("eca").GetTotalVolume() == 9519);
   REQUIRE(market.FindInstrument("ecb").GetTotalVolume() == 8155);
   REQUIRE(market.FindInstrument("ecc").GetTotalVolume() == 7443);
   REQUIRE(market.FindInstrument("ecd").GetTotalVolume() == 9009);
   REQUIRE(market.FindInstrument("ece").GetTotalVolume() == 10282);
   REQUIRE(market.FindInstrument("ecf").GetTotalVolume() == 7982);
   REQUIRE(market.FindInstrument("ecg").GetTotalVolume() == 6890);
   REQUIRE(market.FindInstrument("eda").GetTotalVolume() == 9144);
   REQUIRE(market.FindInstrument("edb").GetTotalVolume() == 8887);
   REQUIRE(market.FindInstrument("edc").GetTotalVolume() == 9811);
   REQUIRE(market.FindInstrument("edd").GetTotalVolume() == 8749);
   REQUIRE(market.FindInstrument("ede").GetTotalVolume() == 7193);
   REQUIRE(market.FindInstrument("edf").GetTotalVolume() == 8176);
   REQUIRE(market.FindInstrument("edg").GetTotalVolume() == 8397);
   REQUIRE(market.FindInstrument("eea").GetTotalVolume() == 9882);
   REQUIRE(market.FindInstrument("eeb").GetTotalVolume() == 9732);
   REQUIRE(market.FindInstrument("eec").GetTotalVolume() == 7746);
   REQUIRE(market.FindInstrument("eed").GetTotalVolume() == 8162);
   REQUIRE(market.FindInstrument("eee").GetTotalVolume() == 8908);
   REQUIRE(market.FindInstrument("eef").GetTotalVolume() == 7902);
   REQUIRE(market.FindInstrument("eeg").GetTotalVolume() == 8243);
   REQUIRE(market.FindInstrument("efa").GetTotalVolume() == 10810);
   REQUIRE(market.FindInstrument("efb").GetTotalVolume() == 7662);
   REQUIRE(market.FindInstrument("efc").GetTotalVolume() == 8862);
   REQUIRE(market.FindInstrument("efd").GetTotalVolume() == 9165);
   REQUIRE(market.FindInstrument("efe").GetTotalVolume() == 8312);
   REQUIRE(market.FindInstrument("eff").GetTotalVolume() == 9659);
   REQUIRE(market.FindInstrument("efg").GetTotalVolume() == 9798);
   REQUIRE(market.FindInstrument("ega").GetTotalVolume() == 9795);
   REQUIRE(market.FindInstrument("egb").GetTotalVolume() == 9517);
   REQUIRE(market.FindInstrument("egc").GetTotalVolume() == 8619);
   REQUIRE(market.FindInstrument("egd").GetTotalVolume() == 8723);
   REQUIRE(market.FindInstrument("ege").GetTotalVolume() == 9524);
   REQUIRE(market.FindInstrument("egf").GetTotalVolume() == 6778);
   REQUIRE(market.FindInstrument("egg").GetTotalVolume() == 7352);
   REQUIRE(market.FindInstrument("faa").GetTotalVolume() == 9116);
   REQUIRE(market.FindInstrument("fab").GetTotalVolume() == 6846);
   REQUIRE(market.FindInstrument("fac").GetTotalVolume() == 7666);
   REQUIRE(market.FindInstrument("fad").GetTotalVolume() == 8114);
   REQUIRE(market.FindInstrument("fae").GetTotalVolume() == 9303);
   REQUIRE(market.FindInstrument("faf").GetTotalVolume() == 8208);
   REQUIRE(market.FindInstrument("fag").GetTotalVolume() == 8533);
   REQUIRE(market.FindInstrument("fba").GetTotalVolume() == 8137);
   REQUIRE(market.FindInstrument("fbb").GetTotalVolume() == 8203);
   REQUIRE(market.FindInstrument("fbc").GetTotalVolume() == 9140);
   REQUIRE(market.FindInstrument("fbd").GetTotalVolume() == 8316);
   REQUIRE(market.FindInstrument("fbe").GetTotalVolume() == 7964);
   REQUIRE(market.FindInstrument("fbf").GetTotalVolume() == 8656);
   REQUIRE(market.FindInstrument("fbg").GetTotalVolume() == 10345);
   REQUIRE(market.FindInstrument("fca").GetTotalVolume() == 8606);
   REQUIRE(market.FindInstrument("fcb").GetTotalVolume() == 9025);
   REQUIRE(market.FindInstrument("fcc").GetTotalVolume() == 9737);
   REQUIRE(market.FindInstrument("fcd").GetTotalVolume() == 10176);
   REQUIRE(market.FindInstrument("fce").GetTotalVolume() == 9433);
   REQUIRE(market.FindInstrument("fcf").GetTotalVolume() == 8119);
   REQUIRE(market.FindInstrument("fcg").GetTotalVolume() == 10509);
   REQUIRE(market.FindInstrument("fda").GetTotalVolume() == 8758);
   REQUIRE(market.FindInstrument("fdb").GetTotalVolume() == 10140);
   REQUIRE(market.FindInstrument("fdc").GetTotalVolume() == 9297);
   REQUIRE(market.FindInstrument("fdd").GetTotalVolume() == 9540);
   REQUIRE(market.FindInstrument("fde").GetTotalVolume() == 8033);
   REQUIRE(market.FindInstrument("fdf").GetTotalVolume() == 9900);
   REQUIRE(market.FindInstrument("fdg").GetTotalVolume() == 8896);
   REQUIRE(market.FindInstrument("fea").GetTotalVolume() == 6841);
   REQUIRE(market.FindInstrument("feb").GetTotalVolume() == 8958);
   REQUIRE(market.FindInstrument("fec").GetTotalVolume() == 9137);
   REQUIRE(market.FindInstrument("fed").GetTotalVolume() == 8971);
   REQUIRE(market.FindInstrument("fee").GetTotalVolume() == 8575);
   REQUIRE(market.FindInstrument("fef").GetTotalVolume() == 8517);
   REQUIRE(market.FindInstrument("feg").GetTotalVolume() == 9717);
   REQUIRE(market.FindInstrument("ffa").GetTotalVolume() == 9170);
   REQUIRE(market.FindInstrument("ffb").GetTotalVolume() == 7512);
   REQUIRE(market.FindInstrument("ffc").GetTotalVolume() == 8610);
   REQUIRE(market.FindInstrument("ffd").GetTotalVolume() == 11054);
   REQUIRE(market.FindInstrument("ffe").GetTotalVolume() == 8832);
   REQUIRE(market.FindInstrument("fff").GetTotalVolume() == 7556);
   REQUIRE(market.FindInstrument("ffg").GetTotalVolume() == 8278);
   REQUIRE(market.FindInstrument("fga").GetTotalVolume() == 9796);
   REQUIRE(market.FindInstrument("fgb").GetTotalVolume() == 9013);
   REQUIRE(market.FindInstrument("fgc").GetTotalVolume() == 7611);
   REQUIRE(market.FindInstrument("fgd").GetTotalVolume() == 9391);
   REQUIRE(market.FindInstrument("fge").GetTotalVolume() == 8673);
   REQUIRE(market.FindInstrument("fgf").GetTotalVolume() == 8762);
   REQUIRE(market.FindInstrument("fgg").GetTotalVolume() == 9639);
   REQUIRE(market.FindInstrument("gaa").GetTotalVolume() == 10368);
   REQUIRE(market.FindInstrument("gab").GetTotalVolume() == 10601);
   REQUIRE(market.FindInstrument("gac").GetTotalVolume() == 8350);
   REQUIRE(market.FindInstrument("gad").GetTotalVolume() == 10304);
   REQUIRE(market.FindInstrument("gae").GetTotalVolume() == 8579);
   REQUIRE(market.FindInstrument("gaf").GetTotalVolume() == 7731);
   REQUIRE(market.FindInstrument("gag").GetTotalVolume() == 8801);
   REQUIRE(market.FindInstrument("gba").GetTotalVolume() == 8828);
   REQUIRE(market.FindInstrument("gbb").GetTotalVolume() == 10818);
   REQUIRE(market.FindInstrument("gbc").GetTotalVolume() == 7804);
   REQUIRE(market.FindInstrument("gbd").GetTotalVolume() == 9264);
   REQUIRE(market.FindInstrument("gbe").GetTotalVolume() == 7351);
   REQUIRE(market.FindInstrument("gbf").GetTotalVolume() == 9573);
   REQUIRE(market.FindInstrument("gbg").GetTotalVolume() == 8290);
   REQUIRE(market.FindInstrument("gca").GetTotalVolume() == 8708);
   REQUIRE(market.FindInstrument("gcb").GetTotalVolume() == 8684);
   REQUIRE(market.FindInstrument("gcc").GetTotalVolume() == 8777);
   REQUIRE(market.FindInstrument("gcd").GetTotalVolume() == 8504);
   REQUIRE(market.FindInstrument("gce").GetTotalVolume() == 8356);
   REQUIRE(market.FindInstrument("gcf").GetTotalVolume() == 10593);
   REQUIRE(market.FindInstrument("gcg").GetTotalVolume() == 10242);
   REQUIRE(market.FindInstrument("gda").GetTotalVolume() == 8236);
   REQUIRE(market.FindInstrument("gdb").GetTotalVolume() == 8321);
   REQUIRE(market.FindInstrument("gdc").GetTotalVolume() == 9204);
   REQUIRE(market.FindInstrument("gdd").GetTotalVolume() == 9618);
   REQUIRE(market.FindInstrument("gde").GetTotalVolume() == 7201);
   REQUIRE(market.FindInstrument("gdf").GetTotalVolume() == 9803);
   REQUIRE(market.FindInstrument("gdg").GetTotalVolume() == 8919);
   REQUIRE(market.FindInstrument("gea").GetTotalVolume() == 9502);
   REQUIRE(market.FindInstrument("geb").GetTotalVolume() == 8037);
   REQUIRE(market.FindInstrument("gec").GetTotalVolume() == 8585);
   REQUIRE(market.FindInstrument("ged").GetTotalVolume() == 8522);
   REQUIRE(market.FindInstrument("gee").GetTotalVolume() == 10120);
   REQUIRE(market.FindInstrument("gef").GetTotalVolume() == 6915);
   REQUIRE(market.FindInstrument("geg").GetTotalVolume() == 9824);
   REQUIRE(market.FindInstrument("gfa").GetTotalVolume() == 8108);
   REQUIRE(market.FindInstrument("gfb").GetTotalVolume() == 9444);
   REQUIRE(market.FindInstrument("gfc").GetTotalVolume() == 7958);
   REQUIRE(market.FindInstrument("gfd").GetTotalVolume() == 9907);
   REQUIRE(market.FindInstrument("gfe").GetTotalVolume() == 9885);
   REQUIRE(market.FindInstrument("gff").GetTotalVolume() == 8583);
   REQUIRE(market.FindInstrument("gfg").GetTotalVolume() == 8770);
   REQUIRE(market.FindInstrument("gga").GetTotalVolume() == 10756);
   REQUIRE(market.FindInstrument("ggb").GetTotalVolume() == 8182);
   REQUIRE(market.FindInstrument("ggc").GetTotalVolume() == 9138);
   REQUIRE(market.FindInstrument("ggd").GetTotalVolume() == 7716);
   REQUIRE(market.FindInstrument("gge").GetTotalVolume() == 8528);
   REQUIRE(market.FindInstrument("ggf").GetTotalVolume() == 9584);
   REQUIRE(market.FindInstrument("ggg").GetTotalVolume() == 9633);
}

TEST_CASE("Test high for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

	REQUIRE(market.FindInstrument("aaa").GetHigh() == 269);
	REQUIRE(market.FindInstrument("aab").GetHigh() == 36);
	REQUIRE(market.FindInstrument("aac").GetHigh() == 185);
	REQUIRE(market.FindInstrument("aad").GetHigh() == 121);
	REQUIRE(market.FindInstrument("aae").GetHigh() == 51);
	REQUIRE(market.FindInstrument("aaf").GetHigh() == 114);
	REQUIRE(market.FindInstrument("aag").GetHigh() == 205);
	REQUIRE(market.FindInstrument("aba").GetHigh() == 454);
	REQUIRE(market.FindInstrument("abb").GetHigh() == 226);
	REQUIRE(market.FindInstrument("abc").GetHigh() == 386);
	REQUIRE(market.FindInstrument("abd").GetHigh() == 91);
	REQUIRE(market.FindInstrument("abe").GetHigh() == 178);
	REQUIRE(market.FindInstrument("abf").GetHigh() == 422);
	REQUIRE(market.FindInstrument("abg").GetHigh() == 25);
	REQUIRE(market.FindInstrument("aca").GetHigh() == 442);
	REQUIRE(market.FindInstrument("acb").GetHigh() == 207);
	REQUIRE(market.FindInstrument("acc").GetHigh() == 148);
	REQUIRE(market.FindInstrument("acd").GetHigh() == 89);
	REQUIRE(market.FindInstrument("ace").GetHigh() == 146);
	REQUIRE(market.FindInstrument("acf").GetHigh() == 369);
	REQUIRE(market.FindInstrument("acg").GetHigh() == 104);
	REQUIRE(market.FindInstrument("ada").GetHigh() == 81);
	REQUIRE(market.FindInstrument("adb").GetHigh() == 423);
	REQUIRE(market.FindInstrument("adc").GetHigh() == 9);
	REQUIRE(market.FindInstrument("add").GetHigh() == 93);
	REQUIRE(market.FindInstrument("ade").GetHigh() == 428);
	REQUIRE(market.FindInstrument("adf").GetHigh() == 14);
	REQUIRE(market.FindInstrument("adg").GetHigh() == 838);
	REQUIRE(market.FindInstrument("aea").GetHigh() == 239);
	REQUIRE(market.FindInstrument("aeb").GetHigh() == 142);
	REQUIRE(market.FindInstrument("aec").GetHigh() == 5);
	REQUIRE(market.FindInstrument("aed").GetHigh() == 145);
	REQUIRE(market.FindInstrument("aee").GetHigh() == 140);
	REQUIRE(market.FindInstrument("aef").GetHigh() == 298);
	REQUIRE(market.FindInstrument("aeg").GetHigh() == 123);
	REQUIRE(market.FindInstrument("afa").GetHigh() == 111);
	REQUIRE(market.FindInstrument("afb").GetHigh() == 380);
	REQUIRE(market.FindInstrument("afc").GetHigh() == 501);
	REQUIRE(market.FindInstrument("afd").GetHigh() == 9);
	REQUIRE(market.FindInstrument("afe").GetHigh() == 107);
	REQUIRE(market.FindInstrument("aff").GetHigh() == 228);
	REQUIRE(market.FindInstrument("afg").GetHigh() == 197);
	REQUIRE(market.FindInstrument("aga").GetHigh() == 353);
	REQUIRE(market.FindInstrument("agb").GetHigh() == 258);
	REQUIRE(market.FindInstrument("agc").GetHigh() == 475);
	REQUIRE(market.FindInstrument("agd").GetHigh() == 398);
	REQUIRE(market.FindInstrument("age").GetHigh() == 11);
	REQUIRE(market.FindInstrument("agf").GetHigh() == 129);
	REQUIRE(market.FindInstrument("agg").GetHigh() == 608);
	REQUIRE(market.FindInstrument("baa").GetHigh() == 180);
	REQUIRE(market.FindInstrument("bab").GetHigh() == 218);
	REQUIRE(market.FindInstrument("bac").GetHigh() == 330);
	REQUIRE(market.FindInstrument("bad").GetHigh() == 72);
	REQUIRE(market.FindInstrument("bae").GetHigh() == 453);
	REQUIRE(market.FindInstrument("baf").GetHigh() == 273);
	REQUIRE(market.FindInstrument("bag").GetHigh() == 507);
	REQUIRE(market.FindInstrument("bba").GetHigh() == 66);
	REQUIRE(market.FindInstrument("bbb").GetHigh() == 138);
	REQUIRE(market.FindInstrument("bbc").GetHigh() == 190);
	REQUIRE(market.FindInstrument("bbd").GetHigh() == 287);
	REQUIRE(market.FindInstrument("bbe").GetHigh() == 187);
	REQUIRE(market.FindInstrument("bbf").GetHigh() == 7);
	REQUIRE(market.FindInstrument("bbg").GetHigh() == 276);
	REQUIRE(market.FindInstrument("bca").GetHigh() == 242);
	REQUIRE(market.FindInstrument("bcb").GetHigh() == 153);
	REQUIRE(market.FindInstrument("bcc").GetHigh() == 278);
	REQUIRE(market.FindInstrument("bcd").GetHigh() == 89);
	REQUIRE(market.FindInstrument("bce").GetHigh() == 48);
	REQUIRE(market.FindInstrument("bcf").GetHigh() == 502);
	REQUIRE(market.FindInstrument("bcg").GetHigh() == 34);
	REQUIRE(market.FindInstrument("bda").GetHigh() == 62);
	REQUIRE(market.FindInstrument("bdb").GetHigh() == 101);
	REQUIRE(market.FindInstrument("bdc").GetHigh() == 159);
	REQUIRE(market.FindInstrument("bdd").GetHigh() == 63);
	REQUIRE(market.FindInstrument("bde").GetHigh() == 959);
	REQUIRE(market.FindInstrument("bdf").GetHigh() == 322);
	REQUIRE(market.FindInstrument("bdg").GetHigh() == 330);
	REQUIRE(market.FindInstrument("bea").GetHigh() == 21);
	REQUIRE(market.FindInstrument("beb").GetHigh() == 350);
	REQUIRE(market.FindInstrument("bec").GetHigh() == 97);
	REQUIRE(market.FindInstrument("bed").GetHigh() == 349);
	REQUIRE(market.FindInstrument("bee").GetHigh() == 52);
	REQUIRE(market.FindInstrument("bef").GetHigh() == 117);
	REQUIRE(market.FindInstrument("beg").GetHigh() == 41);
	REQUIRE(market.FindInstrument("bfa").GetHigh() == 5);
	REQUIRE(market.FindInstrument("bfb").GetHigh() == 11);
	REQUIRE(market.FindInstrument("bfc").GetHigh() == 228);
	REQUIRE(market.FindInstrument("bfd").GetHigh() == 416);
	REQUIRE(market.FindInstrument("bfe").GetHigh() == 316);
	REQUIRE(market.FindInstrument("bff").GetHigh() == 388);
	REQUIRE(market.FindInstrument("bfg").GetHigh() == 270);
	REQUIRE(market.FindInstrument("bga").GetHigh() == 73);
	REQUIRE(market.FindInstrument("bgb").GetHigh() == 452);
	REQUIRE(market.FindInstrument("bgc").GetHigh() == 34);
	REQUIRE(market.FindInstrument("bgd").GetHigh() == 170);
	REQUIRE(market.FindInstrument("bge").GetHigh() == 84);
	REQUIRE(market.FindInstrument("bgf").GetHigh() == 333);
	REQUIRE(market.FindInstrument("bgg").GetHigh() == 252);
	REQUIRE(market.FindInstrument("caa").GetHigh() == 269);
	REQUIRE(market.FindInstrument("cab").GetHigh() == 273);
	REQUIRE(market.FindInstrument("cac").GetHigh() == 333);
	REQUIRE(market.FindInstrument("cad").GetHigh() == 368);
	REQUIRE(market.FindInstrument("cae").GetHigh() == 24);
	REQUIRE(market.FindInstrument("caf").GetHigh() == 311);
	REQUIRE(market.FindInstrument("cag").GetHigh() == 191);
	REQUIRE(market.FindInstrument("cba").GetHigh() == 185);
	REQUIRE(market.FindInstrument("cbb").GetHigh() == 170);
	REQUIRE(market.FindInstrument("cbc").GetHigh() == 46);
	REQUIRE(market.FindInstrument("cbd").GetHigh() == 321);
	REQUIRE(market.FindInstrument("cbe").GetHigh() == 654);
	REQUIRE(market.FindInstrument("cbf").GetHigh() == 132);
	REQUIRE(market.FindInstrument("cbg").GetHigh() == 82);
	REQUIRE(market.FindInstrument("cca").GetHigh() == 218);
	REQUIRE(market.FindInstrument("ccb").GetHigh() == 278);
	REQUIRE(market.FindInstrument("ccc").GetHigh() == 159);
	REQUIRE(market.FindInstrument("ccd").GetHigh() == 238);
	REQUIRE(market.FindInstrument("cce").GetHigh() == 299);
	REQUIRE(market.FindInstrument("ccf").GetHigh() == 180);
	REQUIRE(market.FindInstrument("ccg").GetHigh() == 154);
	REQUIRE(market.FindInstrument("cda").GetHigh() == 834);
	REQUIRE(market.FindInstrument("cdb").GetHigh() == 236);
	REQUIRE(market.FindInstrument("cdc").GetHigh() == 145);
	REQUIRE(market.FindInstrument("cdd").GetHigh() == 33);
	REQUIRE(market.FindInstrument("cde").GetHigh() == 87);
	REQUIRE(market.FindInstrument("cdf").GetHigh() == 50);
	REQUIRE(market.FindInstrument("cdg").GetHigh() == 695);
	REQUIRE(market.FindInstrument("cea").GetHigh() == 60);
	REQUIRE(market.FindInstrument("ceb").GetHigh() == 337);
	REQUIRE(market.FindInstrument("cec").GetHigh() == 345);
	REQUIRE(market.FindInstrument("ced").GetHigh() == 1239);
	REQUIRE(market.FindInstrument("cee").GetHigh() == 17);
	REQUIRE(market.FindInstrument("cef").GetHigh() == 113);
	REQUIRE(market.FindInstrument("ceg").GetHigh() == 25);
	REQUIRE(market.FindInstrument("cfa").GetHigh() == 231);
	REQUIRE(market.FindInstrument("cfb").GetHigh() == 206);
	REQUIRE(market.FindInstrument("cfc").GetHigh() == 23);
	REQUIRE(market.FindInstrument("cfd").GetHigh() == 193);
	REQUIRE(market.FindInstrument("cfe").GetHigh() == 116);
	REQUIRE(market.FindInstrument("cff").GetHigh() == 66);
	REQUIRE(market.FindInstrument("cfg").GetHigh() == 700);
	REQUIRE(market.FindInstrument("cga").GetHigh() == 253);
	REQUIRE(market.FindInstrument("cgb").GetHigh() == 240);
	REQUIRE(market.FindInstrument("cgc").GetHigh() == 294);
	REQUIRE(market.FindInstrument("cgd").GetHigh() == 254);
	REQUIRE(market.FindInstrument("cge").GetHigh() == 407);
	REQUIRE(market.FindInstrument("cgf").GetHigh() == 375);
	REQUIRE(market.FindInstrument("cgg").GetHigh() == 219);
	REQUIRE(market.FindInstrument("daa").GetHigh() == 250);
	REQUIRE(market.FindInstrument("dab").GetHigh() == 379);
	REQUIRE(market.FindInstrument("dac").GetHigh() == 265);
	REQUIRE(market.FindInstrument("dad").GetHigh() == 87);
	REQUIRE(market.FindInstrument("dae").GetHigh() == 53);
	REQUIRE(market.FindInstrument("daf").GetHigh() == 29);
	REQUIRE(market.FindInstrument("dag").GetHigh() == 229);
	REQUIRE(market.FindInstrument("dba").GetHigh() == 743);
	REQUIRE(market.FindInstrument("dbb").GetHigh() == 184);
	REQUIRE(market.FindInstrument("dbc").GetHigh() == 89);
	REQUIRE(market.FindInstrument("dbd").GetHigh() == 844);
	REQUIRE(market.FindInstrument("dbe").GetHigh() == 28);
	REQUIRE(market.FindInstrument("dbf").GetHigh() == 287);
	REQUIRE(market.FindInstrument("dbg").GetHigh() == 115);
	REQUIRE(market.FindInstrument("dca").GetHigh() == 46);
	REQUIRE(market.FindInstrument("dcb").GetHigh() == 319);
	REQUIRE(market.FindInstrument("dcc").GetHigh() == 348);
	REQUIRE(market.FindInstrument("dcd").GetHigh() == 241);
	REQUIRE(market.FindInstrument("dce").GetHigh() == 193);
	REQUIRE(market.FindInstrument("dcf").GetHigh() == 188);
	REQUIRE(market.FindInstrument("dcg").GetHigh() == 193);
	REQUIRE(market.FindInstrument("dda").GetHigh() == 430);
	REQUIRE(market.FindInstrument("ddb").GetHigh() == 32);
	REQUIRE(market.FindInstrument("ddc").GetHigh() == 451);
	REQUIRE(market.FindInstrument("ddd").GetHigh() == 327);
	REQUIRE(market.FindInstrument("dde").GetHigh() == 453);
	REQUIRE(market.FindInstrument("ddf").GetHigh() == 72);
	REQUIRE(market.FindInstrument("ddg").GetHigh() == 195);
	REQUIRE(market.FindInstrument("dea").GetHigh() == 87);
	REQUIRE(market.FindInstrument("deb").GetHigh() == 287);
	REQUIRE(market.FindInstrument("dec").GetHigh() == 63);
	REQUIRE(market.FindInstrument("ded").GetHigh() == 127);
	REQUIRE(market.FindInstrument("dee").GetHigh() == 221);
	REQUIRE(market.FindInstrument("def").GetHigh() == 240);
	REQUIRE(market.FindInstrument("deg").GetHigh() == 288);
	REQUIRE(market.FindInstrument("dfa").GetHigh() == 309);
	REQUIRE(market.FindInstrument("dfb").GetHigh() == 79);
	REQUIRE(market.FindInstrument("dfc").GetHigh() == 59);
	REQUIRE(market.FindInstrument("dfd").GetHigh() == 180);
	REQUIRE(market.FindInstrument("dfe").GetHigh() == 259);
	REQUIRE(market.FindInstrument("dff").GetHigh() == 256);
	REQUIRE(market.FindInstrument("dfg").GetHigh() == 290);
	REQUIRE(market.FindInstrument("dga").GetHigh() == 286);
	REQUIRE(market.FindInstrument("dgb").GetHigh() == 408);
	REQUIRE(market.FindInstrument("dgc").GetHigh() == 78);
	REQUIRE(market.FindInstrument("dgd").GetHigh() == 73);
	REQUIRE(market.FindInstrument("dge").GetHigh() == 812);
	REQUIRE(market.FindInstrument("dgf").GetHigh() == 321);
	REQUIRE(market.FindInstrument("dgg").GetHigh() == 355);
	REQUIRE(market.FindInstrument("eaa").GetHigh() == 112);
	REQUIRE(market.FindInstrument("eab").GetHigh() == 156);
	REQUIRE(market.FindInstrument("eac").GetHigh() == 276);
	REQUIRE(market.FindInstrument("ead").GetHigh() == 1155);
	REQUIRE(market.FindInstrument("eae").GetHigh() == 342);
	REQUIRE(market.FindInstrument("eaf").GetHigh() == 122);
	REQUIRE(market.FindInstrument("eag").GetHigh() == 23);
	REQUIRE(market.FindInstrument("eba").GetHigh() == 44);
	REQUIRE(market.FindInstrument("ebb").GetHigh() == 690);
	REQUIRE(market.FindInstrument("ebc").GetHigh() == 396);
	REQUIRE(market.FindInstrument("ebd").GetHigh() == 252);
	REQUIRE(market.FindInstrument("ebe").GetHigh() == 172);
	REQUIRE(market.FindInstrument("ebf").GetHigh() == 243);
	REQUIRE(market.FindInstrument("ebg").GetHigh() == 308);
	REQUIRE(market.FindInstrument("eca").GetHigh() == 256);
	REQUIRE(market.FindInstrument("ecb").GetHigh() == 167);
	REQUIRE(market.FindInstrument("ecc").GetHigh() == 299);
	REQUIRE(market.FindInstrument("ecd").GetHigh() == 65);
	REQUIRE(market.FindInstrument("ece").GetHigh() == 100);
	REQUIRE(market.FindInstrument("ecf").GetHigh() == 136);
	REQUIRE(market.FindInstrument("ecg").GetHigh() == 258);
	REQUIRE(market.FindInstrument("eda").GetHigh() == 159);
	REQUIRE(market.FindInstrument("edb").GetHigh() == 202);
	REQUIRE(market.FindInstrument("edc").GetHigh() == 8);
	REQUIRE(market.FindInstrument("edd").GetHigh() == 237);
	REQUIRE(market.FindInstrument("ede").GetHigh() == 134);
	REQUIRE(market.FindInstrument("edf").GetHigh() == 483);
	REQUIRE(market.FindInstrument("edg").GetHigh() == 217);
	REQUIRE(market.FindInstrument("eea").GetHigh() == 270);
	REQUIRE(market.FindInstrument("eeb").GetHigh() == 96);
	REQUIRE(market.FindInstrument("eec").GetHigh() == 33);
	REQUIRE(market.FindInstrument("eed").GetHigh() == 452);
	REQUIRE(market.FindInstrument("eee").GetHigh() == 463);
	REQUIRE(market.FindInstrument("eef").GetHigh() == 105);
	REQUIRE(market.FindInstrument("eeg").GetHigh() == 153);
	REQUIRE(market.FindInstrument("efa").GetHigh() == 478);
	REQUIRE(market.FindInstrument("efb").GetHigh() == 792);
	REQUIRE(market.FindInstrument("efc").GetHigh() == 102);
	REQUIRE(market.FindInstrument("efd").GetHigh() == 175);
	REQUIRE(market.FindInstrument("efe").GetHigh() == 296);
	REQUIRE(market.FindInstrument("eff").GetHigh() == 16);
	REQUIRE(market.FindInstrument("efg").GetHigh() == 13);
	REQUIRE(market.FindInstrument("ega").GetHigh() == 269);
	REQUIRE(market.FindInstrument("egb").GetHigh() == 110);
	REQUIRE(market.FindInstrument("egc").GetHigh() == 41);
	REQUIRE(market.FindInstrument("egd").GetHigh() == 35);
	REQUIRE(market.FindInstrument("ege").GetHigh() == 627);
	REQUIRE(market.FindInstrument("egf").GetHigh() == 421);
	REQUIRE(market.FindInstrument("egg").GetHigh() == 540);
	REQUIRE(market.FindInstrument("faa").GetHigh() == 389);
	REQUIRE(market.FindInstrument("fab").GetHigh() == 179);
	REQUIRE(market.FindInstrument("fac").GetHigh() == 158);
	REQUIRE(market.FindInstrument("fad").GetHigh() == 34);
	REQUIRE(market.FindInstrument("fae").GetHigh() == 84);
	REQUIRE(market.FindInstrument("faf").GetHigh() == 253);
	REQUIRE(market.FindInstrument("fag").GetHigh() == 296);
	REQUIRE(market.FindInstrument("fba").GetHigh() == 216);
	REQUIRE(market.FindInstrument("fbb").GetHigh() == 57);
	REQUIRE(market.FindInstrument("fbc").GetHigh() == 334);
	REQUIRE(market.FindInstrument("fbd").GetHigh() == 18);
	REQUIRE(market.FindInstrument("fbe").GetHigh() == 181);
	REQUIRE(market.FindInstrument("fbf").GetHigh() == 34);
	REQUIRE(market.FindInstrument("fbg").GetHigh() == 314);
	REQUIRE(market.FindInstrument("fca").GetHigh() == 253);
	REQUIRE(market.FindInstrument("fcb").GetHigh() == 174);
	REQUIRE(market.FindInstrument("fcc").GetHigh() == 23);
	REQUIRE(market.FindInstrument("fcd").GetHigh() == 38);
	REQUIRE(market.FindInstrument("fce").GetHigh() == 336);
	REQUIRE(market.FindInstrument("fcf").GetHigh() == 68);
	REQUIRE(market.FindInstrument("fcg").GetHigh() == 254);
	REQUIRE(market.FindInstrument("fda").GetHigh() == 326);
	REQUIRE(market.FindInstrument("fdb").GetHigh() == 355);
	REQUIRE(market.FindInstrument("fdc").GetHigh() == 120);
	REQUIRE(market.FindInstrument("fdd").GetHigh() == 187);
	REQUIRE(market.FindInstrument("fde").GetHigh() == 280);
	REQUIRE(market.FindInstrument("fdf").GetHigh() == 356);
	REQUIRE(market.FindInstrument("fdg").GetHigh() == 254);
	REQUIRE(market.FindInstrument("fea").GetHigh() == 3163);
	REQUIRE(market.FindInstrument("feb").GetHigh() == 215);
	REQUIRE(market.FindInstrument("fec").GetHigh() == 332);
	REQUIRE(market.FindInstrument("fed").GetHigh() == 125);
	REQUIRE(market.FindInstrument("fee").GetHigh() == 10);
	REQUIRE(market.FindInstrument("fef").GetHigh() == 50);
	REQUIRE(market.FindInstrument("feg").GetHigh() == 646);
	REQUIRE(market.FindInstrument("ffa").GetHigh() == 74);
	REQUIRE(market.FindInstrument("ffb").GetHigh() == 9);
	REQUIRE(market.FindInstrument("ffc").GetHigh() == 226);
	REQUIRE(market.FindInstrument("ffd").GetHigh() == 176);
	REQUIRE(market.FindInstrument("ffe").GetHigh() == 81);
	REQUIRE(market.FindInstrument("fff").GetHigh() == 103);
	REQUIRE(market.FindInstrument("ffg").GetHigh() == 231);
	REQUIRE(market.FindInstrument("fga").GetHigh() == 157);
	REQUIRE(market.FindInstrument("fgb").GetHigh() == 422);
	REQUIRE(market.FindInstrument("fgc").GetHigh() == 218);
	REQUIRE(market.FindInstrument("fgd").GetHigh() == 366);
	REQUIRE(market.FindInstrument("fge").GetHigh() == 148);
	REQUIRE(market.FindInstrument("fgf").GetHigh() == 104);
	REQUIRE(market.FindInstrument("fgg").GetHigh() == 227);
	REQUIRE(market.FindInstrument("gaa").GetHigh() == 721);
	REQUIRE(market.FindInstrument("gab").GetHigh() == 210);
	REQUIRE(market.FindInstrument("gac").GetHigh() == 484);
	REQUIRE(market.FindInstrument("gad").GetHigh() == 473);
	REQUIRE(market.FindInstrument("gae").GetHigh() == 248);
	REQUIRE(market.FindInstrument("gaf").GetHigh() == 183);
	REQUIRE(market.FindInstrument("gag").GetHigh() == 285);
	REQUIRE(market.FindInstrument("gba").GetHigh() == 350);
	REQUIRE(market.FindInstrument("gbb").GetHigh() == 92);
	REQUIRE(market.FindInstrument("gbc").GetHigh() == 413);
	REQUIRE(market.FindInstrument("gbd").GetHigh() == 365);
	REQUIRE(market.FindInstrument("gbe").GetHigh() == 135);
	REQUIRE(market.FindInstrument("gbf").GetHigh() == 7);
	REQUIRE(market.FindInstrument("gbg").GetHigh() == 442);
	REQUIRE(market.FindInstrument("gca").GetHigh() == 295);
	REQUIRE(market.FindInstrument("gcb").GetHigh() == 57);
	REQUIRE(market.FindInstrument("gcc").GetHigh() == 93);
	REQUIRE(market.FindInstrument("gcd").GetHigh() == 281);
	REQUIRE(market.FindInstrument("gce").GetHigh() == 225);
	REQUIRE(market.FindInstrument("gcf").GetHigh() == 360);
	REQUIRE(market.FindInstrument("gcg").GetHigh() == 81);
	REQUIRE(market.FindInstrument("gda").GetHigh() == 122);
	REQUIRE(market.FindInstrument("gdb").GetHigh() == 212);
	REQUIRE(market.FindInstrument("gdc").GetHigh() == 221);
	REQUIRE(market.FindInstrument("gdd").GetHigh() == 192);
	REQUIRE(market.FindInstrument("gde").GetHigh() == 38);
	REQUIRE(market.FindInstrument("gdf").GetHigh() == 263);
	REQUIRE(market.FindInstrument("gdg").GetHigh() == 359);
	REQUIRE(market.FindInstrument("gea").GetHigh() == 214);
	REQUIRE(market.FindInstrument("geb").GetHigh() == 260);
	REQUIRE(market.FindInstrument("gec").GetHigh() == 120);
	REQUIRE(market.FindInstrument("ged").GetHigh() == 35);
	REQUIRE(market.FindInstrument("gee").GetHigh() == 377);
	REQUIRE(market.FindInstrument("gef").GetHigh() == 156);
	REQUIRE(market.FindInstrument("geg").GetHigh() == 9);
	REQUIRE(market.FindInstrument("gfa").GetHigh() == 87);
	REQUIRE(market.FindInstrument("gfb").GetHigh() == 653);
	REQUIRE(market.FindInstrument("gfc").GetHigh() == 195);
	REQUIRE(market.FindInstrument("gfd").GetHigh() == 645);
	REQUIRE(market.FindInstrument("gfe").GetHigh() == 500);
	REQUIRE(market.FindInstrument("gff").GetHigh() == 273);
	REQUIRE(market.FindInstrument("gfg").GetHigh() == 18);
	REQUIRE(market.FindInstrument("gga").GetHigh() == 28);
	REQUIRE(market.FindInstrument("ggb").GetHigh() == 216);
	REQUIRE(market.FindInstrument("ggc").GetHigh() == 118);
	REQUIRE(market.FindInstrument("ggd").GetHigh() == 132);
	REQUIRE(market.FindInstrument("gge").GetHigh() == 34);
	REQUIRE(market.FindInstrument("ggf").GetHigh() == 198);
	REQUIRE(market.FindInstrument("ggg").GetHigh() == 694);
}
