#include <fstream>
#include <iostream>

#include "../CSVParser.h"
#include "../Market.h"
#include <catch2/catch.hpp>

TEST_CASE("Test parsing of input file", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto          parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.MessageCount() == 20391);
   auto symbols = market.GetSymbols();
   REQUIRE(symbols.size() == 343);
   size_t index = 0;

   REQUIRE("aaa" == symbols[index++]);
   REQUIRE("aab" == symbols[index++]);
   REQUIRE("aac" == symbols[index++]);
   REQUIRE("aad" == symbols[index++]);
   REQUIRE("aae" == symbols[index++]);
   REQUIRE("aaf" == symbols[index++]);
   REQUIRE("aag" == symbols[index++]);
   REQUIRE("aba" == symbols[index++]);
   REQUIRE("abb" == symbols[index++]);
   REQUIRE("abc" == symbols[index++]);
   REQUIRE("abd" == symbols[index++]);
   REQUIRE("abe" == symbols[index++]);
   REQUIRE("abf" == symbols[index++]);
   REQUIRE("abg" == symbols[index++]);
   REQUIRE("aca" == symbols[index++]);
   REQUIRE("acb" == symbols[index++]);
   REQUIRE("acc" == symbols[index++]);
   REQUIRE("acd" == symbols[index++]);
   REQUIRE("ace" == symbols[index++]);
   REQUIRE("acf" == symbols[index++]);
   REQUIRE("acg" == symbols[index++]);
   REQUIRE("ada" == symbols[index++]);
   REQUIRE("adb" == symbols[index++]);
   REQUIRE("adc" == symbols[index++]);
   REQUIRE("add" == symbols[index++]);
   REQUIRE("ade" == symbols[index++]);
   REQUIRE("adf" == symbols[index++]);
   REQUIRE("adg" == symbols[index++]);
   REQUIRE("aea" == symbols[index++]);
   REQUIRE("aeb" == symbols[index++]);
   REQUIRE("aec" == symbols[index++]);
   REQUIRE("aed" == symbols[index++]);
   REQUIRE("aee" == symbols[index++]);
   REQUIRE("aef" == symbols[index++]);
   REQUIRE("aeg" == symbols[index++]);
   REQUIRE("afa" == symbols[index++]);
   REQUIRE("afb" == symbols[index++]);
   REQUIRE("afc" == symbols[index++]);
   REQUIRE("afd" == symbols[index++]);
   REQUIRE("afe" == symbols[index++]);
   REQUIRE("aff" == symbols[index++]);
   REQUIRE("afg" == symbols[index++]);
   REQUIRE("aga" == symbols[index++]);
   REQUIRE("agb" == symbols[index++]);
   REQUIRE("agc" == symbols[index++]);
   REQUIRE("agd" == symbols[index++]);
   REQUIRE("age" == symbols[index++]);
   REQUIRE("agf" == symbols[index++]);
   REQUIRE("agg" == symbols[index++]);
   REQUIRE("baa" == symbols[index++]);
   REQUIRE("bab" == symbols[index++]);
   REQUIRE("bac" == symbols[index++]);
   REQUIRE("bad" == symbols[index++]);
   REQUIRE("bae" == symbols[index++]);
   REQUIRE("baf" == symbols[index++]);
   REQUIRE("bag" == symbols[index++]);
   REQUIRE("bba" == symbols[index++]);
   REQUIRE("bbb" == symbols[index++]);
   REQUIRE("bbc" == symbols[index++]);
   REQUIRE("bbd" == symbols[index++]);
   REQUIRE("bbe" == symbols[index++]);
   REQUIRE("bbf" == symbols[index++]);
   REQUIRE("bbg" == symbols[index++]);
   REQUIRE("bca" == symbols[index++]);
   REQUIRE("bcb" == symbols[index++]);
   REQUIRE("bcc" == symbols[index++]);
   REQUIRE("bcd" == symbols[index++]);
   REQUIRE("bce" == symbols[index++]);
   REQUIRE("bcf" == symbols[index++]);
   REQUIRE("bcg" == symbols[index++]);
   REQUIRE("bda" == symbols[index++]);
   REQUIRE("bdb" == symbols[index++]);
   REQUIRE("bdc" == symbols[index++]);
   REQUIRE("bdd" == symbols[index++]);
   REQUIRE("bde" == symbols[index++]);
   REQUIRE("bdf" == symbols[index++]);
   REQUIRE("bdg" == symbols[index++]);
   REQUIRE("bea" == symbols[index++]);
   REQUIRE("beb" == symbols[index++]);
   REQUIRE("bec" == symbols[index++]);
   REQUIRE("bed" == symbols[index++]);
   REQUIRE("bee" == symbols[index++]);
   REQUIRE("bef" == symbols[index++]);
   REQUIRE("beg" == symbols[index++]);
   REQUIRE("bfa" == symbols[index++]);
   REQUIRE("bfb" == symbols[index++]);
   REQUIRE("bfc" == symbols[index++]);
   REQUIRE("bfd" == symbols[index++]);
   REQUIRE("bfe" == symbols[index++]);
   REQUIRE("bff" == symbols[index++]);
   REQUIRE("bfg" == symbols[index++]);
   REQUIRE("bga" == symbols[index++]);
   REQUIRE("bgb" == symbols[index++]);
   REQUIRE("bgc" == symbols[index++]);
   REQUIRE("bgd" == symbols[index++]);
   REQUIRE("bge" == symbols[index++]);
   REQUIRE("bgf" == symbols[index++]);
   REQUIRE("bgg" == symbols[index++]);
   REQUIRE("caa" == symbols[index++]);
   REQUIRE("cab" == symbols[index++]);
   REQUIRE("cac" == symbols[index++]);
   REQUIRE("cad" == symbols[index++]);
   REQUIRE("cae" == symbols[index++]);
   REQUIRE("caf" == symbols[index++]);
   REQUIRE("cag" == symbols[index++]);
   REQUIRE("cba" == symbols[index++]);
   REQUIRE("cbb" == symbols[index++]);
   REQUIRE("cbc" == symbols[index++]);
   REQUIRE("cbd" == symbols[index++]);
   REQUIRE("cbe" == symbols[index++]);
   REQUIRE("cbf" == symbols[index++]);
   REQUIRE("cbg" == symbols[index++]);
   REQUIRE("cca" == symbols[index++]);
   REQUIRE("ccb" == symbols[index++]);
   REQUIRE("ccc" == symbols[index++]);
   REQUIRE("ccd" == symbols[index++]);
   REQUIRE("cce" == symbols[index++]);
   REQUIRE("ccf" == symbols[index++]);
   REQUIRE("ccg" == symbols[index++]);
   REQUIRE("cda" == symbols[index++]);
   REQUIRE("cdb" == symbols[index++]);
   REQUIRE("cdc" == symbols[index++]);
   REQUIRE("cdd" == symbols[index++]);
   REQUIRE("cde" == symbols[index++]);
   REQUIRE("cdf" == symbols[index++]);
   REQUIRE("cdg" == symbols[index++]);
   REQUIRE("cea" == symbols[index++]);
   REQUIRE("ceb" == symbols[index++]);
   REQUIRE("cec" == symbols[index++]);
   REQUIRE("ced" == symbols[index++]);
   REQUIRE("cee" == symbols[index++]);
   REQUIRE("cef" == symbols[index++]);
   REQUIRE("ceg" == symbols[index++]);
   REQUIRE("cfa" == symbols[index++]);
   REQUIRE("cfb" == symbols[index++]);
   REQUIRE("cfc" == symbols[index++]);
   REQUIRE("cfd" == symbols[index++]);
   REQUIRE("cfe" == symbols[index++]);
   REQUIRE("cff" == symbols[index++]);
   REQUIRE("cfg" == symbols[index++]);
   REQUIRE("cga" == symbols[index++]);
   REQUIRE("cgb" == symbols[index++]);
   REQUIRE("cgc" == symbols[index++]);
   REQUIRE("cgd" == symbols[index++]);
   REQUIRE("cge" == symbols[index++]);
   REQUIRE("cgf" == symbols[index++]);
   REQUIRE("cgg" == symbols[index++]);
   REQUIRE("daa" == symbols[index++]);
   REQUIRE("dab" == symbols[index++]);
   REQUIRE("dac" == symbols[index++]);
   REQUIRE("dad" == symbols[index++]);
   REQUIRE("dae" == symbols[index++]);
   REQUIRE("daf" == symbols[index++]);
   REQUIRE("dag" == symbols[index++]);
   REQUIRE("dba" == symbols[index++]);
   REQUIRE("dbb" == symbols[index++]);
   REQUIRE("dbc" == symbols[index++]);
   REQUIRE("dbd" == symbols[index++]);
   REQUIRE("dbe" == symbols[index++]);
   REQUIRE("dbf" == symbols[index++]);
   REQUIRE("dbg" == symbols[index++]);
   REQUIRE("dca" == symbols[index++]);
   REQUIRE("dcb" == symbols[index++]);
   REQUIRE("dcc" == symbols[index++]);
   REQUIRE("dcd" == symbols[index++]);
   REQUIRE("dce" == symbols[index++]);
   REQUIRE("dcf" == symbols[index++]);
   REQUIRE("dcg" == symbols[index++]);
   REQUIRE("dda" == symbols[index++]);
   REQUIRE("ddb" == symbols[index++]);
   REQUIRE("ddc" == symbols[index++]);
   REQUIRE("ddd" == symbols[index++]);
   REQUIRE("dde" == symbols[index++]);
   REQUIRE("ddf" == symbols[index++]);
   REQUIRE("ddg" == symbols[index++]);
   REQUIRE("dea" == symbols[index++]);
   REQUIRE("deb" == symbols[index++]);
   REQUIRE("dec" == symbols[index++]);
   REQUIRE("ded" == symbols[index++]);
   REQUIRE("dee" == symbols[index++]);
   REQUIRE("def" == symbols[index++]);
   REQUIRE("deg" == symbols[index++]);
   REQUIRE("dfa" == symbols[index++]);
   REQUIRE("dfb" == symbols[index++]);
   REQUIRE("dfc" == symbols[index++]);
   REQUIRE("dfd" == symbols[index++]);
   REQUIRE("dfe" == symbols[index++]);
   REQUIRE("dff" == symbols[index++]);
   REQUIRE("dfg" == symbols[index++]);
   REQUIRE("dga" == symbols[index++]);
   REQUIRE("dgb" == symbols[index++]);
   REQUIRE("dgc" == symbols[index++]);
   REQUIRE("dgd" == symbols[index++]);
   REQUIRE("dge" == symbols[index++]);
   REQUIRE("dgf" == symbols[index++]);
   REQUIRE("dgg" == symbols[index++]);
   REQUIRE("eaa" == symbols[index++]);
   REQUIRE("eab" == symbols[index++]);
   REQUIRE("eac" == symbols[index++]);
   REQUIRE("ead" == symbols[index++]);
   REQUIRE("eae" == symbols[index++]);
   REQUIRE("eaf" == symbols[index++]);
   REQUIRE("eag" == symbols[index++]);
   REQUIRE("eba" == symbols[index++]);
   REQUIRE("ebb" == symbols[index++]);
   REQUIRE("ebc" == symbols[index++]);
   REQUIRE("ebd" == symbols[index++]);
   REQUIRE("ebe" == symbols[index++]);
   REQUIRE("ebf" == symbols[index++]);
   REQUIRE("ebg" == symbols[index++]);
   REQUIRE("eca" == symbols[index++]);
   REQUIRE("ecb" == symbols[index++]);
   REQUIRE("ecc" == symbols[index++]);
   REQUIRE("ecd" == symbols[index++]);
   REQUIRE("ece" == symbols[index++]);
   REQUIRE("ecf" == symbols[index++]);
   REQUIRE("ecg" == symbols[index++]);
   REQUIRE("eda" == symbols[index++]);
   REQUIRE("edb" == symbols[index++]);
   REQUIRE("edc" == symbols[index++]);
   REQUIRE("edd" == symbols[index++]);
   REQUIRE("ede" == symbols[index++]);
   REQUIRE("edf" == symbols[index++]);
   REQUIRE("edg" == symbols[index++]);
   REQUIRE("eea" == symbols[index++]);
   REQUIRE("eeb" == symbols[index++]);
   REQUIRE("eec" == symbols[index++]);
   REQUIRE("eed" == symbols[index++]);
   REQUIRE("eee" == symbols[index++]);
   REQUIRE("eef" == symbols[index++]);
   REQUIRE("eeg" == symbols[index++]);
   REQUIRE("efa" == symbols[index++]);
   REQUIRE("efb" == symbols[index++]);
   REQUIRE("efc" == symbols[index++]);
   REQUIRE("efd" == symbols[index++]);
   REQUIRE("efe" == symbols[index++]);
   REQUIRE("eff" == symbols[index++]);
   REQUIRE("efg" == symbols[index++]);
   REQUIRE("ega" == symbols[index++]);
   REQUIRE("egb" == symbols[index++]);
   REQUIRE("egc" == symbols[index++]);
   REQUIRE("egd" == symbols[index++]);
   REQUIRE("ege" == symbols[index++]);
   REQUIRE("egf" == symbols[index++]);
   REQUIRE("egg" == symbols[index++]);
   REQUIRE("faa" == symbols[index++]);
   REQUIRE("fab" == symbols[index++]);
   REQUIRE("fac" == symbols[index++]);
   REQUIRE("fad" == symbols[index++]);
   REQUIRE("fae" == symbols[index++]);
   REQUIRE("faf" == symbols[index++]);
   REQUIRE("fag" == symbols[index++]);
   REQUIRE("fba" == symbols[index++]);
   REQUIRE("fbb" == symbols[index++]);
   REQUIRE("fbc" == symbols[index++]);
   REQUIRE("fbd" == symbols[index++]);
   REQUIRE("fbe" == symbols[index++]);
   REQUIRE("fbf" == symbols[index++]);
   REQUIRE("fbg" == symbols[index++]);
   REQUIRE("fca" == symbols[index++]);
   REQUIRE("fcb" == symbols[index++]);
   REQUIRE("fcc" == symbols[index++]);
   REQUIRE("fcd" == symbols[index++]);
   REQUIRE("fce" == symbols[index++]);
   REQUIRE("fcf" == symbols[index++]);
   REQUIRE("fcg" == symbols[index++]);
   REQUIRE("fda" == symbols[index++]);
   REQUIRE("fdb" == symbols[index++]);
   REQUIRE("fdc" == symbols[index++]);
   REQUIRE("fdd" == symbols[index++]);
   REQUIRE("fde" == symbols[index++]);
   REQUIRE("fdf" == symbols[index++]);
   REQUIRE("fdg" == symbols[index++]);
   REQUIRE("fea" == symbols[index++]);
   REQUIRE("feb" == symbols[index++]);
   REQUIRE("fec" == symbols[index++]);
   REQUIRE("fed" == symbols[index++]);
   REQUIRE("fee" == symbols[index++]);
   REQUIRE("fef" == symbols[index++]);
   REQUIRE("feg" == symbols[index++]);
   REQUIRE("ffa" == symbols[index++]);
   REQUIRE("ffb" == symbols[index++]);
   REQUIRE("ffc" == symbols[index++]);
   REQUIRE("ffd" == symbols[index++]);
   REQUIRE("ffe" == symbols[index++]);
   REQUIRE("fff" == symbols[index++]);
   REQUIRE("ffg" == symbols[index++]);
   REQUIRE("fga" == symbols[index++]);
   REQUIRE("fgb" == symbols[index++]);
   REQUIRE("fgc" == symbols[index++]);
   REQUIRE("fgd" == symbols[index++]);
   REQUIRE("fge" == symbols[index++]);
   REQUIRE("fgf" == symbols[index++]);
   REQUIRE("fgg" == symbols[index++]);
   REQUIRE("gaa" == symbols[index++]);
   REQUIRE("gab" == symbols[index++]);
   REQUIRE("gac" == symbols[index++]);
   REQUIRE("gad" == symbols[index++]);
   REQUIRE("gae" == symbols[index++]);
   REQUIRE("gaf" == symbols[index++]);
   REQUIRE("gag" == symbols[index++]);
   REQUIRE("gba" == symbols[index++]);
   REQUIRE("gbb" == symbols[index++]);
   REQUIRE("gbc" == symbols[index++]);
   REQUIRE("gbd" == symbols[index++]);
   REQUIRE("gbe" == symbols[index++]);
   REQUIRE("gbf" == symbols[index++]);
   REQUIRE("gbg" == symbols[index++]);
   REQUIRE("gca" == symbols[index++]);
   REQUIRE("gcb" == symbols[index++]);
   REQUIRE("gcc" == symbols[index++]);
   REQUIRE("gcd" == symbols[index++]);
   REQUIRE("gce" == symbols[index++]);
   REQUIRE("gcf" == symbols[index++]);
   REQUIRE("gcg" == symbols[index++]);
   REQUIRE("gda" == symbols[index++]);
   REQUIRE("gdb" == symbols[index++]);
   REQUIRE("gdc" == symbols[index++]);
   REQUIRE("gdd" == symbols[index++]);
   REQUIRE("gde" == symbols[index++]);
   REQUIRE("gdf" == symbols[index++]);
   REQUIRE("gdg" == symbols[index++]);
   REQUIRE("gea" == symbols[index++]);
   REQUIRE("geb" == symbols[index++]);
   REQUIRE("gec" == symbols[index++]);
   REQUIRE("ged" == symbols[index++]);
   REQUIRE("gee" == symbols[index++]);
   REQUIRE("gef" == symbols[index++]);
   REQUIRE("geg" == symbols[index++]);
   REQUIRE("gfa" == symbols[index++]);
   REQUIRE("gfb" == symbols[index++]);
   REQUIRE("gfc" == symbols[index++]);
   REQUIRE("gfd" == symbols[index++]);
   REQUIRE("gfe" == symbols[index++]);
   REQUIRE("gff" == symbols[index++]);
   REQUIRE("gfg" == symbols[index++]);
   REQUIRE("gga" == symbols[index++]);
   REQUIRE("ggb" == symbols[index++]);
   REQUIRE("ggc" == symbols[index++]);
   REQUIRE("ggd" == symbols[index++]);
   REQUIRE("gge" == symbols[index++]);
   REQUIRE("ggf" == symbols[index++]);
   REQUIRE("ggg" == symbols[index++]);
}

TEST_CASE("Test total volume for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto          parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.FindInstrument("aaa").GetTotalVolume() == 8783);
   REQUIRE(market.FindInstrument("aab").GetTotalVolume() == 10570);
   REQUIRE(market.FindInstrument("aac").GetTotalVolume() == 9620);
   REQUIRE(market.FindInstrument("aad").GetTotalVolume() == 9035);
   REQUIRE(market.FindInstrument("aae").GetTotalVolume() == 8438);
   REQUIRE(market.FindInstrument("aaf").GetTotalVolume() == 7271);
   REQUIRE(market.FindInstrument("aag").GetTotalVolume() == 9451);
   REQUIRE(market.FindInstrument("aba").GetTotalVolume() == 9670);
   REQUIRE(market.FindInstrument("abb").GetTotalVolume() == 8963);
   REQUIRE(market.FindInstrument("abc").GetTotalVolume() == 6553);
   REQUIRE(market.FindInstrument("abd").GetTotalVolume() == 8078);
   REQUIRE(market.FindInstrument("abe").GetTotalVolume() == 9540);
   REQUIRE(market.FindInstrument("abf").GetTotalVolume() == 7570);
   REQUIRE(market.FindInstrument("abg").GetTotalVolume() == 8885);
   REQUIRE(market.FindInstrument("aca").GetTotalVolume() == 9557);
   REQUIRE(market.FindInstrument("acb").GetTotalVolume() == 9264);
   REQUIRE(market.FindInstrument("acc").GetTotalVolume() == 7929);
   REQUIRE(market.FindInstrument("acd").GetTotalVolume() == 8656);
   REQUIRE(market.FindInstrument("ace").GetTotalVolume() == 9661);
   REQUIRE(market.FindInstrument("acf").GetTotalVolume() == 7682);
   REQUIRE(market.FindInstrument("acg").GetTotalVolume() == 9589);
   REQUIRE(market.FindInstrument("ada").GetTotalVolume() == 7554);
   REQUIRE(market.FindInstrument("adb").GetTotalVolume() == 7157);
   REQUIRE(market.FindInstrument("adc").GetTotalVolume() == 10216);
   REQUIRE(market.FindInstrument("add").GetTotalVolume() == 10022);
   REQUIRE(market.FindInstrument("ade").GetTotalVolume() == 7605);
   REQUIRE(market.FindInstrument("adf").GetTotalVolume() == 10119);
   REQUIRE(market.FindInstrument("adg").GetTotalVolume() == 8862);
   REQUIRE(market.FindInstrument("aea").GetTotalVolume() == 9233);
   REQUIRE(market.FindInstrument("aeb").GetTotalVolume() == 8963);
   REQUIRE(market.FindInstrument("aec").GetTotalVolume() == 9840);
   REQUIRE(market.FindInstrument("aed").GetTotalVolume() == 8480);
   REQUIRE(market.FindInstrument("aee").GetTotalVolume() == 7669);
   REQUIRE(market.FindInstrument("aef").GetTotalVolume() == 8054);
   REQUIRE(market.FindInstrument("aeg").GetTotalVolume() == 8055);
   REQUIRE(market.FindInstrument("afa").GetTotalVolume() == 9507);
   REQUIRE(market.FindInstrument("afb").GetTotalVolume() == 9742);
   REQUIRE(market.FindInstrument("afc").GetTotalVolume() == 9008);
   REQUIRE(market.FindInstrument("afd").GetTotalVolume() == 10252);
   REQUIRE(market.FindInstrument("afe").GetTotalVolume() == 6842);
   REQUIRE(market.FindInstrument("aff").GetTotalVolume() == 9354);
   REQUIRE(market.FindInstrument("afg").GetTotalVolume() == 9903);
   REQUIRE(market.FindInstrument("aga").GetTotalVolume() == 8616);
   REQUIRE(market.FindInstrument("agb").GetTotalVolume() == 8734);
   REQUIRE(market.FindInstrument("agc").GetTotalVolume() == 9467);
   REQUIRE(market.FindInstrument("agd").GetTotalVolume() == 9465);
   REQUIRE(market.FindInstrument("age").GetTotalVolume() == 9225);
   REQUIRE(market.FindInstrument("agf").GetTotalVolume() == 9450);
   REQUIRE(market.FindInstrument("agg").GetTotalVolume() == 8226);
   REQUIRE(market.FindInstrument("baa").GetTotalVolume() == 8095);
   REQUIRE(market.FindInstrument("bab").GetTotalVolume() == 7232);
   REQUIRE(market.FindInstrument("bac").GetTotalVolume() == 8831);
   REQUIRE(market.FindInstrument("bad").GetTotalVolume() == 9810);
   REQUIRE(market.FindInstrument("bae").GetTotalVolume() == 7754);
   REQUIRE(market.FindInstrument("baf").GetTotalVolume() == 8199);
   REQUIRE(market.FindInstrument("bag").GetTotalVolume() == 7611);
   REQUIRE(market.FindInstrument("bba").GetTotalVolume() == 9915);
   REQUIRE(market.FindInstrument("bbb").GetTotalVolume() == 8094);
   REQUIRE(market.FindInstrument("bbc").GetTotalVolume() == 9290);
   REQUIRE(market.FindInstrument("bbd").GetTotalVolume() == 9708);
   REQUIRE(market.FindInstrument("bbe").GetTotalVolume() == 8278);
   REQUIRE(market.FindInstrument("bbf").GetTotalVolume() == 8746);
   REQUIRE(market.FindInstrument("bbg").GetTotalVolume() == 9131);
   REQUIRE(market.FindInstrument("bca").GetTotalVolume() == 9921);
   REQUIRE(market.FindInstrument("bcb").GetTotalVolume() == 10244);
   REQUIRE(market.FindInstrument("bcc").GetTotalVolume() == 9796);
   REQUIRE(market.FindInstrument("bcd").GetTotalVolume() == 9733);
   REQUIRE(market.FindInstrument("bce").GetTotalVolume() == 10165);
   REQUIRE(market.FindInstrument("bcf").GetTotalVolume() == 9749);
   REQUIRE(market.FindInstrument("bcg").GetTotalVolume() == 10035);
   REQUIRE(market.FindInstrument("bda").GetTotalVolume() == 8344);
   REQUIRE(market.FindInstrument("bdb").GetTotalVolume() == 7873);
   REQUIRE(market.FindInstrument("bdc").GetTotalVolume() == 10006);
   REQUIRE(market.FindInstrument("bdd").GetTotalVolume() == 8054);
   REQUIRE(market.FindInstrument("bde").GetTotalVolume() == 9149);
   REQUIRE(market.FindInstrument("bdf").GetTotalVolume() == 8039);
   REQUIRE(market.FindInstrument("bdg").GetTotalVolume() == 9379);
   REQUIRE(market.FindInstrument("bea").GetTotalVolume() == 9561);
   REQUIRE(market.FindInstrument("beb").GetTotalVolume() == 9599);
   REQUIRE(market.FindInstrument("bec").GetTotalVolume() == 9468);
   REQUIRE(market.FindInstrument("bed").GetTotalVolume() == 9586);
   REQUIRE(market.FindInstrument("bee").GetTotalVolume() == 7973);
   REQUIRE(market.FindInstrument("bef").GetTotalVolume() == 8362);
   REQUIRE(market.FindInstrument("beg").GetTotalVolume() == 10223);
   REQUIRE(market.FindInstrument("bfa").GetTotalVolume() == 9372);
   REQUIRE(market.FindInstrument("bfb").GetTotalVolume() == 7930);
   REQUIRE(market.FindInstrument("bfc").GetTotalVolume() == 9101);
   REQUIRE(market.FindInstrument("bfd").GetTotalVolume() == 9485);
   REQUIRE(market.FindInstrument("bfe").GetTotalVolume() == 9704);
   REQUIRE(market.FindInstrument("bff").GetTotalVolume() == 7766);
   REQUIRE(market.FindInstrument("bfg").GetTotalVolume() == 9547);
   REQUIRE(market.FindInstrument("bga").GetTotalVolume() == 8828);
   REQUIRE(market.FindInstrument("bgb").GetTotalVolume() == 8023);
   REQUIRE(market.FindInstrument("bgc").GetTotalVolume() == 9651);
   REQUIRE(market.FindInstrument("bgd").GetTotalVolume() == 9011);
   REQUIRE(market.FindInstrument("bge").GetTotalVolume() == 9534);
   REQUIRE(market.FindInstrument("bgf").GetTotalVolume() == 7803);
   REQUIRE(market.FindInstrument("bgg").GetTotalVolume() == 9895);
   REQUIRE(market.FindInstrument("caa").GetTotalVolume() == 10286);
   REQUIRE(market.FindInstrument("cab").GetTotalVolume() == 8849);
   REQUIRE(market.FindInstrument("cac").GetTotalVolume() == 9323);
   REQUIRE(market.FindInstrument("cad").GetTotalVolume() == 8153);
   REQUIRE(market.FindInstrument("cae").GetTotalVolume() == 8467);
   REQUIRE(market.FindInstrument("caf").GetTotalVolume() == 9022);
   REQUIRE(market.FindInstrument("cag").GetTotalVolume() == 7389);
   REQUIRE(market.FindInstrument("cba").GetTotalVolume() == 8422);
   REQUIRE(market.FindInstrument("cbb").GetTotalVolume() == 8140);
   REQUIRE(market.FindInstrument("cbc").GetTotalVolume() == 9888);
   REQUIRE(market.FindInstrument("cbd").GetTotalVolume() == 9561);
   REQUIRE(market.FindInstrument("cbe").GetTotalVolume() == 9380);
   REQUIRE(market.FindInstrument("cbf").GetTotalVolume() == 8424);
   REQUIRE(market.FindInstrument("cbg").GetTotalVolume() == 9654);
   REQUIRE(market.FindInstrument("cca").GetTotalVolume() == 8415);
   REQUIRE(market.FindInstrument("ccb").GetTotalVolume() == 8298);
   REQUIRE(market.FindInstrument("ccc").GetTotalVolume() == 9077);
   REQUIRE(market.FindInstrument("ccd").GetTotalVolume() == 6853);
   REQUIRE(market.FindInstrument("cce").GetTotalVolume() == 11145);
   REQUIRE(market.FindInstrument("ccf").GetTotalVolume() == 9986);
   REQUIRE(market.FindInstrument("ccg").GetTotalVolume() == 7647);
   REQUIRE(market.FindInstrument("cda").GetTotalVolume() == 8657);
   REQUIRE(market.FindInstrument("cdb").GetTotalVolume() == 9431);
   REQUIRE(market.FindInstrument("cdc").GetTotalVolume() == 9770);
   REQUIRE(market.FindInstrument("cdd").GetTotalVolume() == 8225);
   REQUIRE(market.FindInstrument("cde").GetTotalVolume() == 8196);
   REQUIRE(market.FindInstrument("cdf").GetTotalVolume() == 9639);
   REQUIRE(market.FindInstrument("cdg").GetTotalVolume() == 10219);
   REQUIRE(market.FindInstrument("cea").GetTotalVolume() == 8914);
   REQUIRE(market.FindInstrument("ceb").GetTotalVolume() == 9471);
   REQUIRE(market.FindInstrument("cec").GetTotalVolume() == 9321);
   REQUIRE(market.FindInstrument("ced").GetTotalVolume() == 8209);
   REQUIRE(market.FindInstrument("cee").GetTotalVolume() == 8823);
   REQUIRE(market.FindInstrument("cef").GetTotalVolume() == 7489);
   REQUIRE(market.FindInstrument("ceg").GetTotalVolume() == 9344);
   REQUIRE(market.FindInstrument("cfa").GetTotalVolume() == 9849);
   REQUIRE(market.FindInstrument("cfb").GetTotalVolume() == 10241);
   REQUIRE(market.FindInstrument("cfc").GetTotalVolume() == 8733);
   REQUIRE(market.FindInstrument("cfd").GetTotalVolume() == 8161);
   REQUIRE(market.FindInstrument("cfe").GetTotalVolume() == 8748);
   REQUIRE(market.FindInstrument("cff").GetTotalVolume() == 9555);
   REQUIRE(market.FindInstrument("cfg").GetTotalVolume() == 7740);
   REQUIRE(market.FindInstrument("cga").GetTotalVolume() == 7873);
   REQUIRE(market.FindInstrument("cgb").GetTotalVolume() == 8550);
   REQUIRE(market.FindInstrument("cgc").GetTotalVolume() == 10015);
   REQUIRE(market.FindInstrument("cgd").GetTotalVolume() == 9128);
   REQUIRE(market.FindInstrument("cge").GetTotalVolume() == 9588);
   REQUIRE(market.FindInstrument("cgf").GetTotalVolume() == 9473);
   REQUIRE(market.FindInstrument("cgg").GetTotalVolume() == 8692);
   REQUIRE(market.FindInstrument("daa").GetTotalVolume() == 8767);
   REQUIRE(market.FindInstrument("dab").GetTotalVolume() == 8577);
   REQUIRE(market.FindInstrument("dac").GetTotalVolume() == 8239);
   REQUIRE(market.FindInstrument("dad").GetTotalVolume() == 8165);
   REQUIRE(market.FindInstrument("dae").GetTotalVolume() == 8821);
   REQUIRE(market.FindInstrument("daf").GetTotalVolume() == 9474);
   REQUIRE(market.FindInstrument("dag").GetTotalVolume() == 8435);
   REQUIRE(market.FindInstrument("dba").GetTotalVolume() == 9552);
   REQUIRE(market.FindInstrument("dbb").GetTotalVolume() == 9248);
   REQUIRE(market.FindInstrument("dbc").GetTotalVolume() == 10017);
   REQUIRE(market.FindInstrument("dbd").GetTotalVolume() == 8704);
   REQUIRE(market.FindInstrument("dbe").GetTotalVolume() == 7765);
   REQUIRE(market.FindInstrument("dbf").GetTotalVolume() == 9924);
   REQUIRE(market.FindInstrument("dbg").GetTotalVolume() == 9947);
   REQUIRE(market.FindInstrument("dca").GetTotalVolume() == 7416);
   REQUIRE(market.FindInstrument("dcb").GetTotalVolume() == 8898);
   REQUIRE(market.FindInstrument("dcc").GetTotalVolume() == 8779);
   REQUIRE(market.FindInstrument("dcd").GetTotalVolume() == 9339);
   REQUIRE(market.FindInstrument("dce").GetTotalVolume() == 8920);
   REQUIRE(market.FindInstrument("dcf").GetTotalVolume() == 9618);
   REQUIRE(market.FindInstrument("dcg").GetTotalVolume() == 8805);
   REQUIRE(market.FindInstrument("dda").GetTotalVolume() == 8212);
   REQUIRE(market.FindInstrument("ddb").GetTotalVolume() == 8111);
   REQUIRE(market.FindInstrument("ddc").GetTotalVolume() == 7290);
   REQUIRE(market.FindInstrument("ddd").GetTotalVolume() == 9605);
   REQUIRE(market.FindInstrument("dde").GetTotalVolume() == 9942);
   REQUIRE(market.FindInstrument("ddf").GetTotalVolume() == 9187);
   REQUIRE(market.FindInstrument("ddg").GetTotalVolume() == 9757);
   REQUIRE(market.FindInstrument("dea").GetTotalVolume() == 9543);
   REQUIRE(market.FindInstrument("deb").GetTotalVolume() == 7978);
   REQUIRE(market.FindInstrument("dec").GetTotalVolume() == 9134);
   REQUIRE(market.FindInstrument("ded").GetTotalVolume() == 8208);
   REQUIRE(market.FindInstrument("dee").GetTotalVolume() == 8648);
   REQUIRE(market.FindInstrument("def").GetTotalVolume() == 9723);
   REQUIRE(market.FindInstrument("deg").GetTotalVolume() == 8580);
   REQUIRE(market.FindInstrument("dfa").GetTotalVolume() == 7838);
   REQUIRE(market.FindInstrument("dfb").GetTotalVolume() == 8268);
   REQUIRE(market.FindInstrument("dfc").GetTotalVolume() == 8297);
   REQUIRE(market.FindInstrument("dfd").GetTotalVolume() == 8910);
   REQUIRE(market.FindInstrument("dfe").GetTotalVolume() == 10581);
   REQUIRE(market.FindInstrument("dff").GetTotalVolume() == 9464);
   REQUIRE(market.FindInstrument("dfg").GetTotalVolume() == 8913);
   REQUIRE(market.FindInstrument("dga").GetTotalVolume() == 8470);
   REQUIRE(market.FindInstrument("dgb").GetTotalVolume() == 8254);
   REQUIRE(market.FindInstrument("dgc").GetTotalVolume() == 10537);
   REQUIRE(market.FindInstrument("dgd").GetTotalVolume() == 9697);
   REQUIRE(market.FindInstrument("dge").GetTotalVolume() == 10003);
   REQUIRE(market.FindInstrument("dgf").GetTotalVolume() == 8440);
   REQUIRE(market.FindInstrument("dgg").GetTotalVolume() == 8141);
   REQUIRE(market.FindInstrument("eaa").GetTotalVolume() == 7962);
   REQUIRE(market.FindInstrument("eab").GetTotalVolume() == 8899);
   REQUIRE(market.FindInstrument("eac").GetTotalVolume() == 10432);
   REQUIRE(market.FindInstrument("ead").GetTotalVolume() == 8524);
   REQUIRE(market.FindInstrument("eae").GetTotalVolume() == 8106);
   REQUIRE(market.FindInstrument("eaf").GetTotalVolume() == 8780);
   REQUIRE(market.FindInstrument("eag").GetTotalVolume() == 8946);
   REQUIRE(market.FindInstrument("eba").GetTotalVolume() == 8583);
   REQUIRE(market.FindInstrument("ebb").GetTotalVolume() == 11185);
   REQUIRE(market.FindInstrument("ebc").GetTotalVolume() == 8039);
   REQUIRE(market.FindInstrument("ebd").GetTotalVolume() == 9690);
   REQUIRE(market.FindInstrument("ebe").GetTotalVolume() == 11187);
   REQUIRE(market.FindInstrument("ebf").GetTotalVolume() == 9034);
   REQUIRE(market.FindInstrument("ebg").GetTotalVolume() == 8676);
   REQUIRE(market.FindInstrument("eca").GetTotalVolume() == 9519);
   REQUIRE(market.FindInstrument("ecb").GetTotalVolume() == 8155);
   REQUIRE(market.FindInstrument("ecc").GetTotalVolume() == 7443);
   REQUIRE(market.FindInstrument("ecd").GetTotalVolume() == 9009);
   REQUIRE(market.FindInstrument("ece").GetTotalVolume() == 10282);
   REQUIRE(market.FindInstrument("ecf").GetTotalVolume() == 7982);
   REQUIRE(market.FindInstrument("ecg").GetTotalVolume() == 6890);
   REQUIRE(market.FindInstrument("eda").GetTotalVolume() == 9144);
   REQUIRE(market.FindInstrument("edb").GetTotalVolume() == 8887);
   REQUIRE(market.FindInstrument("edc").GetTotalVolume() == 9811);
   REQUIRE(market.FindInstrument("edd").GetTotalVolume() == 8749);
   REQUIRE(market.FindInstrument("ede").GetTotalVolume() == 7193);
   REQUIRE(market.FindInstrument("edf").GetTotalVolume() == 8176);
   REQUIRE(market.FindInstrument("edg").GetTotalVolume() == 8397);
   REQUIRE(market.FindInstrument("eea").GetTotalVolume() == 9882);
   REQUIRE(market.FindInstrument("eeb").GetTotalVolume() == 9732);
   REQUIRE(market.FindInstrument("eec").GetTotalVolume() == 7746);
   REQUIRE(market.FindInstrument("eed").GetTotalVolume() == 8162);
   REQUIRE(market.FindInstrument("eee").GetTotalVolume() == 8908);
   REQUIRE(market.FindInstrument("eef").GetTotalVolume() == 7902);
   REQUIRE(market.FindInstrument("eeg").GetTotalVolume() == 8243);
   REQUIRE(market.FindInstrument("efa").GetTotalVolume() == 10810);
   REQUIRE(market.FindInstrument("efb").GetTotalVolume() == 7662);
   REQUIRE(market.FindInstrument("efc").GetTotalVolume() == 8862);
   REQUIRE(market.FindInstrument("efd").GetTotalVolume() == 9165);
   REQUIRE(market.FindInstrument("efe").GetTotalVolume() == 8312);
   REQUIRE(market.FindInstrument("eff").GetTotalVolume() == 9659);
   REQUIRE(market.FindInstrument("efg").GetTotalVolume() == 9798);
   REQUIRE(market.FindInstrument("ega").GetTotalVolume() == 9795);
   REQUIRE(market.FindInstrument("egb").GetTotalVolume() == 9517);
   REQUIRE(market.FindInstrument("egc").GetTotalVolume() == 8619);
   REQUIRE(market.FindInstrument("egd").GetTotalVolume() == 8723);
   REQUIRE(market.FindInstrument("ege").GetTotalVolume() == 9524);
   REQUIRE(market.FindInstrument("egf").GetTotalVolume() == 6778);
   REQUIRE(market.FindInstrument("egg").GetTotalVolume() == 7352);
   REQUIRE(market.FindInstrument("faa").GetTotalVolume() == 9116);
   REQUIRE(market.FindInstrument("fab").GetTotalVolume() == 6846);
   REQUIRE(market.FindInstrument("fac").GetTotalVolume() == 7666);
   REQUIRE(market.FindInstrument("fad").GetTotalVolume() == 8114);
   REQUIRE(market.FindInstrument("fae").GetTotalVolume() == 9303);
   REQUIRE(market.FindInstrument("faf").GetTotalVolume() == 8208);
   REQUIRE(market.FindInstrument("fag").GetTotalVolume() == 8533);
   REQUIRE(market.FindInstrument("fba").GetTotalVolume() == 8137);
   REQUIRE(market.FindInstrument("fbb").GetTotalVolume() == 8203);
   REQUIRE(market.FindInstrument("fbc").GetTotalVolume() == 9140);
   REQUIRE(market.FindInstrument("fbd").GetTotalVolume() == 8316);
   REQUIRE(market.FindInstrument("fbe").GetTotalVolume() == 7964);
   REQUIRE(market.FindInstrument("fbf").GetTotalVolume() == 8656);
   REQUIRE(market.FindInstrument("fbg").GetTotalVolume() == 10345);
   REQUIRE(market.FindInstrument("fca").GetTotalVolume() == 8606);
   REQUIRE(market.FindInstrument("fcb").GetTotalVolume() == 9025);
   REQUIRE(market.FindInstrument("fcc").GetTotalVolume() == 9737);
   REQUIRE(market.FindInstrument("fcd").GetTotalVolume() == 10176);
   REQUIRE(market.FindInstrument("fce").GetTotalVolume() == 9433);
   REQUIRE(market.FindInstrument("fcf").GetTotalVolume() == 8119);
   REQUIRE(market.FindInstrument("fcg").GetTotalVolume() == 10509);
   REQUIRE(market.FindInstrument("fda").GetTotalVolume() == 8758);
   REQUIRE(market.FindInstrument("fdb").GetTotalVolume() == 10140);
   REQUIRE(market.FindInstrument("fdc").GetTotalVolume() == 9297);
   REQUIRE(market.FindInstrument("fdd").GetTotalVolume() == 9540);
   REQUIRE(market.FindInstrument("fde").GetTotalVolume() == 8033);
   REQUIRE(market.FindInstrument("fdf").GetTotalVolume() == 9900);
   REQUIRE(market.FindInstrument("fdg").GetTotalVolume() == 8896);
   REQUIRE(market.FindInstrument("fea").GetTotalVolume() == 6841);
   REQUIRE(market.FindInstrument("feb").GetTotalVolume() == 8958);
   REQUIRE(market.FindInstrument("fec").GetTotalVolume() == 9137);
   REQUIRE(market.FindInstrument("fed").GetTotalVolume() == 8971);
   REQUIRE(market.FindInstrument("fee").GetTotalVolume() == 8575);
   REQUIRE(market.FindInstrument("fef").GetTotalVolume() == 8517);
   REQUIRE(market.FindInstrument("feg").GetTotalVolume() == 9717);
   REQUIRE(market.FindInstrument("ffa").GetTotalVolume() == 9170);
   REQUIRE(market.FindInstrument("ffb").GetTotalVolume() == 7512);
   REQUIRE(market.FindInstrument("ffc").GetTotalVolume() == 8610);
   REQUIRE(market.FindInstrument("ffd").GetTotalVolume() == 11054);
   REQUIRE(market.FindInstrument("ffe").GetTotalVolume() == 8832);
   REQUIRE(market.FindInstrument("fff").GetTotalVolume() == 7556);
   REQUIRE(market.FindInstrument("ffg").GetTotalVolume() == 8278);
   REQUIRE(market.FindInstrument("fga").GetTotalVolume() == 9796);
   REQUIRE(market.FindInstrument("fgb").GetTotalVolume() == 9013);
   REQUIRE(market.FindInstrument("fgc").GetTotalVolume() == 7611);
   REQUIRE(market.FindInstrument("fgd").GetTotalVolume() == 9391);
   REQUIRE(market.FindInstrument("fge").GetTotalVolume() == 8673);
   REQUIRE(market.FindInstrument("fgf").GetTotalVolume() == 8762);
   REQUIRE(market.FindInstrument("fgg").GetTotalVolume() == 9639);
   REQUIRE(market.FindInstrument("gaa").GetTotalVolume() == 10368);
   REQUIRE(market.FindInstrument("gab").GetTotalVolume() == 10601);
   REQUIRE(market.FindInstrument("gac").GetTotalVolume() == 8350);
   REQUIRE(market.FindInstrument("gad").GetTotalVolume() == 10304);
   REQUIRE(market.FindInstrument("gae").GetTotalVolume() == 8579);
   REQUIRE(market.FindInstrument("gaf").GetTotalVolume() == 7731);
   REQUIRE(market.FindInstrument("gag").GetTotalVolume() == 8801);
   REQUIRE(market.FindInstrument("gba").GetTotalVolume() == 8828);
   REQUIRE(market.FindInstrument("gbb").GetTotalVolume() == 10818);
   REQUIRE(market.FindInstrument("gbc").GetTotalVolume() == 7804);
   REQUIRE(market.FindInstrument("gbd").GetTotalVolume() == 9264);
   REQUIRE(market.FindInstrument("gbe").GetTotalVolume() == 7351);
   REQUIRE(market.FindInstrument("gbf").GetTotalVolume() == 9573);
   REQUIRE(market.FindInstrument("gbg").GetTotalVolume() == 8290);
   REQUIRE(market.FindInstrument("gca").GetTotalVolume() == 8708);
   REQUIRE(market.FindInstrument("gcb").GetTotalVolume() == 8684);
   REQUIRE(market.FindInstrument("gcc").GetTotalVolume() == 8777);
   REQUIRE(market.FindInstrument("gcd").GetTotalVolume() == 8504);
   REQUIRE(market.FindInstrument("gce").GetTotalVolume() == 8356);
   REQUIRE(market.FindInstrument("gcf").GetTotalVolume() == 10593);
   REQUIRE(market.FindInstrument("gcg").GetTotalVolume() == 10242);
   REQUIRE(market.FindInstrument("gda").GetTotalVolume() == 8236);
   REQUIRE(market.FindInstrument("gdb").GetTotalVolume() == 8321);
   REQUIRE(market.FindInstrument("gdc").GetTotalVolume() == 9204);
   REQUIRE(market.FindInstrument("gdd").GetTotalVolume() == 9618);
   REQUIRE(market.FindInstrument("gde").GetTotalVolume() == 7201);
   REQUIRE(market.FindInstrument("gdf").GetTotalVolume() == 9803);
   REQUIRE(market.FindInstrument("gdg").GetTotalVolume() == 8919);
   REQUIRE(market.FindInstrument("gea").GetTotalVolume() == 9502);
   REQUIRE(market.FindInstrument("geb").GetTotalVolume() == 8037);
   REQUIRE(market.FindInstrument("gec").GetTotalVolume() == 8585);
   REQUIRE(market.FindInstrument("ged").GetTotalVolume() == 8522);
   REQUIRE(market.FindInstrument("gee").GetTotalVolume() == 10120);
   REQUIRE(market.FindInstrument("gef").GetTotalVolume() == 6915);
   REQUIRE(market.FindInstrument("geg").GetTotalVolume() == 9824);
   REQUIRE(market.FindInstrument("gfa").GetTotalVolume() == 8108);
   REQUIRE(market.FindInstrument("gfb").GetTotalVolume() == 9444);
   REQUIRE(market.FindInstrument("gfc").GetTotalVolume() == 7958);
   REQUIRE(market.FindInstrument("gfd").GetTotalVolume() == 9907);
   REQUIRE(market.FindInstrument("gfe").GetTotalVolume() == 9885);
   REQUIRE(market.FindInstrument("gff").GetTotalVolume() == 8583);
   REQUIRE(market.FindInstrument("gfg").GetTotalVolume() == 8770);
   REQUIRE(market.FindInstrument("gga").GetTotalVolume() == 10756);
   REQUIRE(market.FindInstrument("ggb").GetTotalVolume() == 8182);
   REQUIRE(market.FindInstrument("ggc").GetTotalVolume() == 9138);
   REQUIRE(market.FindInstrument("ggd").GetTotalVolume() == 7716);
   REQUIRE(market.FindInstrument("gge").GetTotalVolume() == 8528);
   REQUIRE(market.FindInstrument("ggf").GetTotalVolume() == 9584);
   REQUIRE(market.FindInstrument("ggg").GetTotalVolume() == 9633);
}

TEST_CASE("Test high for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto          parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.FindInstrument("aaa").GetHigh() == 269);
   REQUIRE(market.FindInstrument("aab").GetHigh() == 36);
   REQUIRE(market.FindInstrument("aac").GetHigh() == 185);
   REQUIRE(market.FindInstrument("aad").GetHigh() == 121);
   REQUIRE(market.FindInstrument("aae").GetHigh() == 51);
   REQUIRE(market.FindInstrument("aaf").GetHigh() == 114);
   REQUIRE(market.FindInstrument("aag").GetHigh() == 205);
   REQUIRE(market.FindInstrument("aba").GetHigh() == 454);
   REQUIRE(market.FindInstrument("abb").GetHigh() == 226);
   REQUIRE(market.FindInstrument("abc").GetHigh() == 386);
   REQUIRE(market.FindInstrument("abd").GetHigh() == 91);
   REQUIRE(market.FindInstrument("abe").GetHigh() == 178);
   REQUIRE(market.FindInstrument("abf").GetHigh() == 422);
   REQUIRE(market.FindInstrument("abg").GetHigh() == 25);
   REQUIRE(market.FindInstrument("aca").GetHigh() == 442);
   REQUIRE(market.FindInstrument("acb").GetHigh() == 207);
   REQUIRE(market.FindInstrument("acc").GetHigh() == 148);
   REQUIRE(market.FindInstrument("acd").GetHigh() == 89);
   REQUIRE(market.FindInstrument("ace").GetHigh() == 146);
   REQUIRE(market.FindInstrument("acf").GetHigh() == 369);
   REQUIRE(market.FindInstrument("acg").GetHigh() == 104);
   REQUIRE(market.FindInstrument("ada").GetHigh() == 81);
   REQUIRE(market.FindInstrument("adb").GetHigh() == 423);
   REQUIRE(market.FindInstrument("adc").GetHigh() == 9);
   REQUIRE(market.FindInstrument("add").GetHigh() == 93);
   REQUIRE(market.FindInstrument("ade").GetHigh() == 428);
   REQUIRE(market.FindInstrument("adf").GetHigh() == 14);
   REQUIRE(market.FindInstrument("adg").GetHigh() == 838);
   REQUIRE(market.FindInstrument("aea").GetHigh() == 239);
   REQUIRE(market.FindInstrument("aeb").GetHigh() == 142);
   REQUIRE(market.FindInstrument("aec").GetHigh() == 5);
   REQUIRE(market.FindInstrument("aed").GetHigh() == 145);
   REQUIRE(market.FindInstrument("aee").GetHigh() == 140);
   REQUIRE(market.FindInstrument("aef").GetHigh() == 298);
   REQUIRE(market.FindInstrument("aeg").GetHigh() == 123);
   REQUIRE(market.FindInstrument("afa").GetHigh() == 111);
   REQUIRE(market.FindInstrument("afb").GetHigh() == 380);
   REQUIRE(market.FindInstrument("afc").GetHigh() == 501);
   REQUIRE(market.FindInstrument("afd").GetHigh() == 9);
   REQUIRE(market.FindInstrument("afe").GetHigh() == 107);
   REQUIRE(market.FindInstrument("aff").GetHigh() == 228);
   REQUIRE(market.FindInstrument("afg").GetHigh() == 197);
   REQUIRE(market.FindInstrument("aga").GetHigh() == 353);
   REQUIRE(market.FindInstrument("agb").GetHigh() == 258);
   REQUIRE(market.FindInstrument("agc").GetHigh() == 475);
   REQUIRE(market.FindInstrument("agd").GetHigh() == 398);
   REQUIRE(market.FindInstrument("age").GetHigh() == 11);
   REQUIRE(market.FindInstrument("agf").GetHigh() == 129);
   REQUIRE(market.FindInstrument("agg").GetHigh() == 608);
   REQUIRE(market.FindInstrument("baa").GetHigh() == 180);
   REQUIRE(market.FindInstrument("bab").GetHigh() == 218);
   REQUIRE(market.FindInstrument("bac").GetHigh() == 330);
   REQUIRE(market.FindInstrument("bad").GetHigh() == 72);
   REQUIRE(market.FindInstrument("bae").GetHigh() == 453);
   REQUIRE(market.FindInstrument("baf").GetHigh() == 273);
   REQUIRE(market.FindInstrument("bag").GetHigh() == 507);
   REQUIRE(market.FindInstrument("bba").GetHigh() == 66);
   REQUIRE(market.FindInstrument("bbb").GetHigh() == 138);
   REQUIRE(market.FindInstrument("bbc").GetHigh() == 190);
   REQUIRE(market.FindInstrument("bbd").GetHigh() == 287);
   REQUIRE(market.FindInstrument("bbe").GetHigh() == 187);
   REQUIRE(market.FindInstrument("bbf").GetHigh() == 7);
   REQUIRE(market.FindInstrument("bbg").GetHigh() == 276);
   REQUIRE(market.FindInstrument("bca").GetHigh() == 242);
   REQUIRE(market.FindInstrument("bcb").GetHigh() == 153);
   REQUIRE(market.FindInstrument("bcc").GetHigh() == 278);
   REQUIRE(market.FindInstrument("bcd").GetHigh() == 89);
   REQUIRE(market.FindInstrument("bce").GetHigh() == 48);
   REQUIRE(market.FindInstrument("bcf").GetHigh() == 502);
   REQUIRE(market.FindInstrument("bcg").GetHigh() == 34);
   REQUIRE(market.FindInstrument("bda").GetHigh() == 62);
   REQUIRE(market.FindInstrument("bdb").GetHigh() == 101);
   REQUIRE(market.FindInstrument("bdc").GetHigh() == 159);
   REQUIRE(market.FindInstrument("bdd").GetHigh() == 63);
   REQUIRE(market.FindInstrument("bde").GetHigh() == 959);
   REQUIRE(market.FindInstrument("bdf").GetHigh() == 322);
   REQUIRE(market.FindInstrument("bdg").GetHigh() == 330);
   REQUIRE(market.FindInstrument("bea").GetHigh() == 21);
   REQUIRE(market.FindInstrument("beb").GetHigh() == 350);
   REQUIRE(market.FindInstrument("bec").GetHigh() == 97);
   REQUIRE(market.FindInstrument("bed").GetHigh() == 349);
   REQUIRE(market.FindInstrument("bee").GetHigh() == 52);
   REQUIRE(market.FindInstrument("bef").GetHigh() == 117);
   REQUIRE(market.FindInstrument("beg").GetHigh() == 41);
   REQUIRE(market.FindInstrument("bfa").GetHigh() == 5);
   REQUIRE(market.FindInstrument("bfb").GetHigh() == 11);
   REQUIRE(market.FindInstrument("bfc").GetHigh() == 228);
   REQUIRE(market.FindInstrument("bfd").GetHigh() == 416);
   REQUIRE(market.FindInstrument("bfe").GetHigh() == 316);
   REQUIRE(market.FindInstrument("bff").GetHigh() == 388);
   REQUIRE(market.FindInstrument("bfg").GetHigh() == 270);
   REQUIRE(market.FindInstrument("bga").GetHigh() == 73);
   REQUIRE(market.FindInstrument("bgb").GetHigh() == 452);
   REQUIRE(market.FindInstrument("bgc").GetHigh() == 34);
   REQUIRE(market.FindInstrument("bgd").GetHigh() == 170);
   REQUIRE(market.FindInstrument("bge").GetHigh() == 84);
   REQUIRE(market.FindInstrument("bgf").GetHigh() == 333);
   REQUIRE(market.FindInstrument("bgg").GetHigh() == 252);
   REQUIRE(market.FindInstrument("caa").GetHigh() == 269);
   REQUIRE(market.FindInstrument("cab").GetHigh() == 273);
   REQUIRE(market.FindInstrument("cac").GetHigh() == 333);
   REQUIRE(market.FindInstrument("cad").GetHigh() == 368);
   REQUIRE(market.FindInstrument("cae").GetHigh() == 24);
   REQUIRE(market.FindInstrument("caf").GetHigh() == 311);
   REQUIRE(market.FindInstrument("cag").GetHigh() == 191);
   REQUIRE(market.FindInstrument("cba").GetHigh() == 185);
   REQUIRE(market.FindInstrument("cbb").GetHigh() == 170);
   REQUIRE(market.FindInstrument("cbc").GetHigh() == 46);
   REQUIRE(market.FindInstrument("cbd").GetHigh() == 321);
   REQUIRE(market.FindInstrument("cbe").GetHigh() == 654);
   REQUIRE(market.FindInstrument("cbf").GetHigh() == 132);
   REQUIRE(market.FindInstrument("cbg").GetHigh() == 82);
   REQUIRE(market.FindInstrument("cca").GetHigh() == 218);
   REQUIRE(market.FindInstrument("ccb").GetHigh() == 278);
   REQUIRE(market.FindInstrument("ccc").GetHigh() == 159);
   REQUIRE(market.FindInstrument("ccd").GetHigh() == 238);
   REQUIRE(market.FindInstrument("cce").GetHigh() == 299);
   REQUIRE(market.FindInstrument("ccf").GetHigh() == 180);
   REQUIRE(market.FindInstrument("ccg").GetHigh() == 154);
   REQUIRE(market.FindInstrument("cda").GetHigh() == 834);
   REQUIRE(market.FindInstrument("cdb").GetHigh() == 236);
   REQUIRE(market.FindInstrument("cdc").GetHigh() == 145);
   REQUIRE(market.FindInstrument("cdd").GetHigh() == 33);
   REQUIRE(market.FindInstrument("cde").GetHigh() == 87);
   REQUIRE(market.FindInstrument("cdf").GetHigh() == 50);
   REQUIRE(market.FindInstrument("cdg").GetHigh() == 695);
   REQUIRE(market.FindInstrument("cea").GetHigh() == 60);
   REQUIRE(market.FindInstrument("ceb").GetHigh() == 337);
   REQUIRE(market.FindInstrument("cec").GetHigh() == 345);
   REQUIRE(market.FindInstrument("ced").GetHigh() == 1239);
   REQUIRE(market.FindInstrument("cee").GetHigh() == 17);
   REQUIRE(market.FindInstrument("cef").GetHigh() == 113);
   REQUIRE(market.FindInstrument("ceg").GetHigh() == 25);
   REQUIRE(market.FindInstrument("cfa").GetHigh() == 231);
   REQUIRE(market.FindInstrument("cfb").GetHigh() == 206);
   REQUIRE(market.FindInstrument("cfc").GetHigh() == 23);
   REQUIRE(market.FindInstrument("cfd").GetHigh() == 193);
   REQUIRE(market.FindInstrument("cfe").GetHigh() == 116);
   REQUIRE(market.FindInstrument("cff").GetHigh() == 66);
   REQUIRE(market.FindInstrument("cfg").GetHigh() == 700);
   REQUIRE(market.FindInstrument("cga").GetHigh() == 253);
   REQUIRE(market.FindInstrument("cgb").GetHigh() == 240);
   REQUIRE(market.FindInstrument("cgc").GetHigh() == 294);
   REQUIRE(market.FindInstrument("cgd").GetHigh() == 254);
   REQUIRE(market.FindInstrument("cge").GetHigh() == 407);
   REQUIRE(market.FindInstrument("cgf").GetHigh() == 375);
   REQUIRE(market.FindInstrument("cgg").GetHigh() == 219);
   REQUIRE(market.FindInstrument("daa").GetHigh() == 250);
   REQUIRE(market.FindInstrument("dab").GetHigh() == 379);
   REQUIRE(market.FindInstrument("dac").GetHigh() == 265);
   REQUIRE(market.FindInstrument("dad").GetHigh() == 87);
   REQUIRE(market.FindInstrument("dae").GetHigh() == 53);
   REQUIRE(market.FindInstrument("daf").GetHigh() == 29);
   REQUIRE(market.FindInstrument("dag").GetHigh() == 229);
   REQUIRE(market.FindInstrument("dba").GetHigh() == 743);
   REQUIRE(market.FindInstrument("dbb").GetHigh() == 184);
   REQUIRE(market.FindInstrument("dbc").GetHigh() == 89);
   REQUIRE(market.FindInstrument("dbd").GetHigh() == 844);
   REQUIRE(market.FindInstrument("dbe").GetHigh() == 28);
   REQUIRE(market.FindInstrument("dbf").GetHigh() == 287);
   REQUIRE(market.FindInstrument("dbg").GetHigh() == 115);
   REQUIRE(market.FindInstrument("dca").GetHigh() == 46);
   REQUIRE(market.FindInstrument("dcb").GetHigh() == 319);
   REQUIRE(market.FindInstrument("dcc").GetHigh() == 348);
   REQUIRE(market.FindInstrument("dcd").GetHigh() == 241);
   REQUIRE(market.FindInstrument("dce").GetHigh() == 193);
   REQUIRE(market.FindInstrument("dcf").GetHigh() == 188);
   REQUIRE(market.FindInstrument("dcg").GetHigh() == 193);
   REQUIRE(market.FindInstrument("dda").GetHigh() == 430);
   REQUIRE(market.FindInstrument("ddb").GetHigh() == 32);
   REQUIRE(market.FindInstrument("ddc").GetHigh() == 451);
   REQUIRE(market.FindInstrument("ddd").GetHigh() == 327);
   REQUIRE(market.FindInstrument("dde").GetHigh() == 453);
   REQUIRE(market.FindInstrument("ddf").GetHigh() == 72);
   REQUIRE(market.FindInstrument("ddg").GetHigh() == 195);
   REQUIRE(market.FindInstrument("dea").GetHigh() == 87);
   REQUIRE(market.FindInstrument("deb").GetHigh() == 287);
   REQUIRE(market.FindInstrument("dec").GetHigh() == 63);
   REQUIRE(market.FindInstrument("ded").GetHigh() == 127);
   REQUIRE(market.FindInstrument("dee").GetHigh() == 221);
   REQUIRE(market.FindInstrument("def").GetHigh() == 240);
   REQUIRE(market.FindInstrument("deg").GetHigh() == 288);
   REQUIRE(market.FindInstrument("dfa").GetHigh() == 309);
   REQUIRE(market.FindInstrument("dfb").GetHigh() == 79);
   REQUIRE(market.FindInstrument("dfc").GetHigh() == 59);
   REQUIRE(market.FindInstrument("dfd").GetHigh() == 180);
   REQUIRE(market.FindInstrument("dfe").GetHigh() == 259);
   REQUIRE(market.FindInstrument("dff").GetHigh() == 256);
   REQUIRE(market.FindInstrument("dfg").GetHigh() == 290);
   REQUIRE(market.FindInstrument("dga").GetHigh() == 286);
   REQUIRE(market.FindInstrument("dgb").GetHigh() == 408);
   REQUIRE(market.FindInstrument("dgc").GetHigh() == 78);
   REQUIRE(market.FindInstrument("dgd").GetHigh() == 73);
   REQUIRE(market.FindInstrument("dge").GetHigh() == 812);
   REQUIRE(market.FindInstrument("dgf").GetHigh() == 321);
   REQUIRE(market.FindInstrument("dgg").GetHigh() == 355);
   REQUIRE(market.FindInstrument("eaa").GetHigh() == 112);
   REQUIRE(market.FindInstrument("eab").GetHigh() == 156);
   REQUIRE(market.FindInstrument("eac").GetHigh() == 276);
   REQUIRE(market.FindInstrument("ead").GetHigh() == 1155);
   REQUIRE(market.FindInstrument("eae").GetHigh() == 342);
   REQUIRE(market.FindInstrument("eaf").GetHigh() == 122);
   REQUIRE(market.FindInstrument("eag").GetHigh() == 23);
   REQUIRE(market.FindInstrument("eba").GetHigh() == 44);
   REQUIRE(market.FindInstrument("ebb").GetHigh() == 690);
   REQUIRE(market.FindInstrument("ebc").GetHigh() == 396);
   REQUIRE(market.FindInstrument("ebd").GetHigh() == 252);
   REQUIRE(market.FindInstrument("ebe").GetHigh() == 172);
   REQUIRE(market.FindInstrument("ebf").GetHigh() == 243);
   REQUIRE(market.FindInstrument("ebg").GetHigh() == 308);
   REQUIRE(market.FindInstrument("eca").GetHigh() == 256);
   REQUIRE(market.FindInstrument("ecb").GetHigh() == 167);
   REQUIRE(market.FindInstrument("ecc").GetHigh() == 299);
   REQUIRE(market.FindInstrument("ecd").GetHigh() == 65);
   REQUIRE(market.FindInstrument("ece").GetHigh() == 100);
   REQUIRE(market.FindInstrument("ecf").GetHigh() == 136);
   REQUIRE(market.FindInstrument("ecg").GetHigh() == 258);
   REQUIRE(market.FindInstrument("eda").GetHigh() == 159);
   REQUIRE(market.FindInstrument("edb").GetHigh() == 202);
   REQUIRE(market.FindInstrument("edc").GetHigh() == 8);
   REQUIRE(market.FindInstrument("edd").GetHigh() == 237);
   REQUIRE(market.FindInstrument("ede").GetHigh() == 134);
   REQUIRE(market.FindInstrument("edf").GetHigh() == 483);
   REQUIRE(market.FindInstrument("edg").GetHigh() == 217);
   REQUIRE(market.FindInstrument("eea").GetHigh() == 270);
   REQUIRE(market.FindInstrument("eeb").GetHigh() == 96);
   REQUIRE(market.FindInstrument("eec").GetHigh() == 33);
   REQUIRE(market.FindInstrument("eed").GetHigh() == 452);
   REQUIRE(market.FindInstrument("eee").GetHigh() == 463);
   REQUIRE(market.FindInstrument("eef").GetHigh() == 105);
   REQUIRE(market.FindInstrument("eeg").GetHigh() == 153);
   REQUIRE(market.FindInstrument("efa").GetHigh() == 478);
   REQUIRE(market.FindInstrument("efb").GetHigh() == 792);
   REQUIRE(market.FindInstrument("efc").GetHigh() == 102);
   REQUIRE(market.FindInstrument("efd").GetHigh() == 175);
   REQUIRE(market.FindInstrument("efe").GetHigh() == 296);
   REQUIRE(market.FindInstrument("eff").GetHigh() == 16);
   REQUIRE(market.FindInstrument("efg").GetHigh() == 13);
   REQUIRE(market.FindInstrument("ega").GetHigh() == 269);
   REQUIRE(market.FindInstrument("egb").GetHigh() == 110);
   REQUIRE(market.FindInstrument("egc").GetHigh() == 41);
   REQUIRE(market.FindInstrument("egd").GetHigh() == 35);
   REQUIRE(market.FindInstrument("ege").GetHigh() == 627);
   REQUIRE(market.FindInstrument("egf").GetHigh() == 421);
   REQUIRE(market.FindInstrument("egg").GetHigh() == 540);
   REQUIRE(market.FindInstrument("faa").GetHigh() == 389);
   REQUIRE(market.FindInstrument("fab").GetHigh() == 179);
   REQUIRE(market.FindInstrument("fac").GetHigh() == 158);
   REQUIRE(market.FindInstrument("fad").GetHigh() == 34);
   REQUIRE(market.FindInstrument("fae").GetHigh() == 84);
   REQUIRE(market.FindInstrument("faf").GetHigh() == 253);
   REQUIRE(market.FindInstrument("fag").GetHigh() == 296);
   REQUIRE(market.FindInstrument("fba").GetHigh() == 216);
   REQUIRE(market.FindInstrument("fbb").GetHigh() == 57);
   REQUIRE(market.FindInstrument("fbc").GetHigh() == 334);
   REQUIRE(market.FindInstrument("fbd").GetHigh() == 18);
   REQUIRE(market.FindInstrument("fbe").GetHigh() == 181);
   REQUIRE(market.FindInstrument("fbf").GetHigh() == 34);
   REQUIRE(market.FindInstrument("fbg").GetHigh() == 314);
   REQUIRE(market.FindInstrument("fca").GetHigh() == 253);
   REQUIRE(market.FindInstrument("fcb").GetHigh() == 174);
   REQUIRE(market.FindInstrument("fcc").GetHigh() == 23);
   REQUIRE(market.FindInstrument("fcd").GetHigh() == 38);
   REQUIRE(market.FindInstrument("fce").GetHigh() == 336);
   REQUIRE(market.FindInstrument("fcf").GetHigh() == 68);
   REQUIRE(market.FindInstrument("fcg").GetHigh() == 254);
   REQUIRE(market.FindInstrument("fda").GetHigh() == 326);
   REQUIRE(market.FindInstrument("fdb").GetHigh() == 355);
   REQUIRE(market.FindInstrument("fdc").GetHigh() == 120);
   REQUIRE(market.FindInstrument("fdd").GetHigh() == 187);
   REQUIRE(market.FindInstrument("fde").GetHigh() == 280);
   REQUIRE(market.FindInstrument("fdf").GetHigh() == 356);
   REQUIRE(market.FindInstrument("fdg").GetHigh() == 254);
   REQUIRE(market.FindInstrument("fea").GetHigh() == 3163);
   REQUIRE(market.FindInstrument("feb").GetHigh() == 215);
   REQUIRE(market.FindInstrument("fec").GetHigh() == 332);
   REQUIRE(market.FindInstrument("fed").GetHigh() == 125);
   REQUIRE(market.FindInstrument("fee").GetHigh() == 10);
   REQUIRE(market.FindInstrument("fef").GetHigh() == 50);
   REQUIRE(market.FindInstrument("feg").GetHigh() == 646);
   REQUIRE(market.FindInstrument("ffa").GetHigh() == 74);
   REQUIRE(market.FindInstrument("ffb").GetHigh() == 9);
   REQUIRE(market.FindInstrument("ffc").GetHigh() == 226);
   REQUIRE(market.FindInstrument("ffd").GetHigh() == 176);
   REQUIRE(market.FindInstrument("ffe").GetHigh() == 81);
   REQUIRE(market.FindInstrument("fff").GetHigh() == 103);
   REQUIRE(market.FindInstrument("ffg").GetHigh() == 231);
   REQUIRE(market.FindInstrument("fga").GetHigh() == 157);
   REQUIRE(market.FindInstrument("fgb").GetHigh() == 422);
   REQUIRE(market.FindInstrument("fgc").GetHigh() == 218);
   REQUIRE(market.FindInstrument("fgd").GetHigh() == 366);
   REQUIRE(market.FindInstrument("fge").GetHigh() == 148);
   REQUIRE(market.FindInstrument("fgf").GetHigh() == 104);
   REQUIRE(market.FindInstrument("fgg").GetHigh() == 227);
   REQUIRE(market.FindInstrument("gaa").GetHigh() == 721);
   REQUIRE(market.FindInstrument("gab").GetHigh() == 210);
   REQUIRE(market.FindInstrument("gac").GetHigh() == 484);
   REQUIRE(market.FindInstrument("gad").GetHigh() == 473);
   REQUIRE(market.FindInstrument("gae").GetHigh() == 248);
   REQUIRE(market.FindInstrument("gaf").GetHigh() == 183);
   REQUIRE(market.FindInstrument("gag").GetHigh() == 285);
   REQUIRE(market.FindInstrument("gba").GetHigh() == 350);
   REQUIRE(market.FindInstrument("gbb").GetHigh() == 92);
   REQUIRE(market.FindInstrument("gbc").GetHigh() == 413);
   REQUIRE(market.FindInstrument("gbd").GetHigh() == 365);
   REQUIRE(market.FindInstrument("gbe").GetHigh() == 135);
   REQUIRE(market.FindInstrument("gbf").GetHigh() == 7);
   REQUIRE(market.FindInstrument("gbg").GetHigh() == 442);
   REQUIRE(market.FindInstrument("gca").GetHigh() == 295);
   REQUIRE(market.FindInstrument("gcb").GetHigh() == 57);
   REQUIRE(market.FindInstrument("gcc").GetHigh() == 93);
   REQUIRE(market.FindInstrument("gcd").GetHigh() == 281);
   REQUIRE(market.FindInstrument("gce").GetHigh() == 225);
   REQUIRE(market.FindInstrument("gcf").GetHigh() == 360);
   REQUIRE(market.FindInstrument("gcg").GetHigh() == 81);
   REQUIRE(market.FindInstrument("gda").GetHigh() == 122);
   REQUIRE(market.FindInstrument("gdb").GetHigh() == 212);
   REQUIRE(market.FindInstrument("gdc").GetHigh() == 221);
   REQUIRE(market.FindInstrument("gdd").GetHigh() == 192);
   REQUIRE(market.FindInstrument("gde").GetHigh() == 38);
   REQUIRE(market.FindInstrument("gdf").GetHigh() == 263);
   REQUIRE(market.FindInstrument("gdg").GetHigh() == 359);
   REQUIRE(market.FindInstrument("gea").GetHigh() == 214);
   REQUIRE(market.FindInstrument("geb").GetHigh() == 260);
   REQUIRE(market.FindInstrument("gec").GetHigh() == 120);
   REQUIRE(market.FindInstrument("ged").GetHigh() == 35);
   REQUIRE(market.FindInstrument("gee").GetHigh() == 377);
   REQUIRE(market.FindInstrument("gef").GetHigh() == 156);
   REQUIRE(market.FindInstrument("geg").GetHigh() == 9);
   REQUIRE(market.FindInstrument("gfa").GetHigh() == 87);
   REQUIRE(market.FindInstrument("gfb").GetHigh() == 653);
   REQUIRE(market.FindInstrument("gfc").GetHigh() == 195);
   REQUIRE(market.FindInstrument("gfd").GetHigh() == 645);
   REQUIRE(market.FindInstrument("gfe").GetHigh() == 500);
   REQUIRE(market.FindInstrument("gff").GetHigh() == 273);
   REQUIRE(market.FindInstrument("gfg").GetHigh() == 18);
   REQUIRE(market.FindInstrument("gga").GetHigh() == 28);
   REQUIRE(market.FindInstrument("ggb").GetHigh() == 216);
   REQUIRE(market.FindInstrument("ggc").GetHigh() == 118);
   REQUIRE(market.FindInstrument("ggd").GetHigh() == 132);
   REQUIRE(market.FindInstrument("gge").GetHigh() == 34);
   REQUIRE(market.FindInstrument("ggf").GetHigh() == 198);
   REQUIRE(market.FindInstrument("ggg").GetHigh() == 694);
}

TEST_CASE("Test average weighted for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto          parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.FindInstrument("aaa").GetAverageWeightedPrice() == Approx(173.047478));
   REQUIRE(market.FindInstrument("aab").GetAverageWeightedPrice() == Approx(24.710880));
   REQUIRE(market.FindInstrument("aac").GetAverageWeightedPrice() == Approx(113.352079));
   REQUIRE(market.FindInstrument("aad").GetAverageWeightedPrice() == Approx(34.484228));
   REQUIRE(market.FindInstrument("aae").GetAverageWeightedPrice() == Approx(23.399739));
   REQUIRE(market.FindInstrument("aaf").GetAverageWeightedPrice() == Approx(31.684638));
   REQUIRE(market.FindInstrument("aag").GetAverageWeightedPrice() == Approx(99.253201));
   REQUIRE(market.FindInstrument("aba").GetAverageWeightedPrice() == Approx(296.885832));
   REQUIRE(market.FindInstrument("abb").GetAverageWeightedPrice() == Approx(110.397077));
   REQUIRE(market.FindInstrument("abc").GetAverageWeightedPrice() == Approx(252.031741));
   REQUIRE(market.FindInstrument("abd").GetAverageWeightedPrice() == Approx(50.321986));
   REQUIRE(market.FindInstrument("abe").GetAverageWeightedPrice() == Approx(73.743816));
   REQUIRE(market.FindInstrument("abf").GetAverageWeightedPrice() == Approx(284.972787));
   REQUIRE(market.FindInstrument("abg").GetAverageWeightedPrice() == Approx(7.495217));
   REQUIRE(market.FindInstrument("aca").GetAverageWeightedPrice() == Approx(257.744062));
   REQUIRE(market.FindInstrument("acb").GetAverageWeightedPrice() == Approx(100.395941));
   REQUIRE(market.FindInstrument("acc").GetAverageWeightedPrice() == Approx(90.403834));
   REQUIRE(market.FindInstrument("acd").GetAverageWeightedPrice() == Approx(22.686691));
   REQUIRE(market.FindInstrument("ace").GetAverageWeightedPrice() == Approx(36.693303));
   REQUIRE(market.FindInstrument("acf").GetAverageWeightedPrice() == Approx(196.630044));
   REQUIRE(market.FindInstrument("acg").GetAverageWeightedPrice() == Approx(56.531234));
   REQUIRE(market.FindInstrument("ada").GetAverageWeightedPrice() == Approx(34.757744));
   REQUIRE(market.FindInstrument("adb").GetAverageWeightedPrice() == Approx(219.240464));
   REQUIRE(market.FindInstrument("adc").GetAverageWeightedPrice() == Approx(5.073904));
   REQUIRE(market.FindInstrument("add").GetAverageWeightedPrice() == Approx(56.582020));
   REQUIRE(market.FindInstrument("ade").GetAverageWeightedPrice() == Approx(264.303879));
   REQUIRE(market.FindInstrument("adf").GetAverageWeightedPrice() == Approx(5.907303));
   REQUIRE(market.FindInstrument("adg").GetAverageWeightedPrice() == Approx(414.782216));
   REQUIRE(market.FindInstrument("aea").GetAverageWeightedPrice() == Approx(133.566013));
   REQUIRE(market.FindInstrument("aeb").GetAverageWeightedPrice() == Approx(94.987504));
   REQUIRE(market.FindInstrument("aec").GetAverageWeightedPrice() == Approx(5.000000));
   REQUIRE(market.FindInstrument("aed").GetAverageWeightedPrice() == Approx(70.304599));
   REQUIRE(market.FindInstrument("aee").GetAverageWeightedPrice() == Approx(90.198201));
   REQUIRE(market.FindInstrument("aef").GetAverageWeightedPrice() == Approx(123.396201));
   REQUIRE(market.FindInstrument("aeg").GetAverageWeightedPrice() == Approx(65.473371));
   REQUIRE(market.FindInstrument("afa").GetAverageWeightedPrice() == Approx(68.129378));
   REQUIRE(market.FindInstrument("afb").GetAverageWeightedPrice() == Approx(258.470129));
   REQUIRE(market.FindInstrument("afc").GetAverageWeightedPrice() == Approx(319.136656));
   REQUIRE(market.FindInstrument("afd").GetAverageWeightedPrice() == Approx(5.258096));
   REQUIRE(market.FindInstrument("afe").GetAverageWeightedPrice() == Approx(55.765858));
   REQUIRE(market.FindInstrument("aff").GetAverageWeightedPrice() == Approx(109.078683));
   REQUIRE(market.FindInstrument("afg").GetAverageWeightedPrice() == Approx(101.827123));
   REQUIRE(market.FindInstrument("aga").GetAverageWeightedPrice() == Approx(168.860724));
   REQUIRE(market.FindInstrument("agb").GetAverageWeightedPrice() == Approx(112.654912));
   REQUIRE(market.FindInstrument("agc").GetAverageWeightedPrice() == Approx(340.562586));
   REQUIRE(market.FindInstrument("agd").GetAverageWeightedPrice() == Approx(194.644585));
   REQUIRE(market.FindInstrument("age").GetAverageWeightedPrice() == Approx(5.278266));
   REQUIRE(market.FindInstrument("agf").GetAverageWeightedPrice() == Approx(82.207090));
   REQUIRE(market.FindInstrument("agg").GetAverageWeightedPrice() == Approx(352.994408));
   REQUIRE(market.FindInstrument("baa").GetAverageWeightedPrice() == Approx(75.240766));
   REQUIRE(market.FindInstrument("bab").GetAverageWeightedPrice() == Approx(103.603429));
   REQUIRE(market.FindInstrument("bac").GetAverageWeightedPrice() == Approx(164.112105));
   REQUIRE(market.FindInstrument("bad").GetAverageWeightedPrice() == Approx(22.590520));
   REQUIRE(market.FindInstrument("bae").GetAverageWeightedPrice() == Approx(251.111426));
   REQUIRE(market.FindInstrument("baf").GetAverageWeightedPrice() == Approx(158.907184));
   REQUIRE(market.FindInstrument("bag").GetAverageWeightedPrice() == Approx(247.266456));
   REQUIRE(market.FindInstrument("bba").GetAverageWeightedPrice() == Approx(44.623096));
   REQUIRE(market.FindInstrument("bbb").GetAverageWeightedPrice() == Approx(88.636274));
   REQUIRE(market.FindInstrument("bbc").GetAverageWeightedPrice() == Approx(86.950807));
   REQUIRE(market.FindInstrument("bbd").GetAverageWeightedPrice() == Approx(124.085806));
   REQUIRE(market.FindInstrument("bbe").GetAverageWeightedPrice() == Approx(96.666949));
   REQUIRE(market.FindInstrument("bbf").GetAverageWeightedPrice() == Approx(5.010062));
   REQUIRE(market.FindInstrument("bbg").GetAverageWeightedPrice() == Approx(115.825101));
   REQUIRE(market.FindInstrument("bca").GetAverageWeightedPrice() == Approx(116.521419));
   REQUIRE(market.FindInstrument("bcb").GetAverageWeightedPrice() == Approx(82.649453));
   REQUIRE(market.FindInstrument("bcc").GetAverageWeightedPrice() == Approx(107.827889));
   REQUIRE(market.FindInstrument("bcd").GetAverageWeightedPrice() == Approx(31.133772));
   REQUIRE(market.FindInstrument("bce").GetAverageWeightedPrice() == Approx(12.784752));
   REQUIRE(market.FindInstrument("bcf").GetAverageWeightedPrice() == Approx(313.418094));
   REQUIRE(market.FindInstrument("bcg").GetAverageWeightedPrice() == Approx(14.511211));
   REQUIRE(market.FindInstrument("bda").GetAverageWeightedPrice() == Approx(41.894775));
   REQUIRE(market.FindInstrument("bdb").GetAverageWeightedPrice() == Approx(31.860536));
   REQUIRE(market.FindInstrument("bdc").GetAverageWeightedPrice() == Approx(73.690286));
   REQUIRE(market.FindInstrument("bdd").GetAverageWeightedPrice() == Approx(19.042588));
   REQUIRE(market.FindInstrument("bde").GetAverageWeightedPrice() == Approx(443.100667));
   REQUIRE(market.FindInstrument("bdf").GetAverageWeightedPrice() == Approx(202.377659));
   REQUIRE(market.FindInstrument("bdg").GetAverageWeightedPrice() == Approx(164.170487));
   REQUIRE(market.FindInstrument("bea").GetAverageWeightedPrice() == Approx(7.400272));
   REQUIRE(market.FindInstrument("beb").GetAverageWeightedPrice() == Approx(147.353370));
   REQUIRE(market.FindInstrument("bec").GetAverageWeightedPrice() == Approx(45.992184));
   REQUIRE(market.FindInstrument("bed").GetAverageWeightedPrice() == Approx(126.469017));
   REQUIRE(market.FindInstrument("bee").GetAverageWeightedPrice() == Approx(31.314311));
   REQUIRE(market.FindInstrument("bef").GetAverageWeightedPrice() == Approx(73.175795));
   REQUIRE(market.FindInstrument("beg").GetAverageWeightedPrice() == Approx(9.937396));
   REQUIRE(market.FindInstrument("bfa").GetAverageWeightedPrice() == Approx(5.000000));
   REQUIRE(market.FindInstrument("bfb").GetAverageWeightedPrice() == Approx(6.151198));
   REQUIRE(market.FindInstrument("bfc").GetAverageWeightedPrice() == Approx(109.326228));
   REQUIRE(market.FindInstrument("bfd").GetAverageWeightedPrice() == Approx(230.002214));
   REQUIRE(market.FindInstrument("bfe").GetAverageWeightedPrice() == Approx(140.885099));
   REQUIRE(market.FindInstrument("bff").GetAverageWeightedPrice() == Approx(262.878316));
   REQUIRE(market.FindInstrument("bfg").GetAverageWeightedPrice() == Approx(151.529590));
   REQUIRE(market.FindInstrument("bga").GetAverageWeightedPrice() == Approx(41.190643));
   REQUIRE(market.FindInstrument("bgb").GetAverageWeightedPrice() == Approx(285.673813));
   REQUIRE(market.FindInstrument("bgc").GetAverageWeightedPrice() == Approx(10.831831));
   REQUIRE(market.FindInstrument("bgd").GetAverageWeightedPrice() == Approx(86.445567));
   REQUIRE(market.FindInstrument("bge").GetAverageWeightedPrice() == Approx(46.779106));
   REQUIRE(market.FindInstrument("bgf").GetAverageWeightedPrice() == Approx(204.096886));
   REQUIRE(market.FindInstrument("bgg").GetAverageWeightedPrice() == Approx(172.326427));
   REQUIRE(market.FindInstrument("caa").GetAverageWeightedPrice() == Approx(161.251312));
   REQUIRE(market.FindInstrument("cab").GetAverageWeightedPrice() == Approx(190.274381));
   REQUIRE(market.FindInstrument("cac").GetAverageWeightedPrice() == Approx(140.236190));
   REQUIRE(market.FindInstrument("cad").GetAverageWeightedPrice() == Approx(161.724396));
   REQUIRE(market.FindInstrument("cae").GetAverageWeightedPrice() == Approx(16.860754));
   REQUIRE(market.FindInstrument("caf").GetAverageWeightedPrice() == Approx(145.386056));
   REQUIRE(market.FindInstrument("cag").GetAverageWeightedPrice() == Approx(121.881581));
   REQUIRE(market.FindInstrument("cba").GetAverageWeightedPrice() == Approx(112.734386));
   REQUIRE(market.FindInstrument("cbb").GetAverageWeightedPrice() == Approx(77.996560));
   REQUIRE(market.FindInstrument("cbc").GetAverageWeightedPrice() == Approx(17.474919));
   REQUIRE(market.FindInstrument("cbd").GetAverageWeightedPrice() == Approx(199.229369));
   REQUIRE(market.FindInstrument("cbe").GetAverageWeightedPrice() == Approx(325.384755));
   REQUIRE(market.FindInstrument("cbf").GetAverageWeightedPrice() == Approx(88.913224));
   REQUIRE(market.FindInstrument("cbg").GetAverageWeightedPrice() == Approx(29.650508));
   REQUIRE(market.FindInstrument("cca").GetAverageWeightedPrice() == Approx(111.441236));
   REQUIRE(market.FindInstrument("ccb").GetAverageWeightedPrice() == Approx(155.801518));
   REQUIRE(market.FindInstrument("ccc").GetAverageWeightedPrice() == Approx(54.609122));
   REQUIRE(market.FindInstrument("ccd").GetAverageWeightedPrice() == Approx(142.132643));
   REQUIRE(market.FindInstrument("cce").GetAverageWeightedPrice() == Approx(100.681023));
   REQUIRE(market.FindInstrument("ccf").GetAverageWeightedPrice() == Approx(82.380232));
   REQUIRE(market.FindInstrument("ccg").GetAverageWeightedPrice() == Approx(101.319341));
   REQUIRE(market.FindInstrument("cda").GetAverageWeightedPrice() == Approx(511.334296));
   REQUIRE(market.FindInstrument("cdb").GetAverageWeightedPrice() == Approx(137.496872));
   REQUIRE(market.FindInstrument("cdc").GetAverageWeightedPrice() == Approx(60.784340));
   REQUIRE(market.FindInstrument("cdd").GetAverageWeightedPrice() == Approx(7.907356));
   REQUIRE(market.FindInstrument("cde").GetAverageWeightedPrice() == Approx(43.540996));
   REQUIRE(market.FindInstrument("cdf").GetAverageWeightedPrice() == Approx(12.583359));
   REQUIRE(market.FindInstrument("cdg").GetAverageWeightedPrice() == Approx(403.798806));
   REQUIRE(market.FindInstrument("cea").GetAverageWeightedPrice() == Approx(12.986314));
   REQUIRE(market.FindInstrument("ceb").GetAverageWeightedPrice() == Approx(223.314328));
   REQUIRE(market.FindInstrument("cec").GetAverageWeightedPrice() == Approx(180.504238));
   REQUIRE(market.FindInstrument("ced").GetAverageWeightedPrice() == Approx(562.057742));
   REQUIRE(market.FindInstrument("cee").GetAverageWeightedPrice() == Approx(6.493823));
   REQUIRE(market.FindInstrument("cef").GetAverageWeightedPrice() == Approx(50.802243));
   REQUIRE(market.FindInstrument("ceg").GetAverageWeightedPrice() == Approx(7.490582));
   REQUIRE(market.FindInstrument("cfa").GetAverageWeightedPrice() == Approx(91.445324));
   REQUIRE(market.FindInstrument("cfb").GetAverageWeightedPrice() == Approx(97.933991));
   REQUIRE(market.FindInstrument("cfc").GetAverageWeightedPrice() == Approx(8.387725));
   REQUIRE(market.FindInstrument("cfd").GetAverageWeightedPrice() == Approx(100.185271));
   REQUIRE(market.FindInstrument("cfe").GetAverageWeightedPrice() == Approx(76.134088));
   REQUIRE(market.FindInstrument("cff").GetAverageWeightedPrice() == Approx(38.482679));
   REQUIRE(market.FindInstrument("cfg").GetAverageWeightedPrice() == Approx(357.157881));
   REQUIRE(market.FindInstrument("cga").GetAverageWeightedPrice() == Approx(136.681189));
   REQUIRE(market.FindInstrument("cgb").GetAverageWeightedPrice() == Approx(124.009825));
   REQUIRE(market.FindInstrument("cgc").GetAverageWeightedPrice() == Approx(202.353969));
   REQUIRE(market.FindInstrument("cgd").GetAverageWeightedPrice() == Approx(137.939417));
   REQUIRE(market.FindInstrument("cge").GetAverageWeightedPrice() == Approx(202.744577));
   REQUIRE(market.FindInstrument("cgf").GetAverageWeightedPrice() == Approx(220.116753));
   REQUIRE(market.FindInstrument("cgg").GetAverageWeightedPrice() == Approx(64.019098));
   REQUIRE(market.FindInstrument("daa").GetAverageWeightedPrice() == Approx(97.879662));
   REQUIRE(market.FindInstrument("dab").GetAverageWeightedPrice() == Approx(216.051183));
   REQUIRE(market.FindInstrument("dac").GetAverageWeightedPrice() == Approx(135.332565));
   REQUIRE(market.FindInstrument("dad").GetAverageWeightedPrice() == Approx(55.385548));
   REQUIRE(market.FindInstrument("dae").GetAverageWeightedPrice() == Approx(22.099195));
   REQUIRE(market.FindInstrument("daf").GetAverageWeightedPrice() == Approx(9.743720));
   REQUIRE(market.FindInstrument("dag").GetAverageWeightedPrice() == Approx(137.360166));
   REQUIRE(market.FindInstrument("dba").GetAverageWeightedPrice() == Approx(423.155465));
   REQUIRE(market.FindInstrument("dbb").GetAverageWeightedPrice() == Approx(107.609970));
   REQUIRE(market.FindInstrument("dbc").GetAverageWeightedPrice() == Approx(29.714386));
   REQUIRE(market.FindInstrument("dbd").GetAverageWeightedPrice() == Approx(566.148552));
   REQUIRE(market.FindInstrument("dbe").GetAverageWeightedPrice() == Approx(11.749775));
   REQUIRE(market.FindInstrument("dbf").GetAverageWeightedPrice() == Approx(175.339178));
   REQUIRE(market.FindInstrument("dbg").GetAverageWeightedPrice() == Approx(49.507791));
   REQUIRE(market.FindInstrument("dca").GetAverageWeightedPrice() == Approx(24.739887));
   REQUIRE(market.FindInstrument("dcb").GetAverageWeightedPrice() == Approx(182.242077));
   REQUIRE(market.FindInstrument("dcc").GetAverageWeightedPrice() == Approx(135.922656));
   REQUIRE(market.FindInstrument("dcd").GetAverageWeightedPrice() == Approx(125.294678));
   REQUIRE(market.FindInstrument("dce").GetAverageWeightedPrice() == Approx(90.270291));
   REQUIRE(market.FindInstrument("dcf").GetAverageWeightedPrice() == Approx(71.770534));
   REQUIRE(market.FindInstrument("dcg").GetAverageWeightedPrice() == Approx(124.037592));
   REQUIRE(market.FindInstrument("dda").GetAverageWeightedPrice() == Approx(236.498904));
   REQUIRE(market.FindInstrument("ddb").GetAverageWeightedPrice() == Approx(8.111700));
   REQUIRE(market.FindInstrument("ddc").GetAverageWeightedPrice() == Approx(235.640055));
   REQUIRE(market.FindInstrument("ddd").GetAverageWeightedPrice() == Approx(223.409578));
   REQUIRE(market.FindInstrument("dde").GetAverageWeightedPrice() == Approx(308.153490));
   REQUIRE(market.FindInstrument("ddf").GetAverageWeightedPrice() == Approx(29.045281));
   REQUIRE(market.FindInstrument("ddg").GetAverageWeightedPrice() == Approx(87.178129));
   REQUIRE(market.FindInstrument("dea").GetAverageWeightedPrice() == Approx(21.628000));
   REQUIRE(market.FindInstrument("deb").GetAverageWeightedPrice() == Approx(171.998872));
   REQUIRE(market.FindInstrument("dec").GetAverageWeightedPrice() == Approx(25.144077));
   REQUIRE(market.FindInstrument("ded").GetAverageWeightedPrice() == Approx(33.725999));
   REQUIRE(market.FindInstrument("dee").GetAverageWeightedPrice() == Approx(85.590541));
   REQUIRE(market.FindInstrument("def").GetAverageWeightedPrice() == Approx(143.917001));
   REQUIRE(market.FindInstrument("deg").GetAverageWeightedPrice() == Approx(122.229953));
   REQUIRE(market.FindInstrument("dfa").GetAverageWeightedPrice() == Approx(180.094412));
   REQUIRE(market.FindInstrument("dfb").GetAverageWeightedPrice() == Approx(30.779149));
   REQUIRE(market.FindInstrument("dfc").GetAverageWeightedPrice() == Approx(26.354827));
   REQUIRE(market.FindInstrument("dfd").GetAverageWeightedPrice() == Approx(76.783053));
   REQUIRE(market.FindInstrument("dfe").GetAverageWeightedPrice() == Approx(157.086003));
   REQUIRE(market.FindInstrument("dff").GetAverageWeightedPrice() == Approx(139.588123));
   REQUIRE(market.FindInstrument("dfg").GetAverageWeightedPrice() == Approx(171.842141));
   REQUIRE(market.FindInstrument("dga").GetAverageWeightedPrice() == Approx(100.695986));
   REQUIRE(market.FindInstrument("dgb").GetAverageWeightedPrice() == Approx(274.716380));
   REQUIRE(market.FindInstrument("dgc").GetAverageWeightedPrice() == Approx(33.963937));
   REQUIRE(market.FindInstrument("dgd").GetAverageWeightedPrice() == Approx(26.174281));
   REQUIRE(market.FindInstrument("dge").GetAverageWeightedPrice() == Approx(428.224233));
   REQUIRE(market.FindInstrument("dgf").GetAverageWeightedPrice() == Approx(183.953910));
   REQUIRE(market.FindInstrument("dgg").GetAverageWeightedPrice() == Approx(80.289522));
   REQUIRE(market.FindInstrument("eaa").GetAverageWeightedPrice() == Approx(58.744411));
   REQUIRE(market.FindInstrument("eab").GetAverageWeightedPrice() == Approx(67.282279));
   REQUIRE(market.FindInstrument("eac").GetAverageWeightedPrice() == Approx(43.108225));
   REQUIRE(market.FindInstrument("ead").GetAverageWeightedPrice() == Approx(647.993196));
   REQUIRE(market.FindInstrument("eae").GetAverageWeightedPrice() == Approx(206.763015));
   REQUIRE(market.FindInstrument("eaf").GetAverageWeightedPrice() == Approx(45.842711));
   REQUIRE(market.FindInstrument("eag").GetAverageWeightedPrice() == Approx(7.870333));
   REQUIRE(market.FindInstrument("eba").GetAverageWeightedPrice() == Approx(14.502738));
   REQUIRE(market.FindInstrument("ebb").GetAverageWeightedPrice() == Approx(464.559589));
   REQUIRE(market.FindInstrument("ebc").GetAverageWeightedPrice() == Approx(198.810175));
   REQUIRE(market.FindInstrument("ebd").GetAverageWeightedPrice() == Approx(106.051496));
   REQUIRE(market.FindInstrument("ebe").GetAverageWeightedPrice() == Approx(73.779297));
   REQUIRE(market.FindInstrument("ebf").GetAverageWeightedPrice() == Approx(115.236994));
   REQUIRE(market.FindInstrument("ebg").GetAverageWeightedPrice() == Approx(211.281581));
   REQUIRE(market.FindInstrument("eca").GetAverageWeightedPrice() == Approx(96.204328));
   REQUIRE(market.FindInstrument("ecb").GetAverageWeightedPrice() == Approx(95.455058));
   REQUIRE(market.FindInstrument("ecc").GetAverageWeightedPrice() == Approx(162.717990));
   REQUIRE(market.FindInstrument("ecd").GetAverageWeightedPrice() == Approx(16.682984));
   REQUIRE(market.FindInstrument("ece").GetAverageWeightedPrice() == Approx(30.295760));
   REQUIRE(market.FindInstrument("ecf").GetAverageWeightedPrice() == Approx(56.274743));
   REQUIRE(market.FindInstrument("ecg").GetAverageWeightedPrice() == Approx(133.640203));
   REQUIRE(market.FindInstrument("eda").GetAverageWeightedPrice() == Approx(79.841426));
   REQUIRE(market.FindInstrument("edb").GetAverageWeightedPrice() == Approx(94.973107));
   REQUIRE(market.FindInstrument("edc").GetAverageWeightedPrice() == Approx(5.231373));
   REQUIRE(market.FindInstrument("edd").GetAverageWeightedPrice() == Approx(96.256486));
   REQUIRE(market.FindInstrument("ede").GetAverageWeightedPrice() == Approx(55.434589));
   REQUIRE(market.FindInstrument("edf").GetAverageWeightedPrice() == Approx(266.352250));
   REQUIRE(market.FindInstrument("edg").GetAverageWeightedPrice() == Approx(108.626057));
   REQUIRE(market.FindInstrument("eea").GetAverageWeightedPrice() == Approx(142.212508));
   REQUIRE(market.FindInstrument("eeb").GetAverageWeightedPrice() == Approx(44.392314));
   REQUIRE(market.FindInstrument("eec").GetAverageWeightedPrice() == Approx(16.793184));
   REQUIRE(market.FindInstrument("eed").GetAverageWeightedPrice() == Approx(318.864739));
   REQUIRE(market.FindInstrument("eee").GetAverageWeightedPrice() == Approx(269.487652));
   REQUIRE(market.FindInstrument("eef").GetAverageWeightedPrice() == Approx(45.406353));
   REQUIRE(market.FindInstrument("eeg").GetAverageWeightedPrice() == Approx(92.881839));
   REQUIRE(market.FindInstrument("efa").GetAverageWeightedPrice() == Approx(206.142183));
   REQUIRE(market.FindInstrument("efb").GetAverageWeightedPrice() == Approx(504.133255));
   REQUIRE(market.FindInstrument("efc").GetAverageWeightedPrice() == Approx(31.996615));
   REQUIRE(market.FindInstrument("efd").GetAverageWeightedPrice() == Approx(79.253246));
   REQUIRE(market.FindInstrument("efe").GetAverageWeightedPrice() == Approx(210.205847));
   REQUIRE(market.FindInstrument("eff").GetAverageWeightedPrice() == Approx(7.298064));
   REQUIRE(market.FindInstrument("efg").GetAverageWeightedPrice() == Approx(5.541233));
   REQUIRE(market.FindInstrument("ega").GetAverageWeightedPrice() == Approx(118.232568));
   REQUIRE(market.FindInstrument("egb").GetAverageWeightedPrice() == Approx(60.824630));
   REQUIRE(market.FindInstrument("egc").GetAverageWeightedPrice() == Approx(18.851839));
   REQUIRE(market.FindInstrument("egd").GetAverageWeightedPrice() == Approx(13.151668));
   REQUIRE(market.FindInstrument("ege").GetAverageWeightedPrice() == Approx(338.051029));
   REQUIRE(market.FindInstrument("egf").GetAverageWeightedPrice() == Approx(318.041900));
   REQUIRE(market.FindInstrument("egg").GetAverageWeightedPrice() == Approx(320.616703));
   REQUIRE(market.FindInstrument("faa").GetAverageWeightedPrice() == Approx(263.360136));
   REQUIRE(market.FindInstrument("fab").GetAverageWeightedPrice() == Approx(75.420245));
   REQUIRE(market.FindInstrument("fac").GetAverageWeightedPrice() == Approx(96.300417));
   REQUIRE(market.FindInstrument("fad").GetAverageWeightedPrice() == Approx(11.687700));
   REQUIRE(market.FindInstrument("fae").GetAverageWeightedPrice() == Approx(24.327636));
   REQUIRE(market.FindInstrument("faf").GetAverageWeightedPrice() == Approx(89.081506));
   REQUIRE(market.FindInstrument("fag").GetAverageWeightedPrice() == Approx(135.550334));
   REQUIRE(market.FindInstrument("fba").GetAverageWeightedPrice() == Approx(86.691533));
   REQUIRE(market.FindInstrument("fbb").GetAverageWeightedPrice() == Approx(27.593807));
   REQUIRE(market.FindInstrument("fbc").GetAverageWeightedPrice() == Approx(174.182823));
   REQUIRE(market.FindInstrument("fbd").GetAverageWeightedPrice() == Approx(6.181818));
   REQUIRE(market.FindInstrument("fbe").GetAverageWeightedPrice() == Approx(53.696509));
   REQUIRE(market.FindInstrument("fbf").GetAverageWeightedPrice() == Approx(13.133549));
   REQUIRE(market.FindInstrument("fbg").GetAverageWeightedPrice() == Approx(158.213050));
   REQUIRE(market.FindInstrument("fca").GetAverageWeightedPrice() == Approx(88.648501));
   REQUIRE(market.FindInstrument("fcb").GetAverageWeightedPrice() == Approx(65.095956));
   REQUIRE(market.FindInstrument("fcc").GetAverageWeightedPrice() == Approx(5.944233));
   REQUIRE(market.FindInstrument("fcd").GetAverageWeightedPrice() == Approx(17.211773));
   REQUIRE(market.FindInstrument("fce").GetAverageWeightedPrice() == Approx(181.285699));
   REQUIRE(market.FindInstrument("fcf").GetAverageWeightedPrice() == Approx(27.304225));
   REQUIRE(market.FindInstrument("fcg").GetAverageWeightedPrice() == Approx(181.444952));
   REQUIRE(market.FindInstrument("fda").GetAverageWeightedPrice() == Approx(216.739438));
   REQUIRE(market.FindInstrument("fdb").GetAverageWeightedPrice() == Approx(79.905325));
   REQUIRE(market.FindInstrument("fdc").GetAverageWeightedPrice() == Approx(43.230182));
   REQUIRE(market.FindInstrument("fdd").GetAverageWeightedPrice() == Approx(88.454822));
   REQUIRE(market.FindInstrument("fde").GetAverageWeightedPrice() == Approx(173.130586));
   REQUIRE(market.FindInstrument("fdf").GetAverageWeightedPrice() == Approx(191.624747));
   REQUIRE(market.FindInstrument("fdg").GetAverageWeightedPrice() == Approx(95.093975));
   REQUIRE(market.FindInstrument("fea").GetAverageWeightedPrice() == Approx(1259.285338));
   REQUIRE(market.FindInstrument("feb").GetAverageWeightedPrice() == Approx(98.651038));
   REQUIRE(market.FindInstrument("fec").GetAverageWeightedPrice() == Approx(166.200941));
   REQUIRE(market.FindInstrument("fed").GetAverageWeightedPrice() == Approx(90.107903));
   REQUIRE(market.FindInstrument("fee").GetAverageWeightedPrice() == Approx(5.738076));
   REQUIRE(market.FindInstrument("fef").GetAverageWeightedPrice() == Approx(20.936128));
   REQUIRE(market.FindInstrument("feg").GetAverageWeightedPrice() == Approx(305.272924));
   REQUIRE(market.FindInstrument("ffa").GetAverageWeightedPrice() == Approx(39.480371));
   REQUIRE(market.FindInstrument("ffb").GetAverageWeightedPrice() == Approx(5.270367));
   REQUIRE(market.FindInstrument("ffc").GetAverageWeightedPrice() == Approx(100.619048));
   REQUIRE(market.FindInstrument("ffd").GetAverageWeightedPrice() == Approx(82.685453));
   REQUIRE(market.FindInstrument("ffe").GetAverageWeightedPrice() == Approx(29.566576));
   REQUIRE(market.FindInstrument("fff").GetAverageWeightedPrice() == Approx(30.042880));
   REQUIRE(market.FindInstrument("ffg").GetAverageWeightedPrice() == Approx(124.625997));
   REQUIRE(market.FindInstrument("fga").GetAverageWeightedPrice() == Approx(67.577481));
   REQUIRE(market.FindInstrument("fgb").GetAverageWeightedPrice() == Approx(202.573283));
   REQUIRE(market.FindInstrument("fgc").GetAverageWeightedPrice() == Approx(107.103797));
   REQUIRE(market.FindInstrument("fgd").GetAverageWeightedPrice() == Approx(156.085401));
   REQUIRE(market.FindInstrument("fge").GetAverageWeightedPrice() == Approx(79.621238));
   REQUIRE(market.FindInstrument("fgf").GetAverageWeightedPrice() == Approx(32.956289));
   REQUIRE(market.FindInstrument("fgg").GetAverageWeightedPrice() == Approx(104.958813));
   REQUIRE(market.FindInstrument("gaa").GetAverageWeightedPrice() == Approx(426.342014));
   REQUIRE(market.FindInstrument("gab").GetAverageWeightedPrice() == Approx(90.442977));
   REQUIRE(market.FindInstrument("gac").GetAverageWeightedPrice() == Approx(318.003832));
   REQUIRE(market.FindInstrument("gad").GetAverageWeightedPrice() == Approx(178.209239));
   REQUIRE(market.FindInstrument("gae").GetAverageWeightedPrice() == Approx(129.578389));
   REQUIRE(market.FindInstrument("gaf").GetAverageWeightedPrice() == Approx(91.444056));
   REQUIRE(market.FindInstrument("gag").GetAverageWeightedPrice() == Approx(168.918532));
   REQUIRE(market.FindInstrument("gba").GetAverageWeightedPrice() == Approx(203.110444));
   REQUIRE(market.FindInstrument("gbb").GetAverageWeightedPrice() == Approx(21.388149));
   REQUIRE(market.FindInstrument("gbc").GetAverageWeightedPrice() == Approx(204.303947));
   REQUIRE(market.FindInstrument("gbd").GetAverageWeightedPrice() == Approx(201.199050));
   REQUIRE(market.FindInstrument("gbe").GetAverageWeightedPrice() == Approx(66.103115));
   REQUIRE(market.FindInstrument("gbf").GetAverageWeightedPrice() == Approx(5.080226));
   REQUIRE(market.FindInstrument("gbg").GetAverageWeightedPrice() == Approx(244.893486));
   REQUIRE(market.FindInstrument("gca").GetAverageWeightedPrice() == Approx(186.600482));
   REQUIRE(market.FindInstrument("gcb").GetAverageWeightedPrice() == Approx(36.380700));
   REQUIRE(market.FindInstrument("gcc").GetAverageWeightedPrice() == Approx(64.809274));
   REQUIRE(market.FindInstrument("gcd").GetAverageWeightedPrice() == Approx(139.392286));
   REQUIRE(market.FindInstrument("gce").GetAverageWeightedPrice() == Approx(121.132121));
   REQUIRE(market.FindInstrument("gcf").GetAverageWeightedPrice() == Approx(182.410649));
   REQUIRE(market.FindInstrument("gcg").GetAverageWeightedPrice() == Approx(32.893380));
   REQUIRE(market.FindInstrument("gda").GetAverageWeightedPrice() == Approx(60.410758));
   REQUIRE(market.FindInstrument("gdb").GetAverageWeightedPrice() == Approx(113.723471));
   REQUIRE(market.FindInstrument("gdc").GetAverageWeightedPrice() == Approx(119.847240));
   REQUIRE(market.FindInstrument("gdd").GetAverageWeightedPrice() == Approx(59.137243));
   REQUIRE(market.FindInstrument("gde").GetAverageWeightedPrice() == Approx(23.083738));
   REQUIRE(market.FindInstrument("gdf").GetAverageWeightedPrice() == Approx(115.492196));
   REQUIRE(market.FindInstrument("gdg").GetAverageWeightedPrice() == Approx(186.825205));
   REQUIRE(market.FindInstrument("gea").GetAverageWeightedPrice() == Approx(80.638392));
   REQUIRE(market.FindInstrument("geb").GetAverageWeightedPrice() == Approx(161.101033));
   REQUIRE(market.FindInstrument("gec").GetAverageWeightedPrice() == Approx(46.041235));
   REQUIRE(market.FindInstrument("ged").GetAverageWeightedPrice() == Approx(15.226825));
   REQUIRE(market.FindInstrument("gee").GetAverageWeightedPrice() == Approx(269.448715));
   REQUIRE(market.FindInstrument("gef").GetAverageWeightedPrice() == Approx(83.658424));
   REQUIRE(market.FindInstrument("geg").GetAverageWeightedPrice() == Approx(5.152382));
   REQUIRE(market.FindInstrument("gfa").GetAverageWeightedPrice() == Approx(55.959916));
   REQUIRE(market.FindInstrument("gfb").GetAverageWeightedPrice() == Approx(319.528695));
   REQUIRE(market.FindInstrument("gfc").GetAverageWeightedPrice() == Approx(122.189621));
   REQUIRE(market.FindInstrument("gfd").GetAverageWeightedPrice() == Approx(367.171798));
   REQUIRE(market.FindInstrument("gfe").GetAverageWeightedPrice() == Approx(316.462924));
   REQUIRE(market.FindInstrument("gff").GetAverageWeightedPrice() == Approx(142.268438));
   REQUIRE(market.FindInstrument("gfg").GetAverageWeightedPrice() == Approx(6.739567));
   REQUIRE(market.FindInstrument("gga").GetAverageWeightedPrice() == Approx(9.062756));
   REQUIRE(market.FindInstrument("ggb").GetAverageWeightedPrice() == Approx(120.080054));
   REQUIRE(market.FindInstrument("ggc").GetAverageWeightedPrice() == Approx(83.084592));
   REQUIRE(market.FindInstrument("ggd").GetAverageWeightedPrice() == Approx(88.898004));
   REQUIRE(market.FindInstrument("gge").GetAverageWeightedPrice() == Approx(11.386609));
   REQUIRE(market.FindInstrument("ggf").GetAverageWeightedPrice() == Approx(114.921327));
   REQUIRE(market.FindInstrument("ggg").GetAverageWeightedPrice() == Approx(443.003322));
}

TEST_CASE("Test max time gap for each symbol", "[market]")
{
   std::ifstream in("test_data/input.csv");
   auto          parser = std::make_unique<CSVParser>(in);

   Market market(std::move(parser));

   market.Process();

   REQUIRE(market.FindInstrument("aaa").GetLargestTradeGap() == 9649637);
   REQUIRE(market.FindInstrument("aab").GetLargestTradeGap() == 9820534);
   REQUIRE(market.FindInstrument("aac").GetLargestTradeGap() == 9681252);
   REQUIRE(market.FindInstrument("aad").GetLargestTradeGap() == 9922815);
   REQUIRE(market.FindInstrument("aae").GetLargestTradeGap() == 9709483);
   REQUIRE(market.FindInstrument("aaf").GetLargestTradeGap() == 9823113);
   REQUIRE(market.FindInstrument("aag").GetLargestTradeGap() == 9993799);
   REQUIRE(market.FindInstrument("aba").GetLargestTradeGap() == 9944354);
   REQUIRE(market.FindInstrument("abb").GetLargestTradeGap() == 9932397);
   REQUIRE(market.FindInstrument("abc").GetLargestTradeGap() == 9788273);
   REQUIRE(market.FindInstrument("abd").GetLargestTradeGap() == 9358021);
   REQUIRE(market.FindInstrument("abe").GetLargestTradeGap() == 9325378);
   REQUIRE(market.FindInstrument("abf").GetLargestTradeGap() == 9883882);
   REQUIRE(market.FindInstrument("abg").GetLargestTradeGap() == 9967337);
   REQUIRE(market.FindInstrument("aca").GetLargestTradeGap() == 9749625);
   REQUIRE(market.FindInstrument("acb").GetLargestTradeGap() == 9866338);
   REQUIRE(market.FindInstrument("acc").GetLargestTradeGap() == 9999631);
   REQUIRE(market.FindInstrument("acd").GetLargestTradeGap() == 9851299);
   REQUIRE(market.FindInstrument("ace").GetLargestTradeGap() == 9954566);
   REQUIRE(market.FindInstrument("acf").GetLargestTradeGap() == 9896307);
   REQUIRE(market.FindInstrument("acg").GetLargestTradeGap() == 9688552);
   REQUIRE(market.FindInstrument("ada").GetLargestTradeGap() == 9985317);
   REQUIRE(market.FindInstrument("adb").GetLargestTradeGap() == 9908199);
   REQUIRE(market.FindInstrument("adc").GetLargestTradeGap() == 9985581);
   REQUIRE(market.FindInstrument("add").GetLargestTradeGap() == 9682850);
   REQUIRE(market.FindInstrument("ade").GetLargestTradeGap() == 9859387);
   REQUIRE(market.FindInstrument("adf").GetLargestTradeGap() == 9760317);
   REQUIRE(market.FindInstrument("adg").GetLargestTradeGap() == 9639165);
   REQUIRE(market.FindInstrument("aea").GetLargestTradeGap() == 9957146);
   REQUIRE(market.FindInstrument("aeb").GetLargestTradeGap() == 9839538);
   REQUIRE(market.FindInstrument("aec").GetLargestTradeGap() == 9891678);
   REQUIRE(market.FindInstrument("aed").GetLargestTradeGap() == 9978297);
   REQUIRE(market.FindInstrument("aee").GetLargestTradeGap() == 9876952);
   REQUIRE(market.FindInstrument("aef").GetLargestTradeGap() == 9981498);
   REQUIRE(market.FindInstrument("aeg").GetLargestTradeGap() == 9989289);
   REQUIRE(market.FindInstrument("afa").GetLargestTradeGap() == 9473143);
   REQUIRE(market.FindInstrument("afb").GetLargestTradeGap() == 9769012);
   REQUIRE(market.FindInstrument("afc").GetLargestTradeGap() == 9927521);
   REQUIRE(market.FindInstrument("afd").GetLargestTradeGap() == 9933467);
   REQUIRE(market.FindInstrument("afe").GetLargestTradeGap() == 9768578);
   REQUIRE(market.FindInstrument("aff").GetLargestTradeGap() == 9981648);
   REQUIRE(market.FindInstrument("afg").GetLargestTradeGap() == 9747760);
   REQUIRE(market.FindInstrument("aga").GetLargestTradeGap() == 9867365);
   REQUIRE(market.FindInstrument("agb").GetLargestTradeGap() == 9987016);
   REQUIRE(market.FindInstrument("agc").GetLargestTradeGap() == 9871335);
   REQUIRE(market.FindInstrument("agd").GetLargestTradeGap() == 9955366);
   REQUIRE(market.FindInstrument("age").GetLargestTradeGap() == 9842364);
   REQUIRE(market.FindInstrument("agf").GetLargestTradeGap() == 9891151);
   REQUIRE(market.FindInstrument("agg").GetLargestTradeGap() == 9651937);
   REQUIRE(market.FindInstrument("baa").GetLargestTradeGap() == 9939783);
   REQUIRE(market.FindInstrument("bab").GetLargestTradeGap() == 9983472);
   REQUIRE(market.FindInstrument("bac").GetLargestTradeGap() == 9936843);
   REQUIRE(market.FindInstrument("bad").GetLargestTradeGap() == 9993417);
   REQUIRE(market.FindInstrument("bae").GetLargestTradeGap() == 9977201);
   REQUIRE(market.FindInstrument("baf").GetLargestTradeGap() == 9742027);
   REQUIRE(market.FindInstrument("bag").GetLargestTradeGap() == 9755040);
   REQUIRE(market.FindInstrument("bba").GetLargestTradeGap() == 9504872);
   REQUIRE(market.FindInstrument("bbb").GetLargestTradeGap() == 9665486);
   REQUIRE(market.FindInstrument("bbc").GetLargestTradeGap() == 9423855);
   REQUIRE(market.FindInstrument("bbd").GetLargestTradeGap() == 9880922);
   REQUIRE(market.FindInstrument("bbe").GetLargestTradeGap() == 9939208);
   REQUIRE(market.FindInstrument("bbf").GetLargestTradeGap() == 9884954);
   REQUIRE(market.FindInstrument("bbg").GetLargestTradeGap() == 9812159);
   REQUIRE(market.FindInstrument("bca").GetLargestTradeGap() == 9950467);
   REQUIRE(market.FindInstrument("bcb").GetLargestTradeGap() == 9835474);
   REQUIRE(market.FindInstrument("bcc").GetLargestTradeGap() == 9881288);
   REQUIRE(market.FindInstrument("bcd").GetLargestTradeGap() == 9690997);
   REQUIRE(market.FindInstrument("bce").GetLargestTradeGap() == 9980340);
   REQUIRE(market.FindInstrument("bcf").GetLargestTradeGap() == 9981302);
   REQUIRE(market.FindInstrument("bcg").GetLargestTradeGap() == 9435779);
   REQUIRE(market.FindInstrument("bda").GetLargestTradeGap() == 9978606);
   REQUIRE(market.FindInstrument("bdb").GetLargestTradeGap() == 9892525);
   REQUIRE(market.FindInstrument("bdc").GetLargestTradeGap() == 9281535);
   REQUIRE(market.FindInstrument("bdd").GetLargestTradeGap() == 9948335);
   REQUIRE(market.FindInstrument("bde").GetLargestTradeGap() == 9523342);
   REQUIRE(market.FindInstrument("bdf").GetLargestTradeGap() == 9955104);
   REQUIRE(market.FindInstrument("bdg").GetLargestTradeGap() == 9986939);
   REQUIRE(market.FindInstrument("bea").GetLargestTradeGap() == 9797839);
   REQUIRE(market.FindInstrument("beb").GetLargestTradeGap() == 9993816);
   REQUIRE(market.FindInstrument("bec").GetLargestTradeGap() == 9852355);
   REQUIRE(market.FindInstrument("bed").GetLargestTradeGap() == 9846221);
   REQUIRE(market.FindInstrument("bee").GetLargestTradeGap() == 9934149);
   REQUIRE(market.FindInstrument("bef").GetLargestTradeGap() == 9917959);
   REQUIRE(market.FindInstrument("beg").GetLargestTradeGap() == 9815895);
   REQUIRE(market.FindInstrument("bfa").GetLargestTradeGap() == 9914096);
   REQUIRE(market.FindInstrument("bfb").GetLargestTradeGap() == 9613459);
   REQUIRE(market.FindInstrument("bfc").GetLargestTradeGap() == 9747374);
   REQUIRE(market.FindInstrument("bfd").GetLargestTradeGap() == 9424867);
   REQUIRE(market.FindInstrument("bfe").GetLargestTradeGap() == 9660446);
   REQUIRE(market.FindInstrument("bff").GetLargestTradeGap() == 9798254);
   REQUIRE(market.FindInstrument("bfg").GetLargestTradeGap() == 9407433);
   REQUIRE(market.FindInstrument("bga").GetLargestTradeGap() == 9969717);
   REQUIRE(market.FindInstrument("bgb").GetLargestTradeGap() == 9562094);
   REQUIRE(market.FindInstrument("bgc").GetLargestTradeGap() == 9611669);
   REQUIRE(market.FindInstrument("bgd").GetLargestTradeGap() == 9820096);
   REQUIRE(market.FindInstrument("bge").GetLargestTradeGap() == 9195974);
   REQUIRE(market.FindInstrument("bgf").GetLargestTradeGap() == 9669171);
   REQUIRE(market.FindInstrument("bgg").GetLargestTradeGap() == 9815787);
   REQUIRE(market.FindInstrument("caa").GetLargestTradeGap() == 9868089);
   REQUIRE(market.FindInstrument("cab").GetLargestTradeGap() == 9957388);
   REQUIRE(market.FindInstrument("cac").GetLargestTradeGap() == 9910152);
   REQUIRE(market.FindInstrument("cad").GetLargestTradeGap() == 9906771);
   REQUIRE(market.FindInstrument("cae").GetLargestTradeGap() == 9858097);
   REQUIRE(market.FindInstrument("caf").GetLargestTradeGap() == 9849731);
   REQUIRE(market.FindInstrument("cag").GetLargestTradeGap() == 9970959);
   REQUIRE(market.FindInstrument("cba").GetLargestTradeGap() == 9971383);
   REQUIRE(market.FindInstrument("cbb").GetLargestTradeGap() == 9632487);
   REQUIRE(market.FindInstrument("cbc").GetLargestTradeGap() == 9225125);
   REQUIRE(market.FindInstrument("cbd").GetLargestTradeGap() == 9925190);
   REQUIRE(market.FindInstrument("cbe").GetLargestTradeGap() == 9616362);
   REQUIRE(market.FindInstrument("cbf").GetLargestTradeGap() == 9975156);
   REQUIRE(market.FindInstrument("cbg").GetLargestTradeGap() == 9911249);
   REQUIRE(market.FindInstrument("cca").GetLargestTradeGap() == 9967173);
   REQUIRE(market.FindInstrument("ccb").GetLargestTradeGap() == 9804345);
   REQUIRE(market.FindInstrument("ccc").GetLargestTradeGap() == 9575545);
   REQUIRE(market.FindInstrument("ccd").GetLargestTradeGap() == 9740721);
   REQUIRE(market.FindInstrument("cce").GetLargestTradeGap() == 9766965);
   REQUIRE(market.FindInstrument("ccf").GetLargestTradeGap() == 9915649);
   REQUIRE(market.FindInstrument("ccg").GetLargestTradeGap() == 9996918);
   REQUIRE(market.FindInstrument("cda").GetLargestTradeGap() == 9895300);
   REQUIRE(market.FindInstrument("cdb").GetLargestTradeGap() == 9978047);
   REQUIRE(market.FindInstrument("cdc").GetLargestTradeGap() == 9983017);
   REQUIRE(market.FindInstrument("cdd").GetLargestTradeGap() == 9811708);
   REQUIRE(market.FindInstrument("cde").GetLargestTradeGap() == 9954048);
   REQUIRE(market.FindInstrument("cdf").GetLargestTradeGap() == 9910988);
   REQUIRE(market.FindInstrument("cdg").GetLargestTradeGap() == 9842718);
   REQUIRE(market.FindInstrument("cea").GetLargestTradeGap() == 9621313);
   REQUIRE(market.FindInstrument("ceb").GetLargestTradeGap() == 9985220);
   REQUIRE(market.FindInstrument("cec").GetLargestTradeGap() == 9949796);
   REQUIRE(market.FindInstrument("ced").GetLargestTradeGap() == 9828950);
   REQUIRE(market.FindInstrument("cee").GetLargestTradeGap() == 9563886);
   REQUIRE(market.FindInstrument("cef").GetLargestTradeGap() == 9992874);
   REQUIRE(market.FindInstrument("ceg").GetLargestTradeGap() == 9890426);
   REQUIRE(market.FindInstrument("cfa").GetLargestTradeGap() == 9774753);
   REQUIRE(market.FindInstrument("cfb").GetLargestTradeGap() == 9939634);
   REQUIRE(market.FindInstrument("cfc").GetLargestTradeGap() == 9779045);
   REQUIRE(market.FindInstrument("cfd").GetLargestTradeGap() == 9423180);
   REQUIRE(market.FindInstrument("cfe").GetLargestTradeGap() == 9233340);
   REQUIRE(market.FindInstrument("cff").GetLargestTradeGap() == 9859470);
   REQUIRE(market.FindInstrument("cfg").GetLargestTradeGap() == 9922452);
   REQUIRE(market.FindInstrument("cga").GetLargestTradeGap() == 9915551);
   REQUIRE(market.FindInstrument("cgb").GetLargestTradeGap() == 9838198);
   REQUIRE(market.FindInstrument("cgc").GetLargestTradeGap() == 9879332);
   REQUIRE(market.FindInstrument("cgd").GetLargestTradeGap() == 9922748);
   REQUIRE(market.FindInstrument("cge").GetLargestTradeGap() == 9715304);
   REQUIRE(market.FindInstrument("cgf").GetLargestTradeGap() == 9992308);
   REQUIRE(market.FindInstrument("cgg").GetLargestTradeGap() == 9776731);
   REQUIRE(market.FindInstrument("daa").GetLargestTradeGap() == 9962448);
   REQUIRE(market.FindInstrument("dab").GetLargestTradeGap() == 9699073);
   REQUIRE(market.FindInstrument("dac").GetLargestTradeGap() == 9939281);
   REQUIRE(market.FindInstrument("dad").GetLargestTradeGap() == 9760929);
   REQUIRE(market.FindInstrument("dae").GetLargestTradeGap() == 9790067);
   REQUIRE(market.FindInstrument("daf").GetLargestTradeGap() == 9937773);
   REQUIRE(market.FindInstrument("dag").GetLargestTradeGap() == 9947288);
   REQUIRE(market.FindInstrument("dba").GetLargestTradeGap() == 9869895);
   REQUIRE(market.FindInstrument("dbb").GetLargestTradeGap() == 9864853);
   REQUIRE(market.FindInstrument("dbc").GetLargestTradeGap() == 9643918);
   REQUIRE(market.FindInstrument("dbd").GetLargestTradeGap() == 9806310);
   REQUIRE(market.FindInstrument("dbe").GetLargestTradeGap() == 9873175);
   REQUIRE(market.FindInstrument("dbf").GetLargestTradeGap() == 9662883);
   REQUIRE(market.FindInstrument("dbg").GetLargestTradeGap() == 9869689);
   REQUIRE(market.FindInstrument("dca").GetLargestTradeGap() == 9736312);
   REQUIRE(market.FindInstrument("dcb").GetLargestTradeGap() == 9580701);
   REQUIRE(market.FindInstrument("dcc").GetLargestTradeGap() == 9852342);
   REQUIRE(market.FindInstrument("dcd").GetLargestTradeGap() == 9985783);
   REQUIRE(market.FindInstrument("dce").GetLargestTradeGap() == 9948973);
   REQUIRE(market.FindInstrument("dcf").GetLargestTradeGap() == 9772899);
   REQUIRE(market.FindInstrument("dcg").GetLargestTradeGap() == 9933623);
   REQUIRE(market.FindInstrument("dda").GetLargestTradeGap() == 9970925);
   REQUIRE(market.FindInstrument("ddb").GetLargestTradeGap() == 9764314);
   REQUIRE(market.FindInstrument("ddc").GetLargestTradeGap() == 9968381);
   REQUIRE(market.FindInstrument("ddd").GetLargestTradeGap() == 9916832);
   REQUIRE(market.FindInstrument("dde").GetLargestTradeGap() == 9680565);
   REQUIRE(market.FindInstrument("ddf").GetLargestTradeGap() == 9891797);
   REQUIRE(market.FindInstrument("ddg").GetLargestTradeGap() == 9720912);
   REQUIRE(market.FindInstrument("dea").GetLargestTradeGap() == 9964640);
   REQUIRE(market.FindInstrument("deb").GetLargestTradeGap() == 9901344);
   REQUIRE(market.FindInstrument("dec").GetLargestTradeGap() == 9982613);
   REQUIRE(market.FindInstrument("ded").GetLargestTradeGap() == 9985855);
   REQUIRE(market.FindInstrument("dee").GetLargestTradeGap() == 9774989);
   REQUIRE(market.FindInstrument("def").GetLargestTradeGap() == 9932394);
   REQUIRE(market.FindInstrument("deg").GetLargestTradeGap() == 9790236);
   REQUIRE(market.FindInstrument("dfa").GetLargestTradeGap() == 9735604);
   REQUIRE(market.FindInstrument("dfb").GetLargestTradeGap() == 9668103);
   REQUIRE(market.FindInstrument("dfc").GetLargestTradeGap() == 9998805);
   REQUIRE(market.FindInstrument("dfd").GetLargestTradeGap() == 9954259);
   REQUIRE(market.FindInstrument("dfe").GetLargestTradeGap() == 9783630);
   REQUIRE(market.FindInstrument("dff").GetLargestTradeGap() == 9855156);
   REQUIRE(market.FindInstrument("dfg").GetLargestTradeGap() == 9895063);
   REQUIRE(market.FindInstrument("dga").GetLargestTradeGap() == 9823142);
   REQUIRE(market.FindInstrument("dgb").GetLargestTradeGap() == 9942129);
   REQUIRE(market.FindInstrument("dgc").GetLargestTradeGap() == 9836286);
   REQUIRE(market.FindInstrument("dgd").GetLargestTradeGap() == 9517328);
   REQUIRE(market.FindInstrument("dge").GetLargestTradeGap() == 9886656);
   REQUIRE(market.FindInstrument("dgf").GetLargestTradeGap() == 9555628);
   REQUIRE(market.FindInstrument("dgg").GetLargestTradeGap() == 9876451);
   REQUIRE(market.FindInstrument("eaa").GetLargestTradeGap() == 9914340);
   REQUIRE(market.FindInstrument("eab").GetLargestTradeGap() == 9636296);
   REQUIRE(market.FindInstrument("eac").GetLargestTradeGap() == 9680683);
   REQUIRE(market.FindInstrument("ead").GetLargestTradeGap() == 9899364);
   REQUIRE(market.FindInstrument("eae").GetLargestTradeGap() == 9898212);
   REQUIRE(market.FindInstrument("eaf").GetLargestTradeGap() == 9842499);
   REQUIRE(market.FindInstrument("eag").GetLargestTradeGap() == 9958897);
   REQUIRE(market.FindInstrument("eba").GetLargestTradeGap() == 9985857);
   REQUIRE(market.FindInstrument("ebb").GetLargestTradeGap() == 9899913);
   REQUIRE(market.FindInstrument("ebc").GetLargestTradeGap() == 9999968);
   REQUIRE(market.FindInstrument("ebd").GetLargestTradeGap() == 9962374);
   REQUIRE(market.FindInstrument("ebe").GetLargestTradeGap() == 9954361);
   REQUIRE(market.FindInstrument("ebf").GetLargestTradeGap() == 9992276);
   REQUIRE(market.FindInstrument("ebg").GetLargestTradeGap() == 9577748);
   REQUIRE(market.FindInstrument("eca").GetLargestTradeGap() == 9646186);
   REQUIRE(market.FindInstrument("ecb").GetLargestTradeGap() == 9956185);
   REQUIRE(market.FindInstrument("ecc").GetLargestTradeGap() == 9966523);
   REQUIRE(market.FindInstrument("ecd").GetLargestTradeGap() == 9929501);
   REQUIRE(market.FindInstrument("ece").GetLargestTradeGap() == 9869689);
   REQUIRE(market.FindInstrument("ecf").GetLargestTradeGap() == 9900704);
   REQUIRE(market.FindInstrument("ecg").GetLargestTradeGap() == 9849625);
   REQUIRE(market.FindInstrument("eda").GetLargestTradeGap() == 9953149);
   REQUIRE(market.FindInstrument("edb").GetLargestTradeGap() == 9890156);
   REQUIRE(market.FindInstrument("edc").GetLargestTradeGap() == 9849415);
   REQUIRE(market.FindInstrument("edd").GetLargestTradeGap() == 9797702);
   REQUIRE(market.FindInstrument("ede").GetLargestTradeGap() == 9934741);
   REQUIRE(market.FindInstrument("edf").GetLargestTradeGap() == 9988893);
   REQUIRE(market.FindInstrument("edg").GetLargestTradeGap() == 9833318);
   REQUIRE(market.FindInstrument("eea").GetLargestTradeGap() == 9855490);
   REQUIRE(market.FindInstrument("eeb").GetLargestTradeGap() == 9651425);
   REQUIRE(market.FindInstrument("eec").GetLargestTradeGap() == 9980968);
   REQUIRE(market.FindInstrument("eed").GetLargestTradeGap() == 9830287);
   REQUIRE(market.FindInstrument("eee").GetLargestTradeGap() == 9824727);
   REQUIRE(market.FindInstrument("eef").GetLargestTradeGap() == 9964253);
   REQUIRE(market.FindInstrument("eeg").GetLargestTradeGap() == 9969213);
   REQUIRE(market.FindInstrument("efa").GetLargestTradeGap() == 9959391);
   REQUIRE(market.FindInstrument("efb").GetLargestTradeGap() == 9621893);
   REQUIRE(market.FindInstrument("efc").GetLargestTradeGap() == 9667548);
   REQUIRE(market.FindInstrument("efd").GetLargestTradeGap() == 9501786);
   REQUIRE(market.FindInstrument("efe").GetLargestTradeGap() == 9969044);
   REQUIRE(market.FindInstrument("eff").GetLargestTradeGap() == 9720158);
   REQUIRE(market.FindInstrument("efg").GetLargestTradeGap() == 9537971);
   REQUIRE(market.FindInstrument("ega").GetLargestTradeGap() == 9657300);
   REQUIRE(market.FindInstrument("egb").GetLargestTradeGap() == 9648243);
   REQUIRE(market.FindInstrument("egc").GetLargestTradeGap() == 9909732);
   REQUIRE(market.FindInstrument("egd").GetLargestTradeGap() == 9837057);
   REQUIRE(market.FindInstrument("ege").GetLargestTradeGap() == 9803382);
   REQUIRE(market.FindInstrument("egf").GetLargestTradeGap() == 9920317);
   REQUIRE(market.FindInstrument("egg").GetLargestTradeGap() == 9966768);
   REQUIRE(market.FindInstrument("faa").GetLargestTradeGap() == 9800029);
   REQUIRE(market.FindInstrument("fab").GetLargestTradeGap() == 9981470);
   REQUIRE(market.FindInstrument("fac").GetLargestTradeGap() == 9972844);
   REQUIRE(market.FindInstrument("fad").GetLargestTradeGap() == 9900581);
   REQUIRE(market.FindInstrument("fae").GetLargestTradeGap() == 9932398);
   REQUIRE(market.FindInstrument("faf").GetLargestTradeGap() == 9934769);
   REQUIRE(market.FindInstrument("fag").GetLargestTradeGap() == 9997607);
   REQUIRE(market.FindInstrument("fba").GetLargestTradeGap() == 9890484);
   REQUIRE(market.FindInstrument("fbb").GetLargestTradeGap() == 9917167);
   REQUIRE(market.FindInstrument("fbc").GetLargestTradeGap() == 9887723);
   REQUIRE(market.FindInstrument("fbd").GetLargestTradeGap() == 9930566);
   REQUIRE(market.FindInstrument("fbe").GetLargestTradeGap() == 9778974);
   REQUIRE(market.FindInstrument("fbf").GetLargestTradeGap() == 9915314);
   REQUIRE(market.FindInstrument("fbg").GetLargestTradeGap() == 9763297);
   REQUIRE(market.FindInstrument("fca").GetLargestTradeGap() == 9543361);
   REQUIRE(market.FindInstrument("fcb").GetLargestTradeGap() == 9969456);
   REQUIRE(market.FindInstrument("fcc").GetLargestTradeGap() == 9387060);
   REQUIRE(market.FindInstrument("fcd").GetLargestTradeGap() == 9628529);
   REQUIRE(market.FindInstrument("fce").GetLargestTradeGap() == 9589555);
   REQUIRE(market.FindInstrument("fcf").GetLargestTradeGap() == 9425759);
   REQUIRE(market.FindInstrument("fcg").GetLargestTradeGap() == 9849558);
   REQUIRE(market.FindInstrument("fda").GetLargestTradeGap() == 9887636);
   REQUIRE(market.FindInstrument("fdb").GetLargestTradeGap() == 9835422);
   REQUIRE(market.FindInstrument("fdc").GetLargestTradeGap() == 9913097);
   REQUIRE(market.FindInstrument("fdd").GetLargestTradeGap() == 9637278);
   REQUIRE(market.FindInstrument("fde").GetLargestTradeGap() == 9709501);
   REQUIRE(market.FindInstrument("fdf").GetLargestTradeGap() == 9998849);
   REQUIRE(market.FindInstrument("fdg").GetLargestTradeGap() == 9828146);
   REQUIRE(market.FindInstrument("fea").GetLargestTradeGap() == 9882098);
   REQUIRE(market.FindInstrument("feb").GetLargestTradeGap() == 9797490);
   REQUIRE(market.FindInstrument("fec").GetLargestTradeGap() == 9872856);
   REQUIRE(market.FindInstrument("fed").GetLargestTradeGap() == 9916982);
   REQUIRE(market.FindInstrument("fee").GetLargestTradeGap() == 9935581);
   REQUIRE(market.FindInstrument("fef").GetLargestTradeGap() == 9733325);
   REQUIRE(market.FindInstrument("feg").GetLargestTradeGap() == 9673760);
   REQUIRE(market.FindInstrument("ffa").GetLargestTradeGap() == 9883396);
   REQUIRE(market.FindInstrument("ffb").GetLargestTradeGap() == 9836055);
   REQUIRE(market.FindInstrument("ffc").GetLargestTradeGap() == 9949847);
   REQUIRE(market.FindInstrument("ffd").GetLargestTradeGap() == 9915741);
   REQUIRE(market.FindInstrument("ffe").GetLargestTradeGap() == 9963745);
   REQUIRE(market.FindInstrument("fff").GetLargestTradeGap() == 9946127);
   REQUIRE(market.FindInstrument("ffg").GetLargestTradeGap() == 9997956);
   REQUIRE(market.FindInstrument("fga").GetLargestTradeGap() == 9778222);
   REQUIRE(market.FindInstrument("fgb").GetLargestTradeGap() == 9518219);
   REQUIRE(market.FindInstrument("fgc").GetLargestTradeGap() == 9817006);
   REQUIRE(market.FindInstrument("fgd").GetLargestTradeGap() == 9476701);
   REQUIRE(market.FindInstrument("fge").GetLargestTradeGap() == 9740368);
   REQUIRE(market.FindInstrument("fgf").GetLargestTradeGap() == 9715094);
   REQUIRE(market.FindInstrument("fgg").GetLargestTradeGap() == 9927535);
   REQUIRE(market.FindInstrument("gaa").GetLargestTradeGap() == 9864267);
   REQUIRE(market.FindInstrument("gab").GetLargestTradeGap() == 9740271);
   REQUIRE(market.FindInstrument("gac").GetLargestTradeGap() == 9922088);
   REQUIRE(market.FindInstrument("gad").GetLargestTradeGap() == 9575816);
   REQUIRE(market.FindInstrument("gae").GetLargestTradeGap() == 9728900);
   REQUIRE(market.FindInstrument("gaf").GetLargestTradeGap() == 9995962);
   REQUIRE(market.FindInstrument("gag").GetLargestTradeGap() == 9854848);
   REQUIRE(market.FindInstrument("gba").GetLargestTradeGap() == 9757293);
   REQUIRE(market.FindInstrument("gbb").GetLargestTradeGap() == 9436611);
   REQUIRE(market.FindInstrument("gbc").GetLargestTradeGap() == 9854646);
   REQUIRE(market.FindInstrument("gbd").GetLargestTradeGap() == 9986818);
   REQUIRE(market.FindInstrument("gbe").GetLargestTradeGap() == 9971049);
   REQUIRE(market.FindInstrument("gbf").GetLargestTradeGap() == 9940452);
   REQUIRE(market.FindInstrument("gbg").GetLargestTradeGap() == 9873421);
   REQUIRE(market.FindInstrument("gca").GetLargestTradeGap() == 9970687);
   REQUIRE(market.FindInstrument("gcb").GetLargestTradeGap() == 9820289);
   REQUIRE(market.FindInstrument("gcc").GetLargestTradeGap() == 9926940);
   REQUIRE(market.FindInstrument("gcd").GetLargestTradeGap() == 9940028);
   REQUIRE(market.FindInstrument("gce").GetLargestTradeGap() == 9727825);
   REQUIRE(market.FindInstrument("gcf").GetLargestTradeGap() == 9876794);
   REQUIRE(market.FindInstrument("gcg").GetLargestTradeGap() == 9733216);
   REQUIRE(market.FindInstrument("gda").GetLargestTradeGap() == 9917047);
   REQUIRE(market.FindInstrument("gdb").GetLargestTradeGap() == 9917632);
   REQUIRE(market.FindInstrument("gdc").GetLargestTradeGap() == 9917274);
   REQUIRE(market.FindInstrument("gdd").GetLargestTradeGap() == 9933248);
   REQUIRE(market.FindInstrument("gde").GetLargestTradeGap() == 9844335);
   REQUIRE(market.FindInstrument("gdf").GetLargestTradeGap() == 9419775);
   REQUIRE(market.FindInstrument("gdg").GetLargestTradeGap() == 9874466);
   REQUIRE(market.FindInstrument("gea").GetLargestTradeGap() == 9951535);
   REQUIRE(market.FindInstrument("geb").GetLargestTradeGap() == 9968436);
   REQUIRE(market.FindInstrument("gec").GetLargestTradeGap() == 9887661);
   REQUIRE(market.FindInstrument("ged").GetLargestTradeGap() == 9768224);
   REQUIRE(market.FindInstrument("gee").GetLargestTradeGap() == 9945437);
   REQUIRE(market.FindInstrument("gef").GetLargestTradeGap() == 9942157);
   REQUIRE(market.FindInstrument("geg").GetLargestTradeGap() == 9910721);
   REQUIRE(market.FindInstrument("gfa").GetLargestTradeGap() == 9949328);
   REQUIRE(market.FindInstrument("gfb").GetLargestTradeGap() == 9880374);
   REQUIRE(market.FindInstrument("gfc").GetLargestTradeGap() == 9967014);
   REQUIRE(market.FindInstrument("gfd").GetLargestTradeGap() == 9843827);
   REQUIRE(market.FindInstrument("gfe").GetLargestTradeGap() == 9985426);
   REQUIRE(market.FindInstrument("gff").GetLargestTradeGap() == 9957247);
   REQUIRE(market.FindInstrument("gfg").GetLargestTradeGap() == 9835469);
   REQUIRE(market.FindInstrument("gga").GetLargestTradeGap() == 9749031);
   REQUIRE(market.FindInstrument("ggb").GetLargestTradeGap() == 9873723);
   REQUIRE(market.FindInstrument("ggc").GetLargestTradeGap() == 9945112);
   REQUIRE(market.FindInstrument("ggd").GetLargestTradeGap() == 9882911);
   REQUIRE(market.FindInstrument("gge").GetLargestTradeGap() == 9672831);
   REQUIRE(market.FindInstrument("ggf").GetLargestTradeGap() == 9954572);
   REQUIRE(market.FindInstrument("ggg").GetLargestTradeGap() == 9939032);
}
